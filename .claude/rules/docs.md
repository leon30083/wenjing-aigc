---

paths: *

---

# 文档更新规范

## 更新时机

每次完成以下工作后，**必须**同步更新相关文档：

### 1. 功能开发完成
- ✅ 新功能实现完成
- ✅ 功能测试通过
- ✅ 代码已提交到 Git

### 2. 重要问题解决
- ✅ 发现并修复重大 Bug
- ✅ 发现新的平台差异或兼容性问题
- ✅ 发现新的最佳实践

### 3. API 变更
- ✅ 新增 API 端点
- ✅ 修改 API 参数或响应格式
- ✅ 废弃或删除 API

---

## 必须更新的文档清单

### 📄 .claude/skills/winjin-dev/SKILL.md ⭐ 重要
**更新内容**：
- 新增错误模式（"已知错误模式"章节）
- 更新"开发提示"列表
- 更新 references/troubleshooting.md（如有新问题）

**更新位置**：
- "已知错误模式（持续更新）"章节 - 添加新的错误编号
- "开发提示"章节 - 添加新的最佳实践
- references/troubleshooting.md - 添加新的故障排查条目

**⚠️ 注意**：
- **每次开发完成后必须更新**，与 code.md 保持同步
- Skill 是 Claude Code 使用的核心文档，直接影响后续开发质量
- 错误编号必须与 code.md 保持一致

### 📄 .claude/rules/base.md
**更新内容**：
- 新增功能的技术规范
- API 端点变更
- 平台差异处理
- 禁止/推荐模式

**更新位置**：在相关章节下添加新的小节

### 📄 .claude/rules/code.md
**更新内容**：
- 新增代码示例
- 新增错误模式
- 最佳实践代码
- 前端/后端实现细节

**更新位置**：
- 代码规范章节
- 常见错误模式章节（新增错误编号）

### 📄 用户输入文件夹/开发经验/Sora2_Character_Best_Practices.md
**更新内容**：
- 新增功能使用说明
- 新增测试案例
- 新增最佳实践
- 更新版本记录

**更新位置**：
- 功能相关章节（如果存在）
- 或创建新章节
- 顶部的更新记录

### 📄 用户输入文件夹/开发对话/开发交接书.md
**更新内容**：
- 更新版本号（v1.4 → v1.5）
- 添加到"已完成功能"列表
- 更新"注意事项"或"故障排查"（如有必要）

**更新位置**：
- 文档开头的版本号
- "最新开发进度"章节
- "注意事项"或"故障排查"章节

---

## 更新流程

### Step 1: 识别更新内容
```
功能类型判断：
├─ 新功能开发 → 更新所有 5 个文档（skill + base + code + Sora2_*.md + 开发交接书.md）
├─ Bug 修复 → 更新 skill.md + code.md + 开发交接书.md
├─ API 变更 → 更新 skill.md + base.md + code.md + 开发交接书.md
└─ 最佳实践 → 更新 skill.md + code.md + Sora2_Character_Best_Practices.md
```

### Step 2: 按顺序更新文档
```
1. .claude/skills/winjin-dev/SKILL.md    # Claude Code 核心文档 ⭐ 优先
2. base.md                               # 技术规范
3. code.md                               # 代码实现
4. Sora2_*.md                            # 开发经验
5. 开发交接书.md                          # 交接文档
```

### Step 3: 检查清单
在完成更新后，检查以下项目：
- [ ] **SKILL.md 已更新错误模式和开发提示** ⭐ 必需
- [ ] SKILL.md 的 references/troubleshooting.md 已更新（如有新问题）
- [ ] base.md 已更新技术规范
- [ ] code.md 已更新代码示例和错误模式
- [ ] Sora2_Character_Best_Practices.md 已更新功能说明
- [ ] 开发交接书.md 版本号已更新
- [ ] 开发交接书.md 已添加到"已完成功能"
- [ ] 所有文档的日期是最新的
- [ ] 代码已提交到 Git
- [ ] 文档变更已提交到 Git

---

## 文档模板

### base.md 新增功能模板
```markdown
### [功能名称] ⭐ 新增

**功能描述**：
- 要点1
- 要点2
- 要点3

**技术细节**：
- 参数格式
- API 端点
- 注意事项
```

### code.md 新增错误模式模板
```markdown
### 错误[N]: [错误名称] ⭐ 新增
```javascript
// ❌ 错误：[描述错误代码]
[错误代码示例]

// ✅ 正确：[描述正确代码]
[正确代码示例]
```

**问题**: [问题描述]
**解决方案**: [解决方法]
```

### Sora2_Character_Best_Practices.md 新增章节模板
```markdown
## [N]. [章节标题] ⭐ 新增

### [N].1 功能概述
- 功能对比表
- 关键发现

### [N].2 使用示例
- 简单模式
- 高级模式

### [N].3 测试验证
- 测试案例
- 验证结果

### [N].4 常见问题
- 问题1及解决方案
- 问题2及解决方案
```

### 开发交接书.md 新增功能模板
```markdown
#### [N]. [功能名称] (YYYY-MM-DD) ⭐ 新增
- **功能点1**: 描述
- **功能点2**: 描述
- **功能点3**: 描述
```

### SKILL.md 新增错误模式模板 ⭐ 重要
```markdown
### 错误[N]: [错误名称] ⭐ YYYY-MM-DD
- **现象**: [用户看到的症状]
- **根本原因**: [问题的根本原因]
- **错误尝试**:
  - ❌ [错误做法1]
  - ❌ [错误做法2]
- **正确做法**: [正确的解决方案]
- **关键点**:
  - [关键点1]
  - [关键点2]
  - [关键点3]
```

**同时更新 references/troubleshooting.md**:
```markdown
### 问题 N: [问题标题]

**症状**:
- [症状1]
- [症状2]

**诊断**:
- [诊断步骤1]
- [诊断步骤2]

**根本原因**:
[详细说明根本原因]

**解决方案**:
```javascript
// ❌ 错误示例
[错误代码]

// ✅ 正确示例
[正确代码]
```

**关键点**:
1. [关键点1]
2. [关键点2]
3. [关键点3]

**相关错误**: 错误[N] - [错误名称]
```

**更新"开发提示"列表**:
- 在 SKILL.md 的"开发提示"章节添加新的提示项

---

## 版本管理规则

### 交接书版本号规则
- **小版本更新**（v1.4 → v1.5）: 新增功能
- **大版本更新**（v1.4 → v2.0）: 重大架构变更

### 更新记录格式
```markdown
**更新记录**:
- YYYY-MM-DD: [功能描述] ⭐ 新增
- YYYY-MM-DD: [功能描述]
```

---

## 自动更新触发器

### 完成功能后自动提示
当 Claude Code 完成功能开发后，应该：

1. **主动询问**: "是否需要更新相关文档？"
2. **列出清单**: 显示需要更新的文档列表
3. **提供预览**: 展示主要更新内容
4. **等待确认**: 用户确认后执行更新

### 示例对话
```
Claude: ✅ 历史记录删除功能已完成！

📋 建议更新以下文档：
1. ⭐ .claude/skills/winjin-dev/SKILL.md - 添加错误模式，更新开发提示
2. .claude/rules/base.md - 添加删除 API 规范
3. .claude/rules/code.md - 添加删除函数示例和错误模式
4. Sora2_Character_Best_Practices.md - 添加使用说明
5. 开发交接书.md - 更新版本到 v1.5，添加功能说明

是否现在更新这些文档？(yes/no)

User: yes

Claude: 正在更新文档...
✅ SKILL.md 已更新（错误22）
✅ references/troubleshooting.md 已更新（问题6）
✅ base.md 已更新
✅ code.md 已更新
✅ Sora2_Character_Best_Practices.md 已更新
✅ 开发交接书.md 已更新到 v1.5

📝 变更摘要：
- 新增历史记录管理章节
- 添加 2 个错误模式
- 版本号更新到 v1.5
```

---

## 文档一致性检查

### 定期检查项
每月或每次大版本发布时，检查：
- [ ] **SKILL.md 错误编号与 code.md 保持一致** ⭐ 重要
- [ ] 所有 API 端点在文档中都有说明
- [ ] 所有错误模式都有示例
- [ ] 版本号在所有文档中一致
- [ ] 更新日期是最新的
- [ ] 代码示例与实际代码一致

---

## 注意事项

1. **及时更新**: 功能完成后立即更新文档，不要拖延
2. **保持同步**: 5 个文档要保持内容一致，不能相互矛盾
3. **优先更新 skill**: SKILL.md 是 Claude Code 核心文档，必须优先更新 ⭐
4. **详细记录**: 记录不仅包括"做什么"，还包括"为什么"
5. **版本控制**: 每次更新都要提交到 Git，方便回溯
6. **用户友好**: 文档要写得让新开发者也能看懂

---

## 快捷命令

### 当需要更新文档时
```
用户命令: "更新文档" 或 "同步文档"

Claude 应该:
1. 分析最近完成的功能
2. 识别需要更新的文档
3. 列出更新计划
4. 执行更新
5. 提交到 Git
```

### 查看文档更新状态
```
用户命令: "文档状态" 或 "检查文档"

Claude 应该:
1. 检查各文档的最后更新日期
2. 对比代码功能和文档描述
3. 列出可能遗漏的更新
```
