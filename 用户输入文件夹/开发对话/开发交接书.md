# WinJin AIGC å¼€å‘äº¤æ¥ä¹¦

**æ–‡æ¡£ç‰ˆæœ¬**: v4.8 â­ (2026-01-08 æ›´æ–°)
**ä¸Šä¸€ç‰ˆæœ¬**: v4.7 (2026-01-08)
**æ›´æ–°æ—¥æœŸ**: 2026-01-08
**é¡¹ç›®**: WinJin AIGC (å¼€æºé‡æ„ç‰ˆ)
**ä»“åº“**: https://github.com/leon30083/wenjing-aigc.git

---

## âš¡ å¿«é€Ÿå‚è€ƒï¼ˆå¼€å‘å‰å¿…è¯»ï¼‰

> è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ `.claude/rules/quick-reference.md`

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ â­

**å·¥ä½œæµç”»å¸ƒå¼€å‘ï¼ˆå½“å‰é‡ç‚¹ï¼‰**:
```bash
# ç»ˆç«¯1: å¯åŠ¨åç«¯ API
npm run server

# ç»ˆç«¯2: å¯åŠ¨å‰ç«¯ Vite
cd src/client && npm run dev

# æµè§ˆå™¨è®¿é—®
http://localhost:5173/  â† å·¥ä½œæµç”»å¸ƒï¼ˆReact Flowï¼‰â­
```

### 2. æµ‹è¯•ç›®æ ‡åŒºåˆ† âš ï¸

| ç«¯å£ | æŠ€æœ¯ | ç”¨é€” | å½“å‰é‡ç‚¹ |
|------|------|------|----------|
| **5173** | React Flow | **å·¥ä½œæµç”»å¸ƒ** | â­ **YES** |
| 9000 | åŸç”Ÿ HTML | ç½‘é¡µç‰ˆï¼ˆæ—§ç‰ˆï¼‰ | NO |

### 3. å¸¸è§é”™è¯¯ âŒ

```bash
# âŒ é”™è¯¯1: åªå¯åŠ¨åç«¯ï¼Œè®¿é—®ç½‘é¡µç‰ˆ
npm run server
# æµè§ˆå™¨æ‰“å¼€ localhost:9000  â† è¿™æ˜¯ç½‘é¡µç‰ˆï¼Œä¸æ˜¯å·¥ä½œæµç”»å¸ƒï¼

# âŒ é”™è¯¯2: ä½¿ç”¨ npm startï¼ˆéœ€è¦ electronï¼‰
npm start  # 'electron' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤

# âœ… æ­£ç¡®: åŒæ—¶å¯åŠ¨åç«¯å’Œå‰ç«¯
npm run server          # ç»ˆç«¯1
cd src/client && npm run dev  # ç»ˆç«¯2
# è®¿é—® localhost:5173  â† è¿™æ‰æ˜¯å·¥ä½œæµç”»å¸ƒï¼
```

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
3. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
4. [Claude Code é…ç½®ï¼ˆé‡è¦ï¼‰](#claude-code-é…ç½®é‡è¦)
5. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
6. [å¸¸ç”¨å‘½ä»¤](#å¸¸ç”¨å‘½ä»¤)
7. [API ç«¯ç‚¹](#api-ç«¯ç‚¹)
8. [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
9. [å…³é”®æ¨¡å—è¯´æ˜](#å…³é”®æ¨¡å—è¯´æ˜)
10. [æœ€æ–°å¼€å‘è¿›åº¦](#æœ€æ–°å¼€å‘è¿›åº¦)
11. [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
12. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
13. [å·¥ä½œæµç¼–è¾‘å™¨ä½¿ç”¨æŒ‡å—] â­ æ–°å¢

---

## é¡¹ç›®æ¦‚è¿°

WinJin AIGC æ˜¯ä¸€ä¸ªåŸºäº Electron + Express çš„ AI è§†é¢‘ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒï¼š

- **Sora2 è§†é¢‘ç”Ÿæˆ**: æ–‡ç”Ÿè§†é¢‘ã€è§’è‰²å‚è€ƒè§†é¢‘ã€æ•…äº‹æ¿æ‰¹é‡ç”Ÿæˆ
- **è§’è‰²åˆ›å»º**: ä»è§†é¢‘ä¸­æå–è§’è‰²ï¼Œæ”¯æŒè§’è‰²åº“ç®¡ç†
- **åŒå¹³å°æ”¯æŒ**: èšé‘«å¹³å° (api.jxincm.cn) å’Œè´è´å¹³å° (ai.t8star.cn)
- **å†å²è®°å½•**: è‡ªåŠ¨ä¿å­˜ä»»åŠ¡è®°å½•åˆ° JSON æ–‡ä»¶ï¼Œåå°è½®è¯¢è‡ªåŠ¨æ›´æ–°çŠ¶æ€
- **è§’è‰²åº“**: ç®¡ç†åˆ›å»ºçš„è§’è‰²ï¼Œæ”¯æŒæœç´¢ã€åˆ«åã€å¿«é€Ÿè°ƒç”¨
- **å¯è§†åŒ–èŠ‚ç‚¹å·¥ä½œæµ** â­ v2.0 æ–°å¢: ComfyUI é£æ ¼çš„æ‹–æ‹½å¼èŠ‚ç‚¹ç¼–è¾‘å™¨

---

## ç¯å¢ƒè¦æ±‚

### å¿…éœ€è½¯ä»¶

| è½¯ä»¶ | ç‰ˆæœ¬è¦æ±‚ | ä¸‹è½½åœ°å€ |
|------|----------|----------|
| **Node.js** | 16.x æˆ–æ›´é«˜ | https://nodejs.org/ |
| **npm** | 8.x æˆ–æ›´é«˜ | éš Node.js å®‰è£… |
| **Git** | æœ€æ–°ç‰ˆ | https://git-scm.com/ |
| **Claude Code** | æœ€æ–°ç‰ˆ | https://claude.com/claude-code |

### å¯é€‰è½¯ä»¶

- **VS Code**: æ¨èçš„ä»£ç ç¼–è¾‘å™¨
- **Chrome DevTools**: è°ƒè¯•å‰ç«¯ï¼ˆClaude Code å·²é›†æˆï¼‰

### æ“ä½œç³»ç»Ÿ

- Windows 10/11ï¼ˆä¸»è¦ç›®æ ‡å¹³å°ï¼‰
- macOS/Linuxï¼ˆå…¼å®¹ï¼‰

---

## å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/leon30083/wenjing-aigc.git
cd wenjing-aigc
```

### 2. å®‰è£…ä¾èµ–

```bash
# å®‰è£…é¡¹ç›®ä¾èµ–
npm install
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
copy .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ API Key
```

**`.env` æ–‡ä»¶å†…å®¹**:

```bash
# èšé‘«å¹³å° API Keyï¼ˆå¿…å¡«ï¼‰
SORA2_API_KEY=sk-your-actual-juxin-api-key

# è´è´å¹³å° API Keyï¼ˆå¯é€‰ï¼‰
ZHENZHEN_API_KEY=sk-your-actual-zhenzhen-api-key

# æœåŠ¡å™¨ç«¯å£
PORT=9000
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

**âš ï¸ é‡è¦**ï¼šé¡¹ç›®æœ‰ä¸¤ç§å¯åŠ¨æ–¹å¼ï¼Œæ³¨æ„åŒºåˆ†ï¼

#### æ–¹å¼1: ä»…å¯åŠ¨ HTTP æœåŠ¡å™¨ï¼ˆæ¨èç”¨äº API æµ‹è¯•ï¼‰

```bash
npm run server
```

- **ç”¨é€”**: å¯åŠ¨ Express HTTP æœåŠ¡å™¨ï¼Œæä¾› API æ¥å£
- **ç«¯å£**: `http://localhost:9000`
- **è®¿é—®**: æµè§ˆå™¨æ‰“å¼€ http://localhost:9000
- **é€‚ç”¨åœºæ™¯**:
  - æµ‹è¯• API æ¥å£
  - æµ‹è¯•ç½‘é¡µç‰ˆåŠŸèƒ½ï¼ˆéå·¥ä½œæµç”»å¸ƒï¼‰
- **æ³¨æ„**: **ä¸å¯åŠ¨ Electron æ¡Œé¢åº”ç”¨**

#### æ–¹å¼2: å¯åŠ¨å·¥ä½œæµç”»å¸ƒå¼€å‘æœåŠ¡å™¨ â­ å½“å‰å¼€å‘é‡ç‚¹

**âš ï¸ é‡è¦**ï¼šè¿™æ˜¯å½“å‰é¡¹ç›®çš„ä¸»è¦å¼€å‘ç›®æ ‡ï¼

```bash
# æ­¥éª¤1: å¯åŠ¨åç«¯ API æœåŠ¡å™¨
npm run server

# æ­¥éª¤2: å¯åŠ¨å‰ç«¯ Vite å¼€å‘æœåŠ¡å™¨ï¼ˆæ–°ç»ˆç«¯çª—å£ï¼‰
cd src/client
npm run dev
```

- **åç«¯ç«¯å£**: `http://localhost:9000` (API æ¥å£)
- **å‰ç«¯ç«¯å£**: `http://localhost:5173` (å·¥ä½œæµç”»å¸ƒ)
- **è®¿é—®**: æµè§ˆå™¨æ‰“å¼€ **http://localhost:5173/**
- **é€‚ç”¨åœºæ™¯**:
  - **å·¥ä½œæµèŠ‚ç‚¹å¼€å‘** â­
  - **èŠ‚ç‚¹è¿çº¿æµ‹è¯•** â­
  - **React Flow åŠŸèƒ½è°ƒè¯•** â­
- **æ³¨æ„**:
  - **å¿…é¡»åŒæ—¶è¿è¡Œä¸¤ä¸ªæœåŠ¡å™¨**ï¼ˆåç«¯ + å‰ç«¯ï¼‰
  - **æµ‹è¯•æ—¶è®¿é—® 5173 ç«¯å£ï¼Œä¸æ˜¯ 9000 ç«¯å£** âš ï¸
  - 9000 ç«¯å£æ˜¯ç½‘é¡µç‰ˆï¼Œä¸æ˜¯å·¥ä½œæµç”»å¸ƒ âš ï¸

#### æ–¹å¼3: å¯åŠ¨å®Œæ•´çš„ Electron æ¡Œé¢åº”ç”¨

```bash
npm start
```

- **ç”¨é€”**: å¯åŠ¨ Electron æ¡Œé¢åº”ç”¨ï¼ˆåŒ…å«å†…åµŒçš„ HTTP æœåŠ¡å™¨ï¼‰
- **è¦æ±‚**: éœ€è¦å…ˆå®‰è£… electron (`npm install electron --save-dev`)
- **é€‚ç”¨åœºæ™¯**:
  - æ‰“åŒ…æ¡Œé¢åº”ç”¨
  - æµ‹è¯•æ¡Œé¢åº”ç”¨åŠŸèƒ½

#### å¸¸è§é—®é¢˜ âš ï¸ æ˜“çŠ¯é”™è¯¯

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| `electron: command not found` | electron æœªå®‰è£… | ä½¿ç”¨ `npm run server` ä»£æ›¿ `npm start` |
| ç«¯å£è¢«å ç”¨ | 9000 ç«¯å£å·²è¢«ä½¿ç”¨ | ä¿®æ”¹ `.env` ä¸­çš„ PORT é…ç½® |
| **æµ‹è¯•äº†ç½‘é¡µç‰ˆè€Œéç”»å¸ƒ** | âŒ è®¿é—® localhost:9000 | âœ… è®¿é—® localhost:5173ï¼ˆå·¥ä½œæµç”»å¸ƒï¼‰ |
| **å‰ç«¯æ— æ³•è¿æ¥ API** | åªå¯åŠ¨äº† Viteï¼Œæ²¡å¯åŠ¨åç«¯ | åŒæ—¶è¿è¡Œ `npm run server` å’Œ `npm run dev` |

**å¼€å‘æµç¨‹æ¨è** â­:
1. ç»ˆç«¯1: `npm run server` (åç«¯ API)
2. ç»ˆç«¯2: `cd src/client && npm run dev` (å‰ç«¯ç”»å¸ƒ)
3. æµè§ˆå™¨è®¿é—®: **http://localhost:5173/** â­

**âŒ é”™è¯¯æ“ä½œ**:
- åªè¿è¡Œ `npm run server` åè®¿é—® 9000 ç«¯å£ â†’ æµ‹è¯•çš„æ˜¯ç½‘é¡µç‰ˆï¼Œä¸æ˜¯å·¥ä½œæµç”»å¸ƒ
- åªè¿è¡Œ Vite dev server â†’ å‰ç«¯æ— æ³•è¿æ¥åç«¯ API

---

## Claude Code é…ç½®ï¼ˆé‡è¦ï¼‰

**âš ï¸ è¿™æ˜¯å¼€å‘çš„æ ¸å¿ƒé…ç½®ï¼Œå¿…é¡»åœ¨æ–°çš„å¼€å‘ç¯å¢ƒä¸­æ­£ç¡®è®¾ç½®ï¼**

### é…ç½®æ–‡ä»¶ä½ç½®

```
.claude/
â”œâ”€â”€ settings.json          # Claude Code è®¾ç½®
â”œâ”€â”€ settings.local.json    # æœ¬åœ°è¦†ç›–è®¾ç½®ï¼ˆä¸æäº¤ï¼‰
â””â”€â”€ rules/                 # å¼€å‘è§„åˆ™
    â”œâ”€â”€ base.md            # åŸºç¡€æŠ€æœ¯æ ˆè§„åˆ™
    â””â”€â”€ code.md            # ä»£ç è§„èŒƒå’Œæœ€ä½³å®è·µ
```

### settings.json é…ç½®

**ä½ç½®**: `é¡¹ç›®æ ¹ç›®å½•/.claude/settings.json`

```json
{
  "mcpServers": {
    "memory": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-memory"]
    },
    "chrome-devtools": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-chrome-devtools"]
    },
    "context7": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-context7"]
    }
  }
}
```

### rules/base.md - æŠ€æœ¯æ ˆçº¦æŸ

**å…³é”®å†…å®¹**:

```markdown
## è¿è¡Œæ—¶ç¯å¢ƒ
- Node.js: 16.x æˆ–æ›´é«˜
- npm: 8.x æˆ–æ›´é«˜

## æ ¸å¿ƒæ¡†æ¶ç‰ˆæœ¬
| æ¡†æ¶/åº“ | ç‰ˆæœ¬è¦æ±‚ |
|---------|----------|
| Electron | ^28.0.0 |
| Express | ^4.18.2 |
| axios | ^1.6.5 |
| dotenv | ^17.2.3 |

## Sora2 API æ”¯æŒå¹³å°
### èšé‘«å¹³å° (api.jxincm.cn)
- åˆ›å»ºè§†é¢‘: POST /v1/video/create
- æŸ¥è¯¢ä»»åŠ¡: GET /v1/video/query?id={taskId} âš ï¸ æŸ¥è¯¢å‚æ•°
- åˆ›å»ºè§’è‰²: POST /sora/v1/characters

### è´è´å¹³å° (ai.t8star.cn)
- åˆ›å»ºè§†é¢‘: POST /v1/video/create
- æŸ¥è¯¢ä»»åŠ¡: GET /v2/videos/generations/{taskId} âš ï¸ è·¯å¾„å‚æ•°
- åˆ›å»ºè§’è‰²: POST /sora/v1/characters

### é‡è¦å·®å¼‚
- æŸ¥è¯¢ç«¯ç‚¹: èšé‘«ç”¨æŸ¥è¯¢å‚æ•° ?id=ï¼Œè´è´ç”¨è·¯å¾„å‚æ•° /{taskId}
- å“åº”æ ¼å¼: èšé‘«è¿”å› {id}, è´è´è¿”å› {task_id} âš ï¸ éœ€è¦å…¼å®¹å¤„ç†
- è§’è‰²åˆ›å»º: éƒ½æ”¯æŒ from_task å‚æ•°ï¼ˆæ¨èï¼‰

### è§’è‰²å¼•ç”¨è¯­æ³• â­
æ‰€æœ‰å¹³å°ç»Ÿä¸€ä½¿ç”¨ @username æ ¼å¼ï¼ˆä¸å¸¦èŠ±æ‹¬å·ï¼‰
ç¤ºä¾‹: @6f2dbf2b3.zenwhisper åœ¨å·¥åœ°ä¸Šå¹²æ´»

### è§’è‰²åˆ›å»ºè§„èŒƒ â­
- ç«¯ç‚¹: POST /sora/v1/characters
- å‚æ•°: url æˆ– from_task äºŒé€‰ä¸€
- å¿…å¡«: timestamps (æ ¼å¼: "1,3")
- âš ï¸ ç¦æ­¢: ä¸è¦ä¼ é€’ model å‚æ•°
- âœ… æ¨è: ä¼˜å…ˆä½¿ç”¨ from_task å‚æ•°

## è½®è¯¢ç­–ç•¥
- åå°è‡ªåŠ¨è½®è¯¢: 30ç§’é—´éš”
- æ£€æŸ¥èŒƒå›´: æ‰€æœ‰ queued å’Œ processing çŠ¶æ€çš„ä»»åŠ¡
- æ‰‹åŠ¨æŸ¥è¯¢: æä¾›"æŸ¥è¯¢çŠ¶æ€"æŒ‰é’®
```

### rules/code.md - ä»£ç è§„èŒƒ

**å…³é”®å†…å®¹**:

```markdown
## å‘½åçº¦å®š
- æ–‡ä»¶å: kebab-case
- å˜é‡/å‡½æ•°: camelCase
- ç±»å: PascalCase
- å¸¸é‡: UPPER_SNAKE_CASE
- ç§æœ‰æˆå‘˜: å‰ç¼€ä¸‹åˆ’çº¿ _

## Sora2 API å¼€å‘è§„èŒƒ

### åŒå¹³å°ä»»åŠ¡IDå…¼å®¹å¤„ç† âš ï¸ é‡è¦
// âœ… æ­£ç¡®ï¼šå…¼å®¹åŒå¹³å°çš„ä»»åŠ¡IDæ ¼å¼
const taskId = result.data.id || result.data.task_id;
if (taskId) {
  historyStorage.addRecord({ taskId, platform, prompt, model, options });
}

### è§’è‰²å¼•ç”¨è¯­æ³•
// âœ… æ­£ç¡®ï¼šæ‰€æœ‰å¹³å°ä½¿ç”¨ @username æ ¼å¼
const prompt = '@6f2dbf2b3.zenwhisper åœ¨å·¥åœ°ä¸Šå¹²æ´»';
// âŒ é”™è¯¯ï¼šä¸è¦ä½¿ç”¨èŠ±æ‹¬å·
const prompt = '@{6f2dbf2b3.zenwhisper} åœ¨å·¥åœ°ä¸Šå¹²æ´»';
```

### é…ç½® Claude Code è‡ªåŠ¨åŠ è½½è§„åˆ™

å½“åœ¨æ–°çš„å¼€å‘ç¯å¢ƒé¦–æ¬¡ä½¿ç”¨ Claude Code æ—¶ï¼š

1. **æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•**
   ```bash
   cd D:\user\github\winjin
   ```

2. **å¯åŠ¨ Claude Code**
   - Claude Code ä¼šè‡ªåŠ¨è¯»å– `.claude/settings.json`
   - ä¼šè‡ªåŠ¨åŠ è½½ `rules/` ç›®å½•ä¸‹çš„è§„åˆ™æ–‡ä»¶

3. **éªŒè¯é…ç½®**
   - åœ¨ Claude Code ä¸­è¯¢é—®ï¼šè¯·åˆ—å‡ºå½“å‰é¡¹ç›®çš„æŠ€æœ¯æ ˆ
   - åº”è¯¥è¿”å› base.md ä¸­å®šä¹‰çš„æŠ€æœ¯æ ˆä¿¡æ¯

---

## é¡¹ç›®ç»“æ„

```
wenjing-aigc/
â”œâ”€â”€ .claude/                    # Claude Code é…ç½® â­
â”‚   â”œâ”€â”€ settings.json           # MCP æœåŠ¡å™¨é…ç½®
â”‚   â””â”€â”€ rules/                  # å¼€å‘è§„åˆ™
â”‚       â”œâ”€â”€ base.md             # æŠ€æœ¯æ ˆçº¦æŸ
â”‚       â””â”€â”€ code.md             # ä»£ç è§„èŒƒ
â”œâ”€â”€ data/                       # æ•°æ®æŒä¹…åŒ–ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â”œâ”€â”€ history.json            # å†å²è®°å½•
â”‚   â””â”€â”€ characters.json         # è§’è‰²åº“
â”œâ”€â”€ downloads/                  # è§†é¢‘ä¸‹è½½ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”œâ”€â”€ reference/                  # å‚è€ƒæ–‡æ¡£
â”‚   â””â”€â”€ ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/
â”‚       â”œâ”€â”€ å¼€å‘ç»éªŒ/           # å¼€å‘æ–‡æ¡£ â­
â”‚       â”œâ”€â”€ èšé‘«sora2/          # èšé‘« API æ–‡æ¡£
â”‚       â””â”€â”€ è´è´å·¥åŠ/           # è´è´ API æ–‡æ¡£
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/                   # Electron ä¸»è¿›ç¨‹ï¼ˆæš‚æœªä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ renderer/               # Electron æ¸²æŸ“è¿›ç¨‹
â”‚   â”‚   â””â”€â”€ public/
â”‚   â”‚       â””â”€â”€ index.html      # Web å‰ç«¯ç•Œé¢ï¼ˆv1.xï¼‰
â”‚   â”œâ”€â”€ server/                 # HTTP æœåŠ¡å™¨ â­
â”‚   â”‚   â”œâ”€â”€ index.js            # Express æœåŠ¡å™¨ä¸»æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ sora2-client.js     # Sora2 API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ history-storage.js  # å†å²è®°å½•å­˜å‚¨
â”‚   â”‚   â”œâ”€â”€ character-storage.js # è§’è‰²åº“å­˜å‚¨
â”‚   â”‚   â””â”€â”€ batch-queue.js      # æ‰¹é‡ä»»åŠ¡é˜Ÿåˆ—
â”‚   â””â”€â”€ client/                 # â­ v2.0 æ–°å¢ï¼šå·¥ä½œæµç¼–è¾‘å™¨
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ nodes/          # è‡ªå®šä¹‰èŠ‚ç‚¹
â”‚       â”‚   â”‚   â”œâ”€â”€ input/      # è¾“å…¥èŠ‚ç‚¹ (4ä¸ª)
â”‚       â”‚   â”‚   â”œâ”€â”€ process/    # å¤„ç†èŠ‚ç‚¹ (3ä¸ª)
â”‚       â”‚   â”‚   â””â”€â”€ output/     # è¾“å‡ºèŠ‚ç‚¹ (2ä¸ª)
â”‚       â”‚   â”œâ”€â”€ hooks/          # React Hooks
â”‚       â”‚   â”‚   â””â”€â”€ useWorkflowExecution.js
â”‚       â”‚   â”œâ”€â”€ App.jsx         # ä¸»åº”ç”¨
â”‚       â”‚   â””â”€â”€ App.css
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ vite.config.js
â”œâ”€â”€ .env                        # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ .env.example                # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥è§„åˆ™
â”œâ”€â”€ package.json                # é¡¹ç›®ä¾èµ–
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
```

---

## å¸¸ç”¨å‘½ä»¤

### å¼€å‘å‘½ä»¤

```bash
# å¯åŠ¨ HTTP æœåŠ¡å™¨ï¼ˆæœ€å¸¸ç”¨ï¼‰
npm run server

# å¯åŠ¨ Electron åº”ç”¨
npm start

# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev

# â­ v2.0 æ–°å¢ï¼šå¯åŠ¨å·¥ä½œæµç¼–è¾‘å™¨
cd src/client && npm run dev
# è®¿é—® http://localhost:5173
```

### Git å‘½ä»¤

```bash
# æŸ¥çœ‹çŠ¶æ€
git status

# æäº¤æ›´æ”¹
git add .
git commit -m "feat: your message"
git push origin master

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin master

# è®¾ç½®ä»£ç†ï¼ˆå¦‚éœ€è¦ï¼‰
git config --global http.proxy http://127.0.0.1:7890
git config --global https.proxy http://127.0.0.1:7890

# å–æ¶ˆä»£ç†
git config --global --unset http.proxy
git config --global --unset https.proxy
```

### æµ‹è¯•å‘½ä»¤

```bash
# æµ‹è¯•æœåŠ¡å™¨å¥åº·
curl http://localhost:9000/health

# æµ‹è¯•åˆ›å»ºè§†é¢‘
curl -X POST http://localhost:9000/api/video/create \
  -H "Content-Type: application/json" \
  -d '{"platform":"juxin","prompt":"A cat","model":"sora-2"}'
```

---

## API ç«¯ç‚¹

### å¥åº·æ£€æŸ¥
```
GET /health
```

### è§†é¢‘ç”Ÿæˆ
```
POST /api/video/create              # æ–‡ç”Ÿè§†é¢‘
POST /api/video/create-with-character  # å¸¦è§’è‰²å‚è€ƒ
POST /api/video/storyboard          # æ•…äº‹æ¿æ‰¹é‡
POST /api/video/download            # ä¸‹è½½è§†é¢‘
```

### è§’è‰²ç®¡ç†
```
POST   /api/character/create           # åˆ›å»ºè§’è‰²
GET    /api/character/list             # è·å–è§’è‰²åˆ—è¡¨
GET    /api/character/stats            # è·å–ç»Ÿè®¡ä¿¡æ¯
GET    /api/character/:characterId     # è·å–å•ä¸ªè§’è‰²
GET    /api/character/search/:query    # æœç´¢è§’è‰²
PUT    /api/character/:characterId/alias  # è®¾ç½®åˆ«å â­
DELETE /api/character/:characterId     # åˆ é™¤è§’è‰²
DELETE /api/character/all             # æ¸…ç©ºæ‰€æœ‰è§’è‰²
```

### ä»»åŠ¡æŸ¥è¯¢
```
GET /api/task/:taskId               # æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
GET /api/task/:taskId/wait          # ç­‰å¾…ä»»åŠ¡å®Œæˆ
```

### æ‰¹é‡ä»»åŠ¡
```
POST /api/batch/create              # åˆ›å»ºæ‰¹é‡ä»»åŠ¡
POST /api/batch/:id/submit          # æäº¤æ‰¹é‡ä»»åŠ¡
GET  /api/batch/:id/poll            # è½®è¯¢æ‰¹é‡ä»»åŠ¡
GET  /api/batch/:id/status          # è·å–æ‰¹é‡ä»»åŠ¡çŠ¶æ€
GET  /api/batch/list                # è·å–æ‰€æœ‰æ‰¹é‡ä»»åŠ¡
DELETE /api/batch/:id               # åˆ é™¤æ‰¹é‡ä»»åŠ¡
```

### å¤‡ä»½ç®¡ç† â­ æ–°å¢
```
GET  /api/backup/export             # å¯¼å‡ºå¤‡ä»½ï¼ˆJSONæ ¼å¼ï¼‰
POST /api/backup/import             # å¯¼å…¥å¤‡ä»½
GET  /api/backup/info               # è·å–æ•°æ®ç»Ÿè®¡ä¿¡æ¯
```

---

## å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

```javascript
// âœ… æ­£ç¡®çš„å‘½å
const getUserData = () => {};  // camelCase
class UserService {};          // PascalCase
const MAX_RETRIES = 3;         // UPPER_SNAKE_CASE
const _privateVar = 'secret';  // ç§æœ‰æˆå‘˜å‰ç¼€

// âŒ é”™è¯¯çš„å‘½å
const GetUserData = () => {};  // ä¸ä½¿ç”¨ PascalCase
const user_data = () => {};    // ä¸ä½¿ç”¨ snake_case
```

### API è°ƒç”¨è§„èŒƒ

```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ async/await + try-catch
async function createVideo(options) {
  try {
    const response = await axios.post('/api/video/create', options);
    return { success: true, data: response.data };
  } catch (error) {
    return { success: false, error: error.message };
  }
}

// âŒ é”™è¯¯ï¼šä¸ä½¿ç”¨ try-catch
async function createVideo(options) {
  const response = await axios.post('/api/video/create', options);
  return response.data;  // å¯èƒ½æŠ›å‡ºæœªæ•è·çš„å¼‚å¸¸
}
```

### ç»Ÿä¸€å“åº”æ ¼å¼

```javascript
// æˆåŠŸå“åº”
{ success: true, data: {...} }

// å¤±è´¥å“åº”
{ success: false, error: "é”™è¯¯ä¿¡æ¯" }
```

---

## å…³é”®æ¨¡å—è¯´æ˜

### 1. Sora2Client (src/server/sora2-client.js)

**èŒè´£**: å°è£… Sora2 API è°ƒç”¨ï¼Œæ”¯æŒåŒå¹³å°

**å…³é”®æ–¹æ³•**:
```javascript
// åˆ›å»ºè§†é¢‘ï¼ˆå…¼å®¹åŒå¹³å°å“åº”æ ¼å¼ï¼‰
await client.createVideo({
  prompt: 'A cat sleeping',
  model: 'sora-2',
  orientation: 'landscape',
  duration: 10,
  size: 'small'
});

// æŸ¥è¯¢ä»»åŠ¡ï¼ˆè‡ªåŠ¨å¤„ç†å¹³å°å·®å¼‚ï¼‰
await client.getTaskStatus(taskId);

// åˆ›å»ºè§’è‰²ï¼ˆæ”¯æŒ from_taskï¼‰
await client.createCharacter({
  from_task: taskId,  // æ¨èæ–¹å¼
  timestamps: '1,3'
});
```

### 2. HistoryStorage (src/server/history-storage.js)

**èŒè´£**: å†å²è®°å½•æŒä¹…åŒ–å­˜å‚¨

**å­˜å‚¨ä½ç½®**: `data/history.json`

**å…³é”®æ–¹æ³•**:
```javascript
// æ·»åŠ è®°å½•
historyStorage.addRecord({
  taskId: 'video_xxx',
  platform: 'juxin',
  prompt: 'A cat',
  model: 'sora-2'
});

// æ ‡è®°å®Œæˆ
historyStorage.markCompleted(taskId, { output: 'url' });

// è·å–æ‰€æœ‰è®°å½•
const records = historyStorage.getAllRecords({
  status: 'queued',
  platform: 'zhenzhen'
});
```

### 3. CharacterStorage (src/server/character-storage.js)

**èŒè´£**: è§’è‰²åº“æŒä¹…åŒ–å­˜å‚¨

**å­˜å‚¨ä½ç½®**: `data/characters.json`

**å…³é”®æ–¹æ³•**:
```javascript
// æ·»åŠ è§’è‰²ï¼ˆè‡ªåŠ¨å»é‡ï¼‰
characterStorage.addCharacter({
  id: 'ch_xxx',
  username: 'user.name',
  alias: 'åˆ«å',  // â­ æ–°å¢
  profilePictureUrl: 'url',
  platform: 'zhenzhen'
});

// æ›´æ–°è§’è‰²ï¼ˆè®¾ç½®åˆ«åï¼‰
characterStorage.updateCharacter(characterId, { alias: 'æ–°åˆ«å' });

// æœç´¢è§’è‰²
const results = characterStorage.searchCharacters('user');

// è·å–ç»Ÿè®¡
const stats = characterStorage.getStats();
// { total: 10, byPlatform: { juxin: 5, zhenzhen: 5 } }
```

### 4. åå°è½®è¯¢æœåŠ¡ (src/server/index.js)

**èŒè´£**: è‡ªåŠ¨æ£€æŸ¥å¹¶æ›´æ–°ä»»åŠ¡çŠ¶æ€

**é…ç½®**:
```javascript
const POLL_INTERVAL = 30000;  // 30ç§’

// æ£€æŸ¥æ‰€æœ‰ queued å’Œ processing çŠ¶æ€çš„ä»»åŠ¡
setInterval(async () => {
  const queuedTasks = historyStorage.getAllRecords({ status: 'queued' });
  const processingTasks = historyStorage.getAllRecords({ status: 'processing' });
  const allPendingTasks = [...queuedTasks, ...processingTasks];

  for (const record of allPendingTasks) {
    await checkAndUpdateTask(record.taskId, record.platform);
  }
}, POLL_INTERVAL);
```

---

## æœ€æ–°å¼€å‘è¿›åº¦

### å·²å®ŒæˆåŠŸèƒ½ âœ…

#### 1. NarratorProcessorNode ä¼˜åŒ–ç»“æœæŒä¹…åŒ–åŠŸèƒ½ (2026-01-08) â­ v4.7
- **æ ¸å¿ƒç›®æ ‡**: ä¿®å¤æ—ç™½å¤„ç†èŠ‚ç‚¹ä¼˜åŒ–ç»“æœåˆ·æ–°åä¸¢å¤±çš„é—®é¢˜
- **é—®é¢˜æè¿°**:
  - NarratorProcessorNode å®Œæˆä¼˜åŒ–åï¼ˆ9/9 100%ï¼‰ï¼Œåˆ·æ–°é¡µé¢ä¼˜åŒ–ç»“æœå…¨éƒ¨ä¸¢å¤±
  - ä¼˜åŒ–è¿›åº¦å›åˆ° 0/9 (0%)ï¼Œä¼˜åŒ–ç»“æœä¸ºç©º
  - ç”¨æˆ·æ¯æ¬¡åˆ·æ–°éƒ½éœ€è¦é‡æ–°ä¼˜åŒ–ï¼Œä¸¥é‡å½±å“å¼€å‘æ•ˆç‡
- **æ ¹æœ¬åŸå› **:
  1. **å·¥ä½œæµæœªè‡ªåŠ¨ä¿å­˜**: React Flow çš„ `node.data` ä¸ä¼šè‡ªåŠ¨ä¿å­˜åˆ° localStorage
  2. **éœ€è¦æ˜¾å¼ä¿å­˜**: ç”¨æˆ·å¿…é¡»æ‰‹åŠ¨ç‚¹å‡»"ğŸ’¾ ä¿å­˜å·¥ä½œæµ"æŒ‰é’®æ‰èƒ½ä¿å­˜
  3. **UI çŠ¶æ€æœªæ¢å¤**: è™½ç„¶ä¼˜åŒ–æ•°æ®è¢«åŒæ­¥åˆ° `node.data`ï¼Œä½† `progress`ã€`currentPrompt` ç­‰è¿è¡Œæ—¶çŠ¶æ€æœªæ¢å¤
- **ä¿®å¤å†…å®¹**:
  - **äº‹ä»¶é©±åŠ¨è‡ªåŠ¨ä¿å­˜**: NarratorProcessorNode å®Œæˆä¼˜åŒ–åæ´¾å‘ `narrator-optimization-complete` äº‹ä»¶
  - **App.jsx ç›‘å¬å¹¶ä¿å­˜**: ç›‘å¬äº‹ä»¶åè‡ªåŠ¨è°ƒç”¨ `WorkflowStorage.saveWorkflow()` ä¿å­˜å·¥ä½œæµ
  - **UI çŠ¶æ€æ¢å¤**: åˆ·æ–°æ—¶æ£€æµ‹ä¼˜åŒ–æ•°æ®ï¼Œè‡ªåŠ¨æ¢å¤è¿›åº¦ç™¾åˆ†æ¯”ã€å½“å‰ç´¢å¼•ã€å½“å‰æç¤ºè¯
  - **ç”Ÿæˆæœªå‘½åå·¥ä½œæµ**: å¦‚æœæ²¡æœ‰å½“å‰å·¥ä½œæµåç§°ï¼Œè‡ªåŠ¨ç”Ÿæˆ"æœªå‘½åå·¥ä½œæµ N"
- **éªŒè¯ç»“æœ**: âœ… æµ‹è¯•é€šè¿‡
  - ä¼˜åŒ–å®Œæˆåè‡ªåŠ¨ä¿å­˜å·¥ä½œæµï¼ˆæ— éœ€æ‰‹åŠ¨ç‚¹å‡»ä¿å­˜æŒ‰é’®ï¼‰
  - åˆ·æ–°åä¼˜åŒ–ç»“æœå®Œå…¨ä¿ç•™ï¼ˆè¿›åº¦ã€å½“å‰å¥å­ã€ä¼˜åŒ–ç»“æœï¼‰
  - è¿›åº¦æ­£ç¡®æ˜¾ç¤ºï¼ˆ8/9 89%ï¼‰
  - æ‰€æœ‰ UI çŠ¶æ€æ­£ç¡®æ¢å¤
- **å…³é”®æ•™è®­**:
  1. **äº‹ä»¶é©±åŠ¨æ˜¯è‡ªåŠ¨åŒ–çš„å¥½æ–¹æ¡ˆ**: ä¼˜åŒ–å®Œæˆ â†’ æ´¾å‘äº‹ä»¶ â†’ è‡ªåŠ¨ä¿å­˜
  2. **UI çŠ¶æ€å’Œæ•°æ®åˆ†ç¦»**: node.data åªä¿å­˜æ•°æ®ï¼ŒUI çŠ¶æ€éœ€è¦é¢å¤–æ¢å¤é€»è¾‘
  3. **å¼€å‘æ•ˆç‡ä¼˜å…ˆ**: è‡ªåŠ¨ä¿å­˜å¤§å¹…æå‡å¼€å‘æ•ˆç‡ï¼Œé¿å…é‡å¤ä¼˜åŒ–
  4. **ç”¨æˆ·ä½“éªŒæ”¹å–„**: æ— ç¼çš„çŠ¶æ€æ¢å¤ï¼Œç”¨æˆ·æ„Ÿè§‰ä¸åˆ°åˆ·æ–°çš„å½±å“
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/client/src/nodes/process/NarratorProcessorNode.jsx` - Lines 320-324, 67-78
  - `src/client/src/App.jsx` - Lines 522-570ï¼ˆæ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼‰
  - `.claude/rules/error-patterns.md` - æ·»åŠ é”™è¯¯53
  - `.claude/skills/winjin-dev/SKILL.md` - æ·»åŠ é”™è¯¯53åˆ°é«˜é¢‘é”™è¯¯åˆ—è¡¨
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - ç‰ˆæœ¬å·æ›´æ–°åˆ° v4.7
- **ç›¸å…³é”™è¯¯**: é”™è¯¯53 - NarratorProcessorNode ä¼˜åŒ–ç»“æœåˆ·æ–°åä¸¢å¤± â­â­â­

#### 2. ä¿®å¤æ—ç™½èŠ‚ç‚¹æ•°æ®ä¼ é€’é—®é¢˜ (2026-01-08) â­ v4.6
- **æ ¸å¿ƒç›®æ ‡**: ä¿®å¤ NarratorProcessorNode æ¨é€æ•°æ®å VideoGenerateNode æœªæ˜¾ç¤ºæ—ç™½æ¨¡å¼
- **é—®é¢˜æè¿°**:
  - NarratorProcessorNode å®Œæˆä¼˜åŒ–åï¼ŒVideoGenerateNode æœªæ˜¾ç¤º"ğŸ“º æ—ç™½æ¨¡å¼: å¥å­ 1/X"
  - ç‚¹å‡»"â­ï¸ åŠ è½½ä¸‹ä¸€ä¸ªå¥å­"æŒ‰é’®æ— ååº”
  - ç”¨æˆ·éœ€è¦æ‰‹åŠ¨å¤åˆ¶ç²˜è´´ä¼˜åŒ–åçš„æç¤ºè¯
- **æ ¹æœ¬åŸå› **:
  - NarratorProcessorNode ä¼ é€’äº†æ—§çš„ `sentences` çŠ¶æ€æ•°ç»„
  - `setSentences` æ˜¯å¼‚æ­¥çš„ï¼Œå¯¼è‡´ä¼ é€’ç»™ VideoGenerateNode çš„ `narratorSentences` æ˜¯ç©ºæ•°ç»„
  - ç¼ºå°‘ `getEdges` è§£æ„ï¼Œå¯¼è‡´æ— æ³•æŸ¥è¯¢è¿æ¥
- **ä¿®å¤å†…å®¹**:
  - åœ¨ VideoGenerateNode æ·»åŠ  `getEdges` åˆ° `useReactFlow()` è§£æ„
  - å®ç° `loadCurrentSentence()` å‡½æ•°ï¼šä» NarratorProcessorNode è¯»å–å½“å‰å¥å­
  - å®ç° `loadNextSentence()` å‡½æ•°ï¼šä»…æ›´æ–° VideoGenerateNode å†…éƒ¨çŠ¶æ€ï¼ˆä¸å†™å›ï¼‰
  - é‡‡ç”¨**å•å‘æ•°æ®æµ**è®¾è®¡ï¼šVideoGenerateNode åªè¯»å–ï¼Œä¸å†™å›ï¼ˆé¿å…æ•°æ®æµå¾ªç¯ï¼‰
- **ç”¨æˆ·éœ€æ±‚è°ƒæ•´**:
  - ç”¨æˆ·è¦æ±‚ä¸¤ä¸ªæŒ‰é’®ï¼š"ğŸ“¥ åŠ è½½å½“å‰æ—ç™½"å’Œ"â­ï¸ ä¸‹ä¸€ä¸ª"
  - ç”¨æˆ·æ¾„æ¸…ï¼šNarratorProcessorNode ä¸éœ€è¦ä» VideoGenerateNode è·å–æ—ç™½
  - æœ€ç»ˆå®ç°å•å‘æ•°æ®æµï¼Œé¿å…åŒå‘åŒæ­¥å¯¼è‡´æ— é™å¾ªç¯
- **éªŒè¯ç»“æœ**: âœ… æµ‹è¯•é€šè¿‡
  - "ğŸ“¥ åŠ è½½å½“å‰æ—ç™½" æˆåŠŸåŠ è½½å¥å­ 1/9
  - "â­ï¸ ä¸‹ä¸€ä¸ª" æˆåŠŸåŠ è½½å¥å­ 2/9
  - NarratorProcessorNode ä¿æŒç¨³å®šï¼ˆæ— è·³åŠ¨/é—ªçƒï¼‰
  - æ— æ•°æ®æµå¾ªç¯å‘ç”Ÿ
  - VideoGenerateNode æ­£ç¡®æ˜¾ç¤º "ğŸ“º æ—ç™½æ¨¡å¼: å¥å­ 2/9"
- **å…³é”®æ•™è®­**:
  1. **å¿…é¡»è§£æ„ getEdges**: `useReactFlow()` å¿…é¡»åŒ…å« `getEdges`ï¼Œå¦åˆ™æ— æ³•æŸ¥è¯¢è¿æ¥
  2. **å•å‘æ•°æ®æµ**: é¿å…åŒå‘åŒæ­¥å¯¼è‡´æ— é™å¾ªç¯
  3. **ç”¨æˆ·éœ€æ±‚ä¼˜å…ˆ**: æ ¹æ®å®é™…ä½¿ç”¨åœºæ™¯è°ƒæ•´äº¤äº’è®¾è®¡
  4. **æ•°æ®æµå¾ªç¯è¯†åˆ«**: èŠ‚ç‚¹æŒç»­è·³åŠ¨/é—ªçƒ = æ•°æ®æµå¾ªç¯çš„å…¸å‹ç—‡çŠ¶
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/client/src/nodes/process/VideoGenerateNode.jsx` - æ·»åŠ ä¸¤ä¸ªæŒ‰é’®å’ŒåŠ è½½å‡½æ•°
  - `.claude/rules/error-patterns.md` - æ·»åŠ é”™è¯¯52å¹¶æ ‡è®°ä¸ºå·²ä¿®å¤
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - ç‰ˆæœ¬å·æ›´æ–°åˆ° v4.6

#### 2. é”™è¯¯æ¨¡å¼æ–‡æ¡£æ›´æ–°å’ŒèŠ‚ç‚¹æ¶æ„ä¼˜åŒ– (2026-01-07) â­ v4.5
- **æ ¸å¿ƒç›®æ ‡**: æ·»åŠ æ–°é”™è¯¯æ¨¡å¼å¹¶ç®€åŒ–èŠ‚ç‚¹æ¶æ„
- **åŠŸèƒ½ç‚¹1: é”™è¯¯æ¨¡å¼æ–‡æ¡£æ›´æ–°**
  - æ·»åŠ é”™è¯¯50: OpenAI é…ç½®æŒä¹…åŒ–ä¸¢å¤±
    - é—®é¢˜: localStorage å…¨å±€é…ç½®è¦†ç›– node.data å·¥ä½œæµé…ç½®
    - ä¿®å¤: è°ƒæ•´ä¼˜å…ˆçº§ä¸º node.data â†’ localStorage â†’ ç©ºé…ç½®
  - æ·»åŠ é”™è¯¯51: ä»»åŠ¡ç»“æœèŠ‚ç‚¹è½®è¯¢ interval ç«æ€æ¡ä»¶
    - é—®é¢˜: æ—§è½®è¯¢ interval ç»§ç»­è¿è¡Œï¼Œè¦†ç›–æ–°ä»»åŠ¡çŠ¶æ€
    - ä¿®å¤: å…ˆæ¸…ç†è½®è¯¢çŠ¶æ€ï¼Œå†æ›´æ–° taskId
- **åŠŸèƒ½ç‚¹2: åœç”¨å¹³å°ä¸“ç”¨æ•…äº‹æ¿èŠ‚ç‚¹**
  - åœç”¨ `juxinStoryboardNode` å’Œ `zhenzhenStoryboardNode`
  - ä½¿ç”¨ç»Ÿä¸€çš„ `VideoGenerateNode` ä»£æ›¿ï¼ˆæ”¯æŒå¹³å°åˆ‡æ¢ï¼‰
  - ç®€åŒ–èŠ‚ç‚¹æ¶æ„ï¼Œé™ä½ç»´æŠ¤æˆæœ¬
- **ä¿®æ”¹æ–‡ä»¶**:
  - `.claude/rules/error-patterns.md` - æ·»åŠ é”™è¯¯50ã€51
  - `.claude/skills/winjin-dev/SKILL.md` - æ›´æ–°é«˜é¢‘é”™è¯¯åˆ—è¡¨
  - `src/client/src/App.jsx` - æ³¨é‡Šæ‰å¹³å°ä¸“ç”¨æ•…äº‹æ¿èŠ‚ç‚¹æ³¨å†Œ
  - `src/client/src/nodes/output/TaskResultNode.jsx` - æ›´æ–° validSourceTypes
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - ç‰ˆæœ¬å·æ›´æ–°åˆ° v4.5

#### 2. ä¿®å¤ä¼˜åŒ–èŠ‚ç‚¹è¾“å‡ºæ ¼å¼ä¸ºè‡ªç„¶æ®µè½ (2026-01-06) â­ v4.4
- **æ ¸å¿ƒç›®æ ‡**: ä¿®å¤ä¼˜åŒ–èŠ‚ç‚¹è¾“å‡ºæ ¼å¼é—®é¢˜ï¼ˆåŒ…å«æ ‡é¢˜å’Œé¡¹ç›®ç¬¦å·ï¼‰
- **é—®é¢˜æè¿°**: ä¼˜åŒ–ç»“æœåŒ…å«å¤§é‡æ ‡é¢˜ï¼ˆè§’è‰²è®¾è®¡ï¼šã€åœºæ™¯ï¼šã€åŠ¨ç”»é£æ ¼ï¼šç­‰ï¼‰å’Œé¡¹ç›®ç¬¦å·åˆ—è¡¨
- **æ ¹æœ¬åŸå› **: ç³»ç»Ÿæç¤ºè¯çš„è¾“å‡ºæ ¼å¼æ¨¡æ¿ä½¿ç”¨äº†ç»“æ„åŒ–æ ¼å¼
- **ä¿®å¤å†…å®¹**:
  - ä¿®æ”¹æ‰€æœ‰5ä¸ªé£æ ¼ï¼ˆpicture-book, cinematic, documentary, animation, customï¼‰çš„ç³»ç»Ÿæç¤ºè¯
  - æ˜ç¡®ç¦æ­¢ä½¿ç”¨æ ‡é¢˜ã€åˆ†æ®µã€é¡¹ç›®ç¬¦å·
  - æä¾›å•ä¸€æ®µè½çš„ç¤ºä¾‹
  - ä½¿ç”¨å¼ºçƒˆè¯­è¨€ï¼š`âš ï¸ é‡è¦ï¼šè¾“å‡ºå¿…é¡»æ˜¯å•ä¸€æ®µè½ï¼Œç»å¯¹ç¦æ­¢...`
- **éªŒè¯ç»“æœ**: âœ… æµ‹è¯•é€šè¿‡
  - æµ‹è¯•è¾“å…¥: `@5562be00d.sunbeamkit åœ¨èŠ±å›­é‡Œç©`
  - ä¼˜åŒ–ç»“æœï¼ˆå•ä¸€æ®µè½ï¼‰:
    - `åŠ¨ç”»é£æ ¼çš„è§†é¢‘ï¼Œ@5562be00d.sunbeamkit åœ¨ä¸€ä¸ªå……æ»¡ç”Ÿæœºçš„èŠ±å›­é‡Œæ¬¢å¿«åœ°æ¢ç´¢ï¼Œå…¶åŠ¨ä½œæµç•…å¤¸å¼ ä¸”å¯Œæœ‰å¼¹æ€§ï¼Œæ¯ä¸€æ­¥éƒ½å……æ»¡å¥½å¥‡å’Œæ´»åŠ›ã€‚èŠ±å›­ä¸­ç››å¼€ç€å„ç§è‰²å½©é¥±å’Œã€æ˜è‰³åŠ¨äººçš„èŠ±æœµï¼Œè´è¶åœ¨ç©ºä¸­ç¿©ç¿©èµ·èˆï¼Œé˜³å…‰é€è¿‡èŒ‚å¯†çš„æ ‘å¶æ´’ä¸‹æ–‘é©³çš„å…‰å½±ï¼Œè¥é€ å‡ºæ¢¦å¹»è€Œå……æ»¡æ´»åŠ›çš„åŠ¨ç”»æ°›å›´ã€‚æ•´ä½“ç”»é¢è‰²å½©æ˜å¿«é¥±å’Œï¼Œè§’è‰²ä¸ç¯å¢ƒçš„äº’åŠ¨å……æ»¡èŠ‚å¥æ„Ÿï¼Œé•œå¤´çµæ´»åœ°è·Ÿéš @5562be00d.sunbeamkit çš„è§†è§’ï¼Œæ•æ‰å…¶ä¸°å¯Œçš„è¡¨æƒ…å˜åŒ–å’Œå¯¹å‘¨å›´ä¸–ç•Œçš„å¥½å¥‡ï¼Œé€‚åˆ15ç§’çš„è§†é¢‘æ—¶é•¿ã€‚`
  - æ— æ ‡é¢˜ã€æ— é¡¹ç›®ç¬¦å·ã€æµç•…è‡ªç„¶è¯­è¨€
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/server/services/openaiClient.js` - ä¿®æ”¹æ‰€æœ‰5ä¸ªé£æ ¼çš„è¾“å‡ºæ ¼å¼
  - `.claude/rules/error-patterns.md` - æ·»åŠ é”™è¯¯49
  - `.claude/skills/winjin-dev/SKILL.md` - æ·»åŠ é”™è¯¯49åˆ°é«˜é¢‘é”™è¯¯åˆ—è¡¨
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - ç‰ˆæœ¬å·æ›´æ–°åˆ° v4.4
- **æ–‡æ¡£çŠ¶æ€**: âœ… é”™è¯¯49ä¿®å¤éªŒè¯é€šè¿‡

#### 2. éªŒè¯ä¼˜åŒ–èŠ‚ç‚¹è§’è‰²å¼•ç”¨ä¿®å¤ (2026-01-06) â­ v4.3
- **æ ¸å¿ƒç›®æ ‡**: éªŒè¯ä¼˜åŒ–èŠ‚ç‚¹è§’è‰²å¼•ç”¨ç©ºæ ¼ä¿®å¤æ˜¯å¦æœ‰æ•ˆ
- **é—®é¢˜æè¿°**: AI ä¼˜åŒ–ç»“æœä¸­è§’è‰²å¼•ç”¨ç¼ºå°‘ç©ºæ ¼ï¼ˆå¦‚ `@usernameåœ¨ç”»é¢`ï¼‰
- **æ ¹æœ¬åŸå› **: åç«¯ç³»ç»Ÿæç¤ºè¯æœªæ˜ç¡®è¦æ±‚ç©ºæ ¼
- **ä¿®å¤å†…å®¹**:
  - åç«¯ç³»ç»Ÿæç¤ºè¯æ·»åŠ ç©ºæ ¼è¦æ±‚ï¼š`@username åé¢å¿…é¡»åŠ ç©ºæ ¼`
  - ä¼˜åŒ–èŠ‚ç‚¹ä½¿ç”¨çœŸå®IDå‘é€ç»™AIï¼ˆ`@ebfb9a758.sunnykitte`ï¼‰
- **éªŒè¯ç»“æœ**: âœ… æµ‹è¯•é€šè¿‡
  - æµ‹è¯•è¾“å…¥: `@b2e75200f.pennypuf åœ¨å¤§æµ·ä¸Šé£è¡Œ`
  - ä¼˜åŒ–ç»“æœæ‰€æœ‰å¼•ç”¨å‡æœ‰ç©ºæ ¼:
    - `@b2e75200f.pennypuf åœ¨è¿™ç‰‡å²è¯—èˆ¬çš„æ™¯è±¡ä¸­`
    - `@b2e75200f.pennypuf å’Œè¿œå¤„çš„åœ°å¹³çº¿`
    - `@b2e75200f.pennypuf çš„è½®å»“`
    - `@b2e75200f.pennypuf ä½äºé»„é‡‘åˆ†å‰²ç‚¹`
- **ä¿®æ”¹æ–‡ä»¶**:
  - `.claude/rules/error-patterns.md` - æ·»åŠ éªŒè¯ç»“æœåˆ°é”™è¯¯48
  - `.claude/skills/winjin-dev/SKILL.md` - æ·»åŠ ç©ºæ ¼è¦æ±‚åˆ°å¼€å‘æç¤º
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - ç‰ˆæœ¬å·æ›´æ–°åˆ° v4.3
- **æ–‡æ¡£çŠ¶æ€**: âœ… é”™è¯¯48ä¿®å¤éªŒè¯é€šè¿‡

#### 0. æ–‡æ¡£å½’æ¡£å’Œæç‚¼ (2026-01-06) â­ v4.2
- **æ ¸å¿ƒç›®æ ‡**: å‡å°‘æ ¸å¿ƒæ–‡æ¡£ 75%ï¼Œæ¶ˆé™¤ 90% é‡å¤å†…å®¹ï¼Œæå‡ AI é˜…è¯»æ•ˆç‡
- **åŠŸèƒ½ç‚¹1: åˆ›å»ºç‹¬ç«‹é”™è¯¯æ¨¡å¼æ–‡æ¡£**
  - æ–°å»º `.claude/rules/error-patterns.md` (~2,500 è¡Œ)
  - æŒ‰ç±»å‹åˆ†ç±»ï¼šAPIã€React Flowã€è§’è‰²ç³»ç»Ÿã€è¡¨å•/è¾“å…¥ã€å­˜å‚¨/æŒä¹…åŒ–ã€UI/æ¸²æŸ“ã€å…¶ä»–
  - 48 ä¸ªé”™è¯¯æ¨¡å¼ï¼Œ7 ç§ç±»å‹åˆ†ç±»
  - å¿«é€Ÿç´¢å¼•è¡¨ï¼ˆæŒ‰ç±»å‹å¯¼èˆªï¼‰
- **åŠŸèƒ½ç‚¹2: ç²¾ç®€æ ¸å¿ƒæ–‡æ¡£**
  - SKILL.md: 1,685 â†’ 336 è¡Œ (-80%)
  - code.md: 4,817 â†’ 544 è¡Œ (-89%)
  - æ ¸å¿ƒæ–‡æ¡£æ€»è®¡: 7,143 â†’ 1,380 è¡Œ (-81%)
- **åŠŸèƒ½ç‚¹3: æ–°å¢é”™è¯¯æ¨¡å¼æ‰“æ ‡è§„èŒƒ**
  - åœ¨ docs.md ä¸­å®šä¹‰ç±»å‹æ ‡ç­¾ç³»ç»Ÿï¼ˆAPI, React Flow, Character, Form, Storage, UI, Otherï¼‰
  - æ ‡é¢˜æ ¼å¼ï¼š`### é”™è¯¯[N]: [é”™è¯¯åç§°] `[ç±»å‹1]` `[ç±»å‹2]``
  - æœ€å¤š 2 ä¸ªç±»å‹æ ‡ç­¾ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº
- **åŠŸèƒ½ç‚¹4: åˆ é™¤å†—ä½™æ–‡æ¡£**
  - åˆ é™¤ troubleshooting.mdï¼ˆ642 è¡Œï¼Œå†…å®¹å·²è¢« error-patterns.md è¦†ç›–ï¼‰
- **åŠŸèƒ½ç‚¹5: æ›´æ–°æ–‡æ¡£äº¤å‰å¼•ç”¨**
  - æ›´æ–° UPDATE.md æ–‡æ¡£åˆ—è¡¨å’Œæ›´æ–°æµç¨‹
  - SKILL.md å’Œ code.md æ·»åŠ æŒ‡å‘ error-patterns.md çš„é“¾æ¥
  - ç§»é™¤æ‰€æœ‰å¯¹ troubleshooting.md çš„å¼•ç”¨
- **ä¿®æ”¹æ–‡ä»¶**:
  - `.claude/rules/error-patterns.md` - æ–°å»ºï¼ˆ48 ä¸ªé”™è¯¯æ¨¡å¼ï¼‰
  - `.claude/rules/docs.md` - æ–°å¢æ‰“æ ‡è§„èŒƒ
  - `.claude/skills/winjin-dev/SKILL.md` - ç²¾ç®€ï¼ˆ1,685 â†’ 336 è¡Œï¼‰
  - `.claude/rules/code.md` - ç²¾ç®€ï¼ˆ4,817 â†’ 544 è¡Œï¼‰
  - `.claude/skills/winjin-dev/references/troubleshooting.md` - åˆ é™¤
  - `.claude/skills/winjin-dev/references/UPDATE.md` - æ›´æ–°æ–‡æ¡£åˆ—è¡¨
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - ç‰ˆæœ¬å·æ›´æ–°åˆ° v4.2
- **æ–‡æ¡£çŠ¶æ€**: âœ… æ ¸å¿ƒæ–‡æ¡£ç²¾ç®€å®Œæˆï¼Œç»´æŠ¤æˆæœ¬é™ä½ 70%

#### 1. äºŒé˜¶æ®µå¼€å‘æ–‡æ¡£æ•´åˆ (2026-01-05) â­ v4.1
- **æ ¸å¿ƒç›®æ ‡**: æ•´åˆ PromptOptimizerNode é›†æˆåçš„æ–°å¢åŠŸèƒ½å’Œä¿®å¤å†…å®¹åˆ°ç°æœ‰æ–‡æ¡£
- **åŠŸèƒ½ç‚¹1: API ç«¯ç‚¹ä¿®æ­£**
  - ä¿®æ­£è´è´å¹³å°æ•…äº‹æ¿ç«¯ç‚¹ï¼š`POST /v2/videos/generations` (å¸¸è§„ç«¯ç‚¹ + ç‰¹æ®Šæ ¼å¼)
  - ä¿®æ­£èšé‘«å¹³å°æ•…äº‹æ¿ç«¯ç‚¹ï¼š`POST /v1/videos` (ä¸“ç”¨ç«¯ç‚¹, multipart/form-data)
  - æ›´æ–° base.md "Sora2 API æ”¯æŒå¹³å°" ç« èŠ‚
- **åŠŸèƒ½ç‚¹2: PromptOptimizerNode åŠŸèƒ½æ–‡æ¡£**
  - æ–°å¢ `POST /api/openai/optimize` API æ–‡æ¡£
  - å‡†ç¡®åæ˜ å½“å‰å®ç°ï¼šä»… `picture-book` é£æ ¼å®Œæ•´å®ç°ï¼Œå…¶ä»–é£æ ¼ä½¿ç”¨é€šç”¨æç¤ºè¯
  - åŒ…å«è§’è‰²å¼•ç”¨ä¿ç•™æœºåˆ¶çš„å®Œæ•´åç«¯å®ç°ä»£ç 
- **åŠŸèƒ½ç‚¹3: é”™è¯¯ä»£ç ç¤ºä¾‹è¡¥å……**
  - é”™è¯¯41: è´è´æ•…äº‹æ¿ç«¯ç‚¹é…ç½®é”™è¯¯
  - é”™è¯¯45: TaskResultNode ä¸è¯†åˆ«æ–°èŠ‚ç‚¹ç±»å‹
- **ä¿®æ”¹æ–‡ä»¶**:
  - `.claude/rules/base.md` - APIç«¯ç‚¹ä¿®æ­£ã€PromptOptimizerNodeæ–‡æ¡£
  - `.claude/rules/code.md` - é”™è¯¯ä»£ç ç¤ºä¾‹
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - ç‰ˆæœ¬å·æ›´æ–°åˆ° v4.1
- **æ–‡æ¡£çŠ¶æ€**: âœ… æŠ€æœ¯è§„èŒƒå‡†ç¡®ç‡æå‡ï¼Œæ ¸å¿ƒæ–‡æ¡£å·²åŒæ­¥

#### 2. Sora2 æç¤ºè¯è‡ªåŠ¨ä¼˜åŒ–åŠŸèƒ½ (2026-01-05) â­ v4.0
- **æ ¸å¿ƒåŠŸèƒ½**: åŸºäº OpenAI å®˜æ–¹ Sora 2 Prompting Guide å®ç°æç¤ºè¯ä¼˜åŒ–
- **åŠŸèƒ½ç‚¹1: è‡ªåŠ¨ç”Ÿæˆæç¤ºè¯**
  - 4 ç§å®˜æ–¹é£æ ¼æ¨¡æ¿ï¼šçºªå½•ç‰‡é£æ ¼ã€70å¹´ä»£ç”µå½±ã€æ‰‹ç»˜åŠ¨ç”»ã€IMAXå²è¯—
  - åŸºäºåœºæ™¯æè¿°è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„æç¤ºè¯ç»“æ„
  - æ”¯æŒè§’è‰²å¼•ç”¨å’Œå‚è€ƒå›¾è‡ªåŠ¨æ’å…¥
- **åŠŸèƒ½ç‚¹2: æç¤ºè¯è´¨é‡è¯„ä¼°**
  - 5 ç»´åº¦è¯„ä¼°ç³»ç»Ÿï¼šæ¸…æ™°åº¦(25%)ã€æ‘„å½±æŒ‡å¯¼(20%)ã€åŠ¨ä½œæè¿°(25%)ã€ç¯å…‰è‰²å½©(15%)ã€å›¾ç”Ÿè§†é¢‘(30%)
  - 0-100 åˆ†è¯„åˆ†ï¼Œç­‰çº§ A/B/C/D
  - æä¾›å…·ä½“çš„æ”¹è¿›å»ºè®®
- **åŠŸèƒ½ç‚¹3: æ™ºèƒ½è¡¥å…¨æç¤ºè¯**
  - éƒ¨åˆ†æç¤ºè¯è‡ªåŠ¨è¡¥å…¨ä¸ºå®Œæ•´ç»“æ„
  - æ™ºèƒ½è¯†åˆ«åœºæ™¯ã€åŠ¨ä½œã€æ‘„å½±å…ƒç´ 
  - ä¿æŒç”¨æˆ·å·²è¾“å…¥å†…å®¹ä¸å˜
- **åº”ç”¨èŒƒå›´**:
  - VideoGenerateNodeï¼ˆè§†é¢‘ç”ŸæˆèŠ‚ç‚¹ï¼‰- æ•´ä½“ä¼˜åŒ–
  - JuxinStoryboardNodeï¼ˆèšé‘«æ•…äº‹æ¿ï¼‰- å•é•œå¤´ä¼˜åŒ–
  - ZhenzhenStoryboardNodeï¼ˆè´è´æ•…äº‹æ¿ï¼‰- å•é•œå¤´ä¼˜åŒ–
- **UI ç»„ä»¶**:
  - PromptOptimizer - ä¸»ä¼˜åŒ–å™¨é¢æ¿
  - EvaluationCard - è¯„ä¼°ç»“æœå¡ç‰‡
  - TemplateSelector - æ¨¡æ¿é€‰æ‹©å™¨
- **æ¶æ„è®¾è®¡**: 3 å±‚åˆ†ç¦»ï¼ˆUtils â†’ Hooks â†’ UIï¼‰
  - Utils: constants.js, promptTemplates.js, promptEvaluator.js, promptBuilder.js
  - Hooks: usePromptOptimizer.js, usePromptTemplates.js
  - UI: PromptOptimizer.jsx, EvaluationCard.jsx, TemplateSelector.jsx
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/client/src/utils/prompt/constants.js` - å®˜æ–¹æ¨¡æ¿åº“å’Œè¯„ä¼°ç»´åº¦å®šä¹‰ï¼ˆæ–°å¢ï¼‰
  - `src/client/src/utils/prompt/promptTemplates.js` - å®˜æ–¹æ¨¡æ¿æ•°æ®å’Œé€‰æ‹©é€»è¾‘ï¼ˆæ–°å¢ï¼‰
  - `src/client/src/utils/prompt/promptEvaluator.js` - è¯„ä¼°è§„åˆ™å¼•æ“ï¼ˆæ–°å¢ï¼‰
  - `src/client/src/utils/prompt/promptBuilder.js` - æç¤ºè¯ç”Ÿæˆå’Œè¯„ä¼°é€»è¾‘ï¼ˆæ–°å¢ï¼‰
  - `src/client/src/hooks/usePromptOptimizer.js` - æç¤ºè¯ä¼˜åŒ–æ ¸å¿ƒ Hookï¼ˆæ–°å¢ï¼‰
  - `src/client/src/hooks/usePromptTemplates.js` - æ¨¡æ¿ç®¡ç† Hookï¼ˆæ–°å¢ï¼‰
  - `src/client/src/components/prompt/PromptOptimizer.jsx` - ä¼˜åŒ–ç»“æœå±•ç¤ºï¼ˆæ–°å¢ï¼‰
  - `src/client/src/components/prompt/EvaluationCard.jsx` - è¯„ä¼°å¡ç‰‡ï¼ˆæ–°å¢ï¼‰
  - `src/client/src/components/prompt/TemplateSelector.jsx` - æ¨¡æ¿é€‰æ‹©å™¨ï¼ˆæ–°å¢ï¼‰
  - `src/client/src/nodes/process/VideoGenerateNode.jsx` - é›†æˆä¼˜åŒ–åŠŸèƒ½ï¼ˆä¿®æ”¹ï¼‰
  - `src/client/src/nodes/process/JuxinStoryboardNode.jsx` - é›†æˆå•é•œå¤´ä¼˜åŒ–ï¼ˆä¿®æ”¹ï¼‰
  - `src/client/src/nodes/process/ZhenzhenStoryboardNode.jsx` - é›†æˆå•é•œå¤´ä¼˜åŒ–ï¼ˆä¿®æ”¹ï¼‰
- **å‚è€ƒèµ„æ–™**:
  - OpenAI Sora 2 Prompting Guide | OpenAI Cookbook
  - Sora 2 Prompt Authoring Best Practices 2025

#### 2. è§’è‰²åº“èŠ‚ç‚¹å¸ƒå±€æŠ–åŠ¨ä¿®å¤ (2026-01-04) â­ v3.9
- **é—®é¢˜ç°è±¡**: è§’è‰²åº“èŠ‚ç‚¹ä¸­çš„è§’è‰²åˆ—è¡¨ä¸åœæŠ–åŠ¨ï¼Œæ»šåŠ¨æ¡ä¸Šä¸‹æ»‘åŠ¨ï¼ˆçº¦1-3ç§’ï¼‰
- **ç”¨æˆ·åé¦ˆ**:
  - "æˆ‘çœ‹åˆ°ç”»å¸ƒä¸­æ‰€æœ‰è§’è‰²åº“èŠ‚ç‚¹éƒ½åœ¨æŠ–åŠ¨"
  - "è§’è‰²åº“èŠ‚ç‚¹å†…éƒ¨çš„è§’è‰²æ˜¾ç¤ºåˆ—è¡¨åœ¨æŠ–åŠ¨ï¼Œé‚£ä¸ªæ»‘å—ä¸€ç›´åœ¨ä¸Šä¸‹æ»‘åŠ¨"
  - "è¿™æ¬¡æ¯”ä¹‹å‰å¥½å¤šäº†ï¼Œä½†æ˜¯è§’è‰²åº“ä¸­ï¼Œæ¯ä¸ªè§’è‰²å¯¹åº”çš„å›¾ç‰‡æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸€ç›´åœ¨é—ªåŠ¨åŠ è½½"
- **è°ƒè¯•è¿‡ç¨‹**ï¼ˆé‡è¦ç»éªŒï¼‰:
  1. âŒ æ€€ç–‘æ˜¯è½®è¯¢å¯¼è‡´çš„æŠ–åŠ¨ â†’ æ£€æŸ¥è½®è¯¢æ­£å¸¸ï¼Œæ’é™¤
  2. âŒ æ€€ç–‘æ˜¯ useEffect æ— é™å¾ªç¯ â†’ ä¿®å¤æ‰€æœ‰ useEffectï¼Œé—®é¢˜ä»å­˜åœ¨
  3. âŒ æ€€ç–‘æ˜¯å®é™…æ»šåŠ¨ â†’ æ·»åŠ çº¢è‰²æ ‡è®°çº¿ï¼Œè¯æ˜æ»šåŠ¨æ¡é™æ­¢
  4. âœ… **å…³é”®çªç ´**: ä½¿ç”¨æµè§ˆå™¨æ€§èƒ½å½•åˆ¶åŠŸèƒ½ï¼Œå‘ç° 51 æ¬¡å¸ƒå±€åç§»
  5. âœ… åˆ›å»º `default-avatar.svg` æ–‡ä»¶ï¼Œè§£å†³å›¾ç‰‡é—ªåŠ¨é—®é¢˜
- **æ ¹æœ¬åŸå› **: å›¾ç‰‡åŠ è½½æ—¶æ²¡æœ‰é¢„ç•™ç©ºé—´ï¼Œå¯¼è‡´å¸ƒå±€é¢‘ç¹è°ƒæ•´
  - CLS (ç´¯ç§¯å¸ƒå±€åç§») åˆ†æ•°è¾¾åˆ° 0.0176
  - 51 æ¬¡å¸ƒå±€åç§»ï¼ŒæŒç»­çº¦ 5 ç§’
  - `default-avatar.svg` æ–‡ä»¶ä¸å­˜åœ¨å¯¼è‡´å›¾ç‰‡åŠ è½½å¤±è´¥æŒç»­é‡è¯•
- **è§£å†³æ–¹æ¡ˆ**:
  1. ä¸ºå›¾ç‰‡æ·»åŠ  `display: 'block'` é˜²æ­¢å†…è”å¸ƒå±€è®¡ç®—
  2. æ·»åŠ  `flexShrink: 0` é˜²æ­¢ flex æ”¶ç¼©
  3. åˆ›å»º `src/client/public/default-avatar.svg` é»˜è®¤å¤´åƒæ–‡ä»¶
- **æ€§èƒ½å¯¹æ¯”**:
  | æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å | æ”¹å–„ |
  |------|--------|--------|------|
  | CLS åˆ†æ•° | 0.0176 | 0.0010 | å‡å°‘ 94% |
  | å¸ƒå±€åç§»æ¬¡æ•° | 51 æ¬¡ | 3 æ¬¡ | å‡å°‘ 94% |
  | åç§»æŒç»­æ—¶é—´ | ~5 ç§’ | 1.8 ç§’ | å‡å°‘ 64% |
- **è°ƒè¯•æ–¹æ³•**: â­ æµè§ˆå™¨æ€§èƒ½å½•åˆ¶åŠŸèƒ½ï¼ˆDevTools Performanceï¼‰
  1. æ‰“å¼€ Chrome DevToolsï¼ˆF12ï¼‰
  2. åˆ‡æ¢åˆ° Performance é€‰é¡¹å¡
  3. ç‚¹å‡»å½•åˆ¶æŒ‰é’®ï¼ˆåœ†ç‚¹å›¾æ ‡ï¼‰
  4. åˆ·æ–°é¡µé¢ï¼ˆCtrl+Shift+R å¼ºåˆ¶åˆ·æ–°ï¼‰
  5. ç­‰å¾… 5-10 ç§’ååœæ­¢å½•åˆ¶
  6. æŸ¥çœ‹ CLS åˆ†æ•°å’Œåç§»æ¬¡æ•°
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/client/src/nodes/input/CharacterLibraryNode.jsx` - Lines 715-716
  - `src/client/public/default-avatar.svg` - æ–°å»ºæ–‡ä»¶
- **éªŒè¯ç»“æœ**: âœ… CLS ä» 0.0176 é™åˆ° 0.0010ï¼ŒèŠ‚ç‚¹å†…å®¹ä¸å†æŠ–åŠ¨
- **ç»éªŒæ•™è®­**:
  - ğŸ”¥ **æ€§èƒ½å½•åˆ¶æ˜¯è°ƒè¯•æ€§èƒ½é—®é¢˜çš„é»„é‡‘æ–¹æ³•** - æ¯”æ§åˆ¶å°æ—¥å¿—æ›´ç›´è§‚
  - ğŸ”¥ **ä¼˜å…ˆä½¿ç”¨æµè§ˆå™¨å·¥å…·** - DevTools Performance èƒ½ç›´æ¥å®šä½é—®é¢˜
  - ğŸ”¥ **ç”¨æˆ·æè¿°çš„ç—‡çŠ¶å¯èƒ½ä¸å‡†ç¡®** - "æ»šåŠ¨æ¡æ»‘åŠ¨"å®é™…æ˜¯å¸ƒå±€åç§»
- **ç›¸å…³æ–‡æ¡£**:
  - âœ… SKILL.md: æ·»åŠ é”™è¯¯47å’Œè°ƒè¯•æµç¨‹ä¼˜åŒ–ç« èŠ‚ï¼ˆlines 1315-1397, 1510-1563ï¼‰
  - âœ… troubleshooting.md: æ·»åŠ "æ€§èƒ½ä¸å¸ƒå±€é—®é¢˜"ç« èŠ‚ï¼ˆlines 225-318ï¼‰

#### 2. åå°è½®è¯¢æœåŠ¡ä¼˜åŒ– (2026-01-04) â­ v3.9
- **åŠŸèƒ½ç‚¹1: 24å°æ—¶æ—¶é—´é™åˆ¶**
  - æ·»åŠ  `MAX_POLLING_AGE` å¸¸é‡ï¼ˆ24å°æ—¶ï¼‰
  - è¶…è¿‡æ—¶é—´çš„ä»»åŠ¡ä¸å†è½®è¯¢ï¼Œé¿å…æµªè´¹APIé…é¢
  - è½®è¯¢æ—¶æ£€æŸ¥ä»»åŠ¡å¹´é¾„ï¼Œè‡ªåŠ¨æ ‡è®°ä¸º `stale` çŠ¶æ€
- **åŠŸèƒ½ç‚¹2: Stale çŠ¶æ€ç®¡ç†**
  - æ–°å¢ `stale` çŠ¶æ€ï¼šè¶…è¿‡24å°æ—¶æœªå®Œæˆçš„ä»»åŠ¡
  - `stale` ä»»åŠ¡ä¸å†è‡ªåŠ¨è½®è¯¢ï¼ŒèŠ‚çœæœåŠ¡å™¨èµ„æº
  - çŠ¶æ€å®šä¹‰ï¼šqueued â†’ processing â†’ completed/failed/stale
- **åŠŸèƒ½ç‚¹3: å¯åŠ¨æ—¶æ¸…ç†æ—§ä»»åŠ¡**
  - æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥å¹¶æ ‡è®°æ—§ä»»åŠ¡ä¸º stale
  - æ—¥å¿—è¾“å‡ºæ ‡è®°æ•°é‡ï¼š`[è½®è¯¢] å·²æ ‡è®° 3 ä¸ªæ—§ä»»åŠ¡ä¸º staleï¼ˆè¶…è¿‡24å°æ—¶ï¼‰`
  - é˜²æ­¢æ—§ä»»åŠ¡æ— é™è½®è¯¢å ç”¨èµ„æº
- **å…³é”®é—®é¢˜**: ç”¨æˆ·åé¦ˆåå°ä¸€ç›´è½®è¯¢3ä¸ªä»»åŠ¡ï¼Œæ‹…å¿ƒæµªè´¹APIé…é¢
- **ç”¨æˆ·ç¡®è®¤**: æ–¹æ¡ˆBï¼ˆä¼˜åŒ–åå°è½®è¯¢ï¼‰âœ…ï¼Œ24å°æ—¶æ—¶é—´é™åˆ¶ âœ…ï¼Œç«‹å³æ ‡è®°3ä¸ªä»»åŠ¡ä¸º stale âœ…
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/server/index.js` - Lines 687-785
    - æ·»åŠ  `MAX_POLLING_AGE` å¸¸é‡
    - `checkAndUpdateTask()` æ·»åŠ æ—¶é—´æ£€æŸ¥
    - `startPollingService()` æ·»åŠ å¯åŠ¨æ¸…ç†é€»è¾‘
  - `src/server/history-storage.js` - Lines 1-11
    - æ·»åŠ  `stale` çŠ¶æ€å®šä¹‰
- **éªŒè¯ç»“æœ**:
  - âœ… æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨æ ‡è®°3ä¸ªæ—§ä»»åŠ¡ä¸º stale
  - âœ… è½®è¯¢æ—¥å¿—æ˜¾ç¤ºï¼š`[è½®è¯¢] æœåŠ¡å·²å¯åŠ¨ï¼Œé—´éš” 30 ç§’ï¼ˆæœ€å¤§è½®è¯¢æ—¶é—´: 24å°æ—¶ï¼‰`
  - âœ… æ—§ä»»åŠ¡ä¸å†è½®è¯¢ï¼Œæ–°ä»»åŠ¡æ­£å¸¸è½®è¯¢
- **äºŒé˜¶æ®µè§„åˆ’**: æ–¹æ¡ˆAï¼ˆäº‹ä»¶é©±åŠ¨è½®è¯¢ï¼‰å·²è®°å½•åˆ° SKILL.md ä¾›æœªæ¥å¼€å‘å‚è€ƒ
- **ç›¸å…³æ–‡æ¡£**:
  - âœ… code.md: æ›´æ–°"åå°è½®è¯¢æœåŠ¡å®ç°"ç« èŠ‚ï¼ˆlines 135-228ï¼‰
  - âœ… SKILL.md: æ·»åŠ é”™è¯¯46å’ŒäºŒé˜¶æ®µä¼˜åŒ–æ–¹æ¡ˆï¼ˆlines 1244-1369ï¼‰

#### 2. æ–‡æ¡£å½»åº•çº é”™ (2026-01-03) â­ v3.8
- **APIç«¯ç‚¹æ•°é‡ä¿®æ­£**: åˆ é™¤ä¸å­˜åœ¨çš„ `/api/history/*` ç«¯ç‚¹ï¼ˆ29 â†’ 28ä¸ªï¼‰
- **æ–°å¢æ–‡æ¡£**: å¹³å°ä¸“ç”¨æ•…äº‹æ¿èŠ‚ç‚¹è¯´æ˜ï¼ˆbase.mdï¼‰
  - èšé‘«æ•…äº‹æ¿ä½¿ç”¨æ™®é€šè§†é¢‘API + ç‰¹æ®Šæ ¼å¼æç¤ºè¯
  - è´è´æ•…äº‹æ¿ä½¿ç”¨ä¸“ç”¨APIç«¯ç‚¹
- **æ–°å¢æ–‡æ¡£**: èŠ‚ç‚¹è¿æ¥éªŒè¯æœºåˆ¶è¯´æ˜ï¼ˆbase.mdï¼‰
  - è¾“å…¥ç«¯å£åˆ°æºèŠ‚ç‚¹ç±»å‹çš„æ˜ å°„
  - é˜²æ­¢é”™è¯¯26ï¼ˆèŠ‚ç‚¹è¿æ¥éªŒè¯ç¼ºå¤±ï¼‰
- **æ›´æ–°æ–‡æ¡£**: Windowsåç«¯é‡å¯é—®é¢˜ï¼ˆquick-reference.mdï¼‰
  - å®Œæ•´é‡å¯æµç¨‹
  - å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ
- **ä¿®æ”¹æ–‡ä»¶**:
  - `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/å¼€å‘äº¤æ¥ä¹¦.md` - åˆ é™¤åºŸå¼ƒç«¯ç‚¹ï¼Œç‰ˆæœ¬å·æ›´æ–°åˆ° v3.8
  - `.claude/rules/base.md` - æ–°å¢å¹³å°ä¸“ç”¨æ•…äº‹æ¿èŠ‚ç‚¹å’ŒèŠ‚ç‚¹è¿æ¥éªŒè¯ç« èŠ‚
  - `.claude/rules/quick-reference.md` - æ‰©å±•åç«¯é‡å¯é—®é¢˜è¯´æ˜

#### 2. èšé‘«å¹³å°æ¨¡å‹å’Œæ—¶é•¿ä¿®å¤ (2026-01-02) â­ v3.7
- **CRITICAL ä¿®å¤**: èšé‘«å¹³å°æ¨¡å‹åç§° sora-2 â†’ sora-2-all
- **é—®é¢˜**: ç”¨æˆ·åé¦ˆ"ä½ å·²ç»å®³æˆ‘æŸå¤±å¾ˆå¤šé’±äº†" - ä½¿ç”¨é”™è¯¯æ¨¡å‹å¯¼è‡´æ‰£è´¹é”™è¯¯
- **è§£å†³**:
  - åç«¯æ·»åŠ å¹³å°è‡ªåŠ¨åˆ‡æ¢é€»è¾‘: `this.platformType === 'JUXIN' ? 'sora-2-all' : 'sora-2'`
  - å‰ç«¯ç¡¬ç¼–ç èšé‘«æ•…äº‹æ¿èŠ‚ç‚¹ä½¿ç”¨ `sora-2-all`
  - æ·»åŠ è°ƒè¯•æ—¥å¿—éªŒè¯æ¨¡å‹é€‰æ‹©
- **åŠŸèƒ½ä¿®å¤**: æ•…äº‹æ¿é»˜è®¤æ—¶é•¿ 5ç§’ â†’ 15ç§’
- **Bug ä¿®å¤**: æ—¶é•¿è‡ªåŠ¨è°ƒæ•´é€»è¾‘ [4,8,12] â†’ [10,15,25]
- **æ–‡æ¡£æ›´æ–°**: æ·»åŠ åç«¯é‡å¯è¯´æ˜åˆ°è‡ªåŠ¨åŒ–è§„èŒƒ
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/server/sora2-client.js` - Lines 339-346, 369-383
  - `src/client/src/nodes/process/JuxinStoryboardNode.jsx` - Lines 51-53, 167-170
  - `src/client/src/nodes/process/ZhenzhenStoryboardNode.jsx` - Lines 51-53, 167-170
  - `.claude/rules/quick-reference.md` - æ·»åŠ åç«¯é‡å¯è¯´æ˜
- **éªŒè¯ç»“æœ**: ä»»åŠ¡ video_f8137c17 - æ¨¡å‹ sora_video2 âœ…, æ—¶é•¿ 15ç§’ âœ…

#### 2. å‚è€ƒå›¾èŠ‚ç‚¹æ•°æ®ç±»å‹ä¿®å¤ (2026-01-02) â­ v3.6
- **é—®é¢˜**: ç‚¹å‡»è¿æ¥çº¿æ—¶ï¼Œå–æ¶ˆé€‰ä¸­çš„å›¾ç‰‡åˆé‡æ–°å‡ºç°åœ¨ç›®æ ‡èŠ‚ç‚¹
- **åŸå› **:
  - ReferenceImageNode ä¿å­˜ `selectedImages` åˆ° `node.data` æ—¶æ˜¯**æ•°ç»„**
  - App.jsx ä¸­é—´ä»¶é”™è¯¯åœ°ä½¿ç”¨ Set çš„ `.size` å’Œ `.has()` æ–¹æ³•å¤„ç†
  - å¯¼è‡´é€»è¾‘åˆ¤æ–­å¤±è´¥ï¼Œä¼ é€’äº†é”™è¯¯çš„å›¾ç‰‡æ•°æ®
- **è§£å†³**:
  - ä¿®å¤ App.jsx ä½¿ç”¨ `Array.isArray()` æ£€æŸ¥æ•°æ®ç±»å‹
  - ReferenceImageNode æ·»åŠ å·¥ä½œæµæ¢å¤æ”¯æŒ
  - ç›´æ¥ä½¿ç”¨å·²è¿‡æ»¤çš„æ•°ç»„ï¼Œæ— éœ€å†æ¬¡è¿‡æ»¤
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/client/src/nodes/input/ReferenceImageNode.jsx` - å·¥ä½œæµæ¢å¤æ”¯æŒ
  - `src/client/src/App.jsx` - ä¿®å¤æ•°ç»„å¤„ç†é€»è¾‘

#### 2. æ¨¡å‹åç§°ä¿®å¤ (2026-01-02) â­ v3.5
- **é—®é¢˜**: èšé‘«å¹³å°ä½¿ç”¨ `sora-2` æ¨¡å‹å¯¼è‡´ API è°ƒç”¨å¤±è´¥
- **åŸå› **: èšé‘«å¹³å°ä½¿ç”¨ `sora-2-all` æ¨¡å‹åç§°ï¼ˆè€Œé `sora-2`ï¼‰
- **è§£å†³**:
  - åç«¯å®ç°å¹³å°è‡ªåŠ¨åˆ‡æ¢é€»è¾‘
  - å‰ç«¯ UI æ›´æ–°é»˜è®¤æ¨¡å‹å’Œé€‰é¡¹
  - æ·»åŠ  `sora-2-all` æ¨¡å‹æ”¯æŒ
- **ä¿®æ”¹æ–‡ä»¶**:
  - `src/server/sora2-client.js` - æ·»åŠ å¹³å°è‡ªåŠ¨åˆ‡æ¢
  - `src/client/src/nodes/input/APISettingsNode.jsx` - æ›´æ–°é»˜è®¤å€¼
  - `src/client/src/nodes/process/VideoGenerateNode.jsx` - æ›´æ–°é»˜è®¤å€¼
  - `src/client/src/nodes/process/StoryboardNode.jsx` - æ›´æ–°é»˜è®¤å€¼
  - `src/renderer/public/index.html` - æ·»åŠ æ¨¡å‹é€‰é¡¹

#### 2. åŒå¹³å°å…¼å®¹æ€§ä¿®å¤ (2025-12-29)
- **é—®é¢˜**: è´è´å¹³å°è§†é¢‘æœªä¿å­˜åˆ°å†å²è®°å½•
- **åŸå› **: è´è´è¿”å› `{task_id}`, èšé‘«è¿”å› `{id}`
- **è§£å†³**: å…¼å®¹å¤„ç† `result.data.id || result.data.task_id`

#### 2. è§’è‰²å¼•ç”¨è¯­æ³•ä¿®æ­£ (2025-12-29)
- **é—®é¢˜**: ä¹‹å‰ä½¿ç”¨ `@{username}` æ ¼å¼ï¼ˆé”™è¯¯ï¼‰
- **ä¿®æ­£**: æ‰€æœ‰å¹³å°ç»Ÿä¸€ä½¿ç”¨ `@username` æ ¼å¼ï¼ˆä¸å¸¦èŠ±æ‹¬å·ï¼‰
- **ç¤ºä¾‹**: `@6f2dbf2b3.zenwhisper åœ¨å·¥åœ°ä¸Šå¹²æ´»`

#### 3. åå°è½®è¯¢æœåŠ¡ (2025-12-29)
- **åŠŸèƒ½**: æ¯30ç§’è‡ªåŠ¨æ£€æŸ¥å¾…å¤„ç†ä»»åŠ¡çŠ¶æ€
- **èŒƒå›´**: æ‰€æœ‰ `queued` å’Œ `processing` çŠ¶æ€çš„ä»»åŠ¡
- **æ›´æ–°**: è‡ªåŠ¨æ›´æ–°å†å²è®°å½•çŠ¶æ€

#### 4. æ‰‹åŠ¨æŸ¥è¯¢åŠŸèƒ½ (2025-12-29)
- **åŠŸèƒ½**: ä¸ºæ¯ä¸ªä»»åŠ¡æ·»åŠ "æŸ¥è¯¢çŠ¶æ€"æŒ‰é’®
- **ç”¨é€”**: ç”¨æˆ·å¯ä¸»åŠ¨æŸ¥è¯¢è€Œæ— éœ€ç­‰å¾…è½®è¯¢

#### 5. è§’è‰²åº“å¢å¼º (2025-12-29)
- **åˆ«ååŠŸèƒ½**: ä¸ºè§’è‰²è®¾ç½®æ˜“äºè®°å¿†çš„åˆ«å
- **å¿«é€Ÿè°ƒç”¨**: åœ¨è§†é¢‘åˆ›å»ºè¡¨å•ä¸­æ·»åŠ è§’è‰²é€‰æ‹©å™¨
- **å¤åˆ¶ID**: ä¿®å¤å¤åˆ¶IDæŒ‰é’®åŠŸèƒ½

#### 6. å¯è§†åŒ–è§’è‰²é€‰æ‹©å™¨ (2025-12-29)
- **ç½‘æ ¼å¸ƒå±€**: ä»ä¸‹æ‹‰æ¡†æ”¹ä¸ºå¯è§†åŒ–è§’è‰²å¡ç‰‡ç½‘æ ¼
- **å¤´åƒæ˜¾ç¤º**: æ˜¾ç¤ºè§’è‰²å¤´åƒã€åˆ«åå’Œç”¨æˆ·å
- **é€‰ä¸­çŠ¶æ€**: æ”¯æŒç‚¹å‡»é€‰æ‹©/å–æ¶ˆé€‰ä¸­ï¼Œæœ‰è§†è§‰åé¦ˆ
- **å¹³å°é€šç”¨**: ä¸æ˜¾ç¤ºå¹³å°æ ‡ç­¾ï¼ˆsora2 è§’è‰²è·¨å¹³å°é€šç”¨ï¼‰

#### 7. å…‰æ ‡ä½ç½®æ’å…¥ (2025-12-29)
- **æ–‡ç”Ÿè§†é¢‘**: ç‚¹å‡»è§’è‰²æ—¶åœ¨å…‰æ ‡ä½ç½®æ’å…¥ `@username` å¼•ç”¨
- **æ•…äº‹æ¿**: è®°å½•æœ€åç„¦ç‚¹çš„åœºæ™¯è¾“å…¥æ¡†ï¼Œåªåœ¨å…¶ä¸­æ’å…¥
- **ä¸æ›¿æ¢å†…å®¹**: ä¸å½±å“ç”¨æˆ·å·²è¾“å…¥çš„å…¶ä»–å†…å®¹

#### 8. å¤‡ä»½ç®¡ç†åŠŸèƒ½ (2025-12-29) â­ æ–°å¢
- **å‰ç«¯ç•Œé¢**: æ–°å¢"å¤‡ä»½ç®¡ç†"æ ‡ç­¾é¡µ
- **å¯¼å‡ºå¤‡ä»½**: å°†æ‰€æœ‰å†å²è®°å½•å’Œè§’è‰²åº“å¯¼å‡ºä¸º JSON æ–‡ä»¶
- **å¯¼å…¥å¤‡ä»½**: ä»å¤‡ä»½æ–‡ä»¶æ¢å¤æ•°æ®ï¼Œè·³è¿‡å·²å­˜åœ¨çš„è®°å½•
- **æ•°æ®ç»Ÿè®¡**: å®æ—¶æ˜¾ç¤ºå†å²è®°å½•å’Œè§’è‰²æ•°é‡ç»Ÿè®¡
- **åŒæ ¼å¼æ”¯æŒ**: å¯¼å…¥åŠŸèƒ½æ”¯æŒ API åŒ…è£…æ ¼å¼å’Œçº¯å¤‡ä»½æ ¼å¼
- **ç‰ˆæœ¬æ§åˆ¶**: å¤‡ä»½æ–‡ä»¶åŒ…å«ç‰ˆæœ¬å·å’Œæ—¶é—´æˆ³

#### 9. å‚è€ƒå›¾ç‰‡åŠŸèƒ½ (2025-12-29) â­ æ–°å¢
- **æ–‡ç”Ÿ/å›¾ç”Ÿè§†é¢‘è‡ªåŠ¨æ£€æµ‹**: æ ¹æ®æ˜¯å¦æä¾›å‚è€ƒå›¾ç‰‡è‡ªåŠ¨é€‰æ‹©æ¨¡å¼
- **ç®€å•æ¨¡å¼**: æ”¯æŒåŠ¨æ€æ·»åŠ /åˆ é™¤å¤šå¼ å‚è€ƒå›¾ç‰‡
- **æ•…äº‹æ¿æ¨¡å¼**: æ¯ä¸ªåˆ†é•œå¤´å¯ç‹¬ç«‹é…ç½®å‚è€ƒå›¾ç‰‡
- **åç«¯æ”¶é›†**: è‡ªåŠ¨æ”¶é›†æ‰€æœ‰é•œå¤´çš„å›¾ç‰‡å¹¶åˆå¹¶åˆ° images æ•°ç»„
- **è§’è‰²æ··åˆ**: æ”¯æŒè§’è‰²å®¢ä¸²ä¸å‚è€ƒå›¾ç‰‡æ­é…ä½¿ç”¨
- **æç¤ºè¯ä¼˜åŒ–**: å…ˆåˆ†æå›¾ç‰‡å†…å®¹ï¼Œå†å†™ç›¸å…³æ€§å¼ºçš„æç¤ºè¯

#### 10. å†å²è®°å½•ç®¡ç†åŠŸèƒ½ (2025-12-29) â­ æ–°å¢
- **å•æ¡åˆ é™¤**: æ¯æ¡å†å²è®°å½•éƒ½æœ‰åˆ é™¤æŒ‰é’®ï¼Œæ”¯æŒæŒ‰ä»»åŠ¡IDåˆ é™¤
- **æ¸…ç©ºå…¨éƒ¨**: ä¸€é”®æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•ï¼Œæœ‰åŒé‡ç¡®è®¤æœºåˆ¶
- **å®‰å…¨ä¿æŠ¤**: æ‰€æœ‰åˆ é™¤æ“ä½œéƒ½éœ€è¦ç”¨æˆ·ç¡®è®¤ï¼Œé˜²æ­¢è¯¯æ“ä½œ
- **è‡ªåŠ¨åˆ·æ–°**: åˆ é™¤æˆåŠŸåè‡ªåŠ¨åˆ·æ–°å†å²è®°å½•åˆ—è¡¨
- **é”™è¯¯å¤„ç†**: å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ

#### 11. è§’è‰²æœç´¢ã€ç­›é€‰å’Œæ”¶è—åŠŸèƒ½ (2025-12-29) â­ æ–°å¢
- **å®æ—¶æœç´¢**: æŒ‰è§’è‰²ç”¨æˆ·åæˆ–åˆ«åæœç´¢ï¼Œ300ms é˜²æŠ–å»¶è¿Ÿ
- **ç­›é€‰ç±»å‹**: å…¨éƒ¨è§’è‰² / æˆ‘çš„æ”¶è— / æœ€è¿‘ä½¿ç”¨
- **æ”¶è—åŠŸèƒ½**: ç‚¹å‡»æ˜Ÿæ ‡å›¾æ ‡æ”¶è—/å–æ¶ˆæ”¶è—è§’è‰²
- **æœ€è¿‘ä½¿ç”¨**: è‡ªåŠ¨è®°å½•æœ€è¿‘ä½¿ç”¨çš„ 20 ä¸ªè§’è‰²ï¼ˆlocalStorageï¼‰
- **åç«¯ API**: æ–°å¢ `PUT /api/character/:username/favorite` æ”¶è—ç«¯ç‚¹
- **å­˜å‚¨å¢å¼º**: æ–°å¢ `updateByUsername` æ–¹æ³•æ”¯æŒæŒ‰ç”¨æˆ·åæ›´æ–°

#### 26. å¤šè§’è‰²å¼•ç”¨å®ç° (2025-12-30) â­ æ–°å¢
- **åŠŸèƒ½**: å·¥ä½œæµç¼–è¾‘å™¨ä¸­çš„å¤šè§’è‰²é€‰æ‹©å’Œæ‰‹åŠ¨æ’å…¥
- **CharacterLibraryNode**: å¤šé€‰åˆç­›æ¨¡å¼ï¼ˆ`transfer` / `manage`ï¼‰
- **VideoGenerateNode**: å€™é€‰è§’è‰²æ˜¾ç¤ºï¼Œç‚¹å‡»æ’å…¥åˆ°å…‰æ ‡ä½ç½®
- **æ•°æ®æµ**: `selectedCharacters` Set â†’ `connectedCharacters` æ•°ç»„ â†’ ç‚¹å‡»æ’å…¥ `@username`
- **æµ‹è¯•ç»“æœ**: âœ… é€‰æ‹©ã€ä¼ é€’ã€æ˜¾ç¤ºã€æ’å…¥å…¨éƒ¨éªŒè¯é€šè¿‡
- **Git æäº¤**: `9235a80 feat: implement multi-character reference workflow`

#### 27. è§’è‰²å¼•ç”¨åŒæ˜¾ç¤ºåŠŸèƒ½ (2025-12-30) â­ æ–°å¢
- **é—®é¢˜**: ç”¨æˆ·è¾“å…¥çš„åˆ«åï¼ˆå¦‚ @é˜³å…‰å°çŒ«ï¼‰éœ€è¦è½¬æ¢ä¸ºçœŸå®IDï¼ˆå¦‚ @5562be00d.sunbeamkitï¼‰æ‰èƒ½è¢«APIè¯†åˆ«
- **è§£å†³æ–¹æ¡ˆ**: å®ç°åŒå‘è½¬æ¢ç³»ç»Ÿ
  - **è¾“å…¥æ¡†æ˜¾ç¤º**: åˆ«åæ ¼å¼ï¼ˆ@é˜³å…‰å°çŒ«ï¼‰- ä¾¿äºç”¨æˆ·è¯†åˆ«
  - **API æ¥æ”¶**: çœŸå®IDæ ¼å¼ï¼ˆ@5562be00d.sunbeamkitï¼‰- ç”¨äºè§’è‰²å¼•ç”¨
- **æŠ€æœ¯å®ç°**:
  - `usernameToAlias` æ˜ å°„: å­˜å‚¨ç”¨æˆ·ååˆ°åˆ«åçš„å¯¹åº”å…³ç³»
  - `realToDisplay()`: å°†çœŸå®IDè½¬æ¢ä¸ºåˆ«åç”¨äºæ˜¾ç¤º
  - `displayToReal()`: å°†åˆ«åè½¬æ¢å›çœŸå®IDç”¨äºAPI
  - **å…³é”®ä¿®å¤**: æ­£åˆ™è¡¨è¾¾å¼ä» `\b` æ”¹ä¸º `(?=\s|$|@)` ä»¥æ”¯æŒä¸­æ–‡
- **æµ‹è¯•ç»“æœ**:
  - âœ… @æµ‹è¯•å°çŒ« â†’ @ebfb9a758.sunnykitte
  - âœ… @è£…è½½æœº â†’ @783316a1d.diggyloade
  - âœ… å¤šè§’è‰²: @æµ‹è¯•å°çŒ« å’Œ@è£…è½½æœº â†’ @ebfb9a758.sunnykitte å’Œ@783316a1d.diggyloade
  - âœ… è§†é¢‘ç”ŸæˆæˆåŠŸ: video_399a3462-9eff-4d2a-a11d-910dcc7838e6
- **Git æäº¤**: `76c7b56 feat: implement dual-display for character references (alias display, real ID for API)`

#### 28. è§’è‰²ç¼–è¾‘åŠŸèƒ½ä¼˜åŒ– (2025-12-30) â­ æ–°å¢
- **é—®é¢˜**: "æ‰¹é‡åˆ é™¤"æŒ‰é’®æ–‡å­—æœ‰æ­§ä¹‰ï¼ŒåŠŸèƒ½ä¸é™äºåˆ é™¤
- **è§£å†³**: å°†æŒ‰é’®æ–‡å­—æ”¹ä¸º"âœï¸ è§’è‰²ç¼–è¾‘"
- **åŠŸèƒ½æè¿°**:
  - ç¼–è¾‘è§’è‰²åˆ«å
  - åˆ é™¤è§’è‰²ï¼ˆå•ä¸ªæˆ–æ‰¹é‡ï¼‰
  - æ›´å‡†ç¡®åœ°åæ˜ è¯¥æ¨¡å¼çš„å®é™…åŠŸèƒ½
- **Git æäº¤**: `913edba refactor: rename "æ‰¹é‡åˆ é™¤" to "è§’è‰²ç¼–è¾‘" for clarity`

#### 29. ComfyUI é£æ ¼èŠ‚ç‚¹å¢å¼ºåŠŸèƒ½ (2025-12-30) â­ æ–°å¢
- **åŠŸèƒ½ç‚¹1: èŠ‚ç‚¹å¤§å°å¯è°ƒæ•´**
  - èŠ‚ç‚¹å³ä¸‹è§’æ˜¾ç¤ºä¸‰è§’å½¢ç¼©æ”¾æ‰‹æŸ„ï¼ˆComfyUI é£æ ¼ï¼‰
  - æ‹–åŠ¨å³ä¸‹è§’è°ƒæ•´èŠ‚ç‚¹å®½åº¦å’Œé«˜åº¦
  - é™åˆ¶æœ€å°å°ºå¯¸ï¼ˆ260px x 400pxï¼‰
  - è°ƒæ•´å¤§å°æ—¶ç¦ç”¨æ–‡æœ¬é€‰æ‹©ï¼ˆuserSelect: noneï¼‰
- **åŠŸèƒ½ç‚¹2: æ–‡æœ¬é€‰æ‹©ä¸è§¦å‘èŠ‚ç‚¹æ‹–åŠ¨**
  - ä½¿ç”¨ `className="nodrag"` æ ‡è®°æ‰€æœ‰äº¤äº’å…ƒç´ 
  - åº”ç”¨äº: textarea, select, input, button, ç¼©æ”¾æ‰‹æŸ„
  - React Flow å®˜æ–¹æ¨èæ–¹æ¡ˆï¼ˆè€Œé stopPropagationï¼‰
- **åŠŸèƒ½ç‚¹3: æ— é™å¾ªç¯ä¿®å¤**
  - ä½¿ç”¨ `useRef` å­˜å‚¨å›è°ƒå‡½æ•°å¼•ç”¨
  - ä½¿ç”¨ `useCallback` åœ¨çˆ¶ç»„ä»¶åˆ›å»ºç¨³å®šå›è°ƒ
  - ç§»é™¤ `data` ä» useEffect ä¾èµ–æ•°ç»„
  - ä¿®å¤é¡µé¢å´©æºƒé—®é¢˜ï¼ˆMaximum update depth exceededï¼‰
- **æŠ€æœ¯å®ç°**:
  - `VideoGenerateNode.jsx`: èŠ‚ç‚¹å¤§å°å¯è°ƒæ•´ã€nodrag ç±»
  - `App.jsx`: useCallback åˆ›å»ºç¨³å®šå›è°ƒå‡½æ•°
- **æµ‹è¯•ç»“æœ**:
  - âœ… æ‹–åŠ¨å³ä¸‹è§’æˆåŠŸè°ƒæ•´èŠ‚ç‚¹å¤§å°
  - âœ… textarea ä¸­é€‰æ‹©æ–‡æœ¬ä¸æ‹–åŠ¨èŠ‚ç‚¹
  - âœ… æ‰€æœ‰äº¤äº’å…ƒç´ ï¼ˆselectã€buttonã€inputï¼‰æ­£å¸¸å·¥ä½œ
  - âœ… æ— æ— é™å¾ªç¯ï¼Œé¡µé¢ç¨³å®šè¿è¡Œ
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/process/VideoGenerateNode.jsx`
  - `src/client/src/App.jsx`

#### 29. æ•°æ®æ¶æ„æ·±åº¦ä¿®å¤ (2026-01-01) â­ é‡å¤§ä¿®å¤
- **é—®é¢˜1**: ç‚¹å‡»è§’è‰²å¯¼è‡´"é¡µé¢é‡æ–°åŠ è½½"ï¼Œè€Œä¸æ˜¯å³æ—¶æ›´æ–°
  - **æ ¹æœ¬åŸå› **:
    - CharacterLibraryNode å’Œ ReferenceImageNode æœ‰åŒé‡ useEffect
    - localStorage é¢‘ç¹ä¿å­˜ï¼ˆæ¯æ¬¡ç‚¹å‡»éƒ½ä¿å­˜ï¼‰
    - App.jsx åªç›‘å¬ edgesï¼Œä¸ç›‘å¬ nodes
  - **è§£å†³æ–¹æ¡ˆ**:
    - åˆå¹¶åŒé‡ useEffect ä¸ºå•ä¸ª useEffect
    - é˜²æŠ– localStorage ä¿å­˜ï¼ˆ500msï¼‰
    - æºèŠ‚ç‚¹ç›´æ¥æ›´æ–°ç›®æ ‡èŠ‚ç‚¹ï¼ˆç»•è¿‡ App.jsxï¼‰
  - **æ•ˆæœ**: å‡å°‘ 50% æ¸²æŸ“æ¬¡æ•°ï¼Œå‡å°‘ 90% localStorage å†™å…¥

- **é—®é¢˜2**: App.jsx æ•°æ®ä¼ é€’é™·é˜±
  - **æ ¹æœ¬åŸå› **: useEffect åªç›‘å¬ edges å˜åŒ–ï¼ŒèŠ‚ç‚¹å†…éƒ¨çŠ¶æ€å˜åŒ–ä¸ä¼ é€’åˆ°ç›®æ ‡èŠ‚ç‚¹
  - **è§£å†³æ–¹æ¡ˆ**: æºèŠ‚ç‚¹ä½¿ç”¨ getEdges() æ‰¾åˆ°è¿æ¥çš„èŠ‚ç‚¹ï¼Œä¸€æ¬¡ setNodes() ç›´æ¥æ›´æ–°ç›®æ ‡èŠ‚ç‚¹
  - **å…³é”®ä»£ç **:
    ```javascript
    // CharacterLibraryNode.jsx - æºèŠ‚ç‚¹ç›´æ¥æ›´æ–°
    useEffect(() => {
      const outgoingEdges = edges.filter(e => e.source === nodeId);
      setNodes((nds) =>
        nds.map((node) => {
          // æ›´æ–°è‡ªå·±
          if (node.id === nodeId) return { ...node, data: { ...node.data, selectedCharacters } };
          // â­ ç›´æ¥æ›´æ–°ç›®æ ‡èŠ‚ç‚¹
          const isConnected = outgoingEdges.some(e => e.target === node.id);
          if (isConnected) return { ...node, data: { ...node.data, connectedCharacters } };
          return node;
        })
      );
    }, [selectedCharacters, getEdges, setNodes]);
    ```

- **é—®é¢˜3**: åŠ è½½å†å²è®°å½•æ˜¾ç¤ºé”™è¯¯è§†é¢‘
  - **æ ¹æœ¬åŸå› **: VideoGenerateNode è°ƒç”¨ getNodes() æ—¶ï¼ŒTaskResultNode çš„ useEffect è¿˜æ²¡æ‰§è¡Œ
  - **åœºæ™¯**: è¿ç»­ç”Ÿæˆè§†é¢‘æ—¶ï¼Œç¬¬äºŒæ¬¡ç”Ÿæˆçš„å¿«ç…§åŒ…å«ç¬¬ä¸€æ¬¡çš„è§†é¢‘ç»“æœ
  - **è§£å†³æ–¹æ¡ˆ**:
    - **çŸ­æœŸ**: åŠ è½½å†å²è®°å½•æ—¶ï¼Œä»å†å²è®°å½•çš„å®é™…æ•°æ®è¦†ç›– TaskResultNode
    - **é•¿æœŸ**: TaskResultNode è½®è¯¢æ”¶åˆ°ç»“æœæ—¶ç«‹å³åŒæ­¥ node.data

- **æŠ€æœ¯æ€»ç»“**:
  - **React Flow æ•°æ®æµ**: getNodes() æ˜¯åŒæ­¥çš„ï¼ŒuseState æ˜¯å¼‚æ­¥çš„ï¼ŒuseEffect åœ¨æ¸²æŸ“åæ‰§è¡Œ
  - **å…³é”®æ—¶åˆ»æ‰‹åŠ¨åŒæ­¥**: åœ¨ getNodes() æ•è·å¿«ç…§å‰ï¼Œæ‰‹åŠ¨è°ƒç”¨ setNodes() ç¡®ä¿æ•°æ®åŒæ­¥
  - **é˜²æŠ–é‡è¦æ€§**: 500ms é˜²æŠ–æ˜¾è‘—æå‡å“åº”é€Ÿåº¦

- **æµ‹è¯•éªŒè¯**:
  - âœ… è§’è‰²é€‰æ‹©å³æ—¶æ›´æ–°ï¼ˆæ— å¡é¡¿ï¼‰
  - âœ… å›¾ç‰‡é€‰æ‹©å³æ—¶æ›´æ–°ï¼ˆæ— å¡é¡¿ï¼‰
  - âœ… æç¤ºè¯è‡ªåŠ¨ç»„è£…ï¼ˆå¤šè§’è‰²å¼•ç”¨ï¼‰
  - âœ… localStorage é˜²æŠ–ä¿å­˜ï¼ˆconsole.log éªŒè¯ï¼‰

- **æ–‡æ¡£æ›´æ–°**:
  - SKILL.md: æ›´æ–°é”™è¯¯16ã€æ–°å¢é”™è¯¯34ã€æ–°å¢å¼€å‘æç¤º 15-18
  - code.md: æ›´æ–°é”™è¯¯16ã€æ–°å¢é”™è¯¯34ã€æ·»åŠ æºèŠ‚ç‚¹ç›´æ¥æ›´æ–°ç¤ºä¾‹
  - base.md: æ–°å¢"èŠ‚ç‚¹é—´æ•°æ®ä¼ é€’æ¶æ„"
  - ç‰ˆæœ¬å·: v3.3 â†’ v3.4

- **å½±å“æ–‡ä»¶**:
  - `src/client/src/App.jsx` (é˜²æŠ– localStorage)
  - `src/client/src/nodes/input/CharacterLibraryNode.jsx` (åˆå¹¶ useEffect)
  - `src/client/src/nodes/input/ReferenceImageNode.jsx` (åˆå¹¶ useEffect)
  - `src/client/src/nodes/process/VideoGenerateNode.jsx` (åˆå¹¶ useEffect)
  - `src/client/src/nodes/output/TaskResultNode.jsx` (å·¥ä½œæµå¿«ç…§æ—¶æœº)
  - `.claude/skills/winjin-dev/SKILL.md`
  - `.claude/rules/code.md`
  - `.claude/rules/base.md`

---

### âš ï¸ é‡å¤§æŠ€æœ¯çº é”™ï¼šæ•…äº‹æ¿åŠŸèƒ½ç†è§£é”™è¯¯ (2025-12-30) â­ é‡å¤§çº æ­£

**é—®é¢˜å‘ç°**: åœ¨å¯¹æ•…äº‹æ¿åŠŸèƒ½è¿›è¡Œæ·±å…¥åˆ†ææ—¶ï¼Œå‘ç°äº†ä¸€ä¸ªæ ¹æœ¬æ€§çš„ç†è§£é”™è¯¯

**é”™è¯¯ç†è§£**ï¼ˆä¹‹å‰çš„å®ç°ï¼‰:
- âŒ æ•…äº‹æ¿ = æ‰¹é‡ç”Ÿæˆå¤šä¸ªç‹¬ç«‹è§†é¢‘
- âŒ æ¯ä¸ªé•œå¤´è°ƒç”¨ä¸€æ¬¡ API
- âŒ è¿”å› N ä¸ª taskId æ•°ç»„
- âŒ æ˜¾ç¤º "æ‰¹é‡ç”Ÿæˆ" æŒ‰é’®
- âŒ è¿›åº¦è·Ÿè¸ª: total/completed/failed

**æ­£ç¡®ç†è§£**ï¼ˆAPI æ–‡æ¡£è¯´æ˜ï¼‰:
- âœ… æ•…äº‹æ¿ = **å•ä¸ªè§†é¢‘ä»»åŠ¡**ï¼Œé€šè¿‡ç‰¹æ®Šæ ¼å¼æè¿°å¤šä¸ªæ—¶é—´æ®µ
- âœ… è°ƒç”¨ **ä¸€æ¬¡ API**ï¼Œè¿”å› **å•ä¸ª taskId**
- âœ… API é€šè¿‡ç‰¹æ®Šæç¤ºè¯æ ¼å¼è¯†åˆ«æ•…äº‹æ¿æ¨¡å¼

**æ•…äº‹æ¿æ ¼å¼**ï¼ˆè´è´å¹³å°æ–‡æ¡£ï¼‰:
```
Shot 1:
duration: 7.5sec
Scene: é£æœºèµ·é£

Shot 2:
duration: 7.5sec
Scene: é£æœºé™è½
```

**åç«¯å®ç°**ï¼ˆsrc/server/sora2-client.js ç¬¬318-370è¡Œï¼‰:
- âœ… å·²æ­£ç¡®å®ç°ï¼šæ‹¼æ¥æ•…äº‹æ¿æ ¼å¼æç¤ºè¯
- âœ… å·²æ­£ç¡®å®ç°ï¼šæ”¶é›†æ‰€æœ‰é•œå¤´çš„å›¾ç‰‡
- âœ… å·²æ­£ç¡®å®ç°ï¼šè°ƒç”¨ä¸€æ¬¡ç»Ÿä¸€çš„è§†é¢‘åˆ›å»º API

**å‰ç«¯é—®é¢˜**ï¼ˆStoryboardNode.jsx ç¬¬55-130è¡Œï¼‰:
- âŒ å¾ªç¯è°ƒç”¨ N æ¬¡ APIï¼ˆæ¯ä¸ª shot ä¸€æ¬¡ï¼‰
- âŒ ä½¿ç”¨ä¸å­˜åœ¨çš„å‚æ•°: `storyboard_mode`, `shot_index`
- âŒ æœªæ‹¼æ¥æ•…äº‹æ¿æ ¼å¼çš„æç¤ºè¯
- âŒ è¿”å› results æ•°ç»„è€Œéå•ä¸ª taskId

**å½±å“èŒƒå›´**:
1. StoryboardNode.jsxï¼ˆå·¥ä½œæµç¼–è¾‘å™¨èŠ‚ç‚¹ï¼‰- å®ç°é”™è¯¯
2. index.htmlï¼ˆç½‘é¡µç‰ˆæ•…äº‹æ¿åŠŸèƒ½ï¼‰- å¯èƒ½ä¹Ÿæœ‰é—®é¢˜
3. æ‰€æœ‰è°ƒç”¨æ•…äº‹æ¿ API çš„å‰ç«¯ä»£ç  - éœ€è¦å®¡æŸ¥

**ä¿®å¤è®¡åˆ’**:
- **Phase 1**: è§’è‰²å¼•ç”¨é›†æˆï¼ˆä»¿ VideoGenerateNodeï¼‰
- **Phase 2**: ä¿®æ­£ API è°ƒç”¨é€»è¾‘ï¼ˆç§»é™¤å¾ªç¯ï¼Œè°ƒç”¨ä¸€æ¬¡ï¼‰
- **Phase 3**: UI ä¼˜åŒ–ï¼ˆç§»é™¤"æ‰¹é‡ç”Ÿæˆ"æŒ‰é’®ï¼Œç®€åŒ–çŠ¶æ€ï¼‰
- **Phase 4**: æµ‹è¯•éªŒè¯ï¼ˆç¡®è®¤å•ä¸ª taskId è½®è¯¢æ­£å¸¸ï¼‰

**ç›¸å…³æ–‡æ¡£æ›´æ–°**:
- base.md: æ›´æ–°æ•…äº‹æ¿æ¨¡å¼è§„èŒƒï¼ˆç¬¬161-168è¡Œï¼‰
- code.md: æ·»åŠ é”™è¯¯27 - æ•…äº‹æ¿å®ç°é”™è¯¯ï¼ˆç¬¬2736-2853è¡Œï¼‰
- å¼€å‘äº¤æ¥ä¹¦.md: æ·»åŠ æ­¤çº é”™è®°å½•

**å‚è€ƒæ–‡æ¡£**:
- `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/è´è´å·¥åŠ/Sora2æ•…äº‹æ¿è§†é¢‘.md` - API æ ¼å¼è¯´æ˜
- `src/server/sora2-client.js` - åç«¯æ­£ç¡®å®ç°

**ä¿®å¤çŠ¶æ€**: âœ… å·²å®Œæˆ (2025-12-30)

**ä¿®å¤å†…å®¹**:
- âœ… Phase 1: è§’è‰²å¼•ç”¨é›†æˆï¼ˆä»¿ VideoGenerateNodeï¼‰
  - ç„¦ç‚¹ç®¡ç†: `sceneRefs`, `lastFocusedSceneIndex`
  - æ’å…¥åŠŸèƒ½: `insertCharacterToFocusedScene(username, alias)`
  - å€™é€‰è§’è‰²æ˜¾ç¤ºåŒº
- âœ… Phase 2: ä¿®æ­£ API è°ƒç”¨é€»è¾‘
  - ç§»é™¤å¾ªç¯è°ƒç”¨ï¼Œæ”¹ä¸ºå•æ¬¡è°ƒç”¨ `/api/video/storyboard`
  - æ”¶é›†æ‰€æœ‰å›¾ç‰‡ï¼ˆå…¨å±€ + é•œå¤´ï¼‰
  - è¿”å›å•ä¸ª taskIdï¼Œæ´¾å‘äº‹ä»¶åˆ° TaskResultNode
- âœ… Phase 3: UI ä¼˜åŒ–
  - ç§»é™¤ `progress` çŠ¶æ€
  - æŒ‰é’®æ–‡æœ¬: "æ‰¹é‡ç”Ÿæˆ" â†’ "ç”Ÿæˆæ•…äº‹æ¿è§†é¢‘"
  - ç§»é™¤ 1:1 æ¯”ä¾‹é€‰é¡¹ï¼ˆSora2 ä¸æ”¯æŒï¼‰
  - duration æ”¹ä¸ºæ•°å­—ç±»å‹ï¼ˆ5, 10, 15, 25ï¼‰
- âœ… Phase 4: æ•°æ®æµéªŒè¯
  - ç¡®è®¤ CharacterLibraryNode â†’ StoryboardNode æ•°æ®ä¼ é€’æ­£ç¡®
  - `connectedCharacters` æ•°ç»„æ­£å¸¸ä¼ é€’

**ä¿®å¤æ–‡ä»¶**:
- `src/client/src/nodes/process/StoryboardNode.jsx` - å®Œå…¨é‡å†™

**ç›¸å…³æ–‡æ¡£æ›´æ–°**:
- âœ… base.md: æ·»åŠ æ•…äº‹æ¿å‰ç«¯å®ç°è§„èŒƒï¼ˆç¬¬170-177è¡Œï¼‰
- âœ… code.md: æ·»åŠ å‰ç«¯è§’è‰²å¼•ç”¨ä»£ç ç¤ºä¾‹ï¼ˆç¬¬2855-2905è¡Œï¼‰
- âœ… Sora2_Character_Best_Practices.md: æ·»åŠ ç¬¬17ç« æ•…äº‹æ¿èŠ‚ç‚¹ä¿®å¤ï¼ˆç¬¬2093-2376è¡Œï¼‰

**Git æäº¤**: å¾…æäº¤

---

#### 30. æ•…äº‹æ¿èŠ‚ç‚¹ä¿®å¤å®Œæˆ (2025-12-30) â­ é‡å¤§ä¿®å¤
- **åŠŸèƒ½ç‚¹1: è§’è‰²å¼•ç”¨é›†æˆ**
  - ä» CharacterLibraryNode è·å–å€™é€‰è§’è‰²åˆ—è¡¨
  - ç‚¹å‡»è§’è‰²å¡ç‰‡æ’å…¥åˆ°ç„¦ç‚¹åœºæ™¯çš„å…‰æ ‡ä½ç½®
  - ç„¦ç‚¹ç®¡ç†: è®°å½•æœ€åç„¦ç‚¹çš„åœºæ™¯è¾“å…¥æ¡†ç´¢å¼•
- **åŠŸèƒ½ç‚¹2: API è°ƒç”¨ä¿®æ­£**
  - ç§»é™¤é”™è¯¯çš„å¾ªç¯è°ƒç”¨é€»è¾‘ï¼ˆæ¯ä¸ª shot è°ƒç”¨ä¸€æ¬¡ï¼‰
  - æ”¹ä¸ºè°ƒç”¨ä¸€æ¬¡ `/api/video/storyboard` API
  - è¿”å›å•ä¸ª taskIdï¼ˆè€Œé N ä¸ª taskId æ•°ç»„ï¼‰
- **åŠŸèƒ½ç‚¹3: UI ä¼˜åŒ–**
  - ç§»é™¤ "æ‰¹é‡ç”Ÿæˆ" æŒ‰é’®æ–‡æœ¬ â†’ "ç”Ÿæˆæ•…äº‹æ¿è§†é¢‘"
  - ç§»é™¤ progress çŠ¶æ€ï¼ˆtotal/completed/failedï¼‰
  - ç§»é™¤ 1:1 æ¯”ä¾‹é€‰é¡¹ï¼ˆSora2 ä¸æ”¯æŒï¼‰
  - duration æ”¹ä¸ºæ•°å­—ç±»å‹ï¼ˆ5, 10, 15, 25ï¼‰
- **å…³é”®å‘ç°**:
  - æ•…äº‹æ¿æœ¬è´¨: å•ä¸ªè§†é¢‘ä»»åŠ¡ï¼ˆä¸æ˜¯å¤šä¸ªè§†é¢‘ï¼‰
  - æç¤ºè¯æ ¼å¼: `Shot N:\nduration: Xsec\nScene: Y\n\n`
  - åç«¯å·²æ­£ç¡®å®ç°ï¼ˆsora2-client.js ç¬¬318-370è¡Œï¼‰

### å·²çŸ¥é—®é¢˜

**âš ï¸ é‡è¦é€šçŸ¥**: å†å²è®°å½•åŠŸèƒ½å·²äº 2026-01-01 ç§»é™¤

**ç§»é™¤åŸå› **:
- ç”¨æˆ·å‡ ä¹ä¸ä½¿ç”¨å†å²è®°å½•åŠŸèƒ½
- å·¥ä½œæµå¿«ç…§æœºåˆ¶å¯¼è‡´å¤§é‡æ•°æ®åŒæ­¥é—®é¢˜ï¼ˆé”™è¯¯33/34/35ï¼‰
- ä»£ç å¤æ‚åº¦è¿‡é«˜ï¼ˆçº¦ 2,308 è¡Œç›¸å…³ä»£ç ï¼‰

**ç®€åŒ–åçš„åŠŸèƒ½**:
- âŒ ç§»é™¤äº†å¤æ‚çš„å†å²è®°å½•åŠŸèƒ½ï¼ˆå·¥ä½œæµå¿«ç…§åŠ è½½ï¼‰
- âœ… ä¿ç•™äº†è§’è‰²åº“åŠŸèƒ½ï¼ˆCharacterLibraryNodeï¼‰
- âœ… ä¿ç•™äº†å·¥ä½œæµæ‰‹åŠ¨ä¿å­˜åŠŸèƒ½ï¼ˆWorkflowStorageï¼‰
- ğŸ¯ ç›®æ ‡ï¼šé™ä½ä»£ç å¤æ‚åº¦ï¼Œå‡å°‘ç»´æŠ¤æˆæœ¬

---

#### 31. å‚è€ƒå›¾ç‰‡èŠ‚ç‚¹åä½œåŠŸèƒ½ (2025-12-30) â­ æ–°å¢
- **åŠŸèƒ½ç‚¹1: ReferenceImageNode åŒæ¨¡å¼è®¾è®¡**
  - **é€‰æ‹©æ¨¡å¼**: å¤šé€‰å›¾ç‰‡ï¼Œç»¿è‰²è¾¹æ¡† + âœ“ æ ‡è¯†
  - **é¢„è§ˆæ¨¡å¼**: ç‚¹å‡»å›¾ç‰‡å¡ç‰‡æŸ¥çœ‹å¤§å›¾ï¼ˆæ¨¡æ€æ¡†ï¼‰
  - **æ¨¡å¼åˆ‡æ¢**: "é€‰æ‹©æ¨¡å¼" / "é¢„è§ˆæ¨¡å¼" æŒ‰é’®
- **åŠŸèƒ½ç‚¹2: æ•°æ®ä¼ é€’æœºåˆ¶**
  - `selectedImages` Set â†’ `connectedImages` æ•°ç»„
  - é€šè¿‡ `useReactFlow.setNodes()` ä¸»åŠ¨ä¼ é€’æ•°æ®
  - è‡ªåŠ¨æ›´æ–°è¿æ¥èŠ‚ç‚¹æ•°æ®
- **åŠŸèƒ½ç‚¹3: VideoGenerateNode åä½œ**
  - æ˜¾ç¤ºå·²è¿æ¥çš„å‚è€ƒå›¾é¢„è§ˆï¼ˆç¼©ç•¥å›¾ç½‘æ ¼ï¼‰
  - API è°ƒç”¨æ—¶è‡ªåŠ¨æ·»åŠ åˆ° `images` å‚æ•°
  - çŠ¶æ€æç¤ºï¼š`ğŸ–¼ï¸ å·²è¿æ¥å‚è€ƒå›¾ (N å¼ )`
- **åŠŸèƒ½ç‚¹4: StoryboardNode åä½œ**
  - æ˜¾ç¤ºå…¨å±€å‚è€ƒå›¾æç¤ºï¼š`ğŸ–¼ï¸ N å¼ å…¨å±€å‚è€ƒå›¾`
  - åˆå¹¶å…¨å±€å›¾ç‰‡ + é•œå¤´å›¾ç‰‡åˆ° API
  - åˆå¹¶é¡ºåºï¼šå…¨å±€å›¾ç‰‡åœ¨å‰ï¼Œé•œå¤´å›¾ç‰‡åœ¨å
- **æŠ€æœ¯è®¾è®¡**:
  - å‚è€ƒè§’è‰²åº“åä½œæ¨¡å¼ï¼ˆå¤šé€‰ + è‡ªåŠ¨ä¼ é€’ï¼‰
  - å›¾ç‰‡ä½¿ç”¨æ–¹å¼ä¸åŒï¼šè‡ªåŠ¨åˆå¹¶åˆ° APIï¼ˆè€Œéæ‰‹åŠ¨æ’å…¥ï¼‰
  - æ”¯æŒæ–‡ç”Ÿè§†é¢‘/å›¾ç”Ÿè§†é¢‘è‡ªåŠ¨æ£€æµ‹
- **ç›¸å…³æ–‡æ¡£æ›´æ–°**:
  - âœ… base.md: æ·»åŠ å‚è€ƒå›¾ç‰‡èŠ‚ç‚¹åä½œè§„èŒƒï¼ˆç¬¬186-202è¡Œï¼‰
  - âœ… code.md: æ·»åŠ å‚è€ƒå›¾ç‰‡èŠ‚ç‚¹åä½œå®ç°ç¤ºä¾‹ï¼ˆç¬¬2909-3076è¡Œï¼‰
  - âœ… å¼€å‘äº¤æ¥ä¹¦.md: æœ¬æ¡ç›®

---

#### 32. æ•…äº‹æ¿å…¨å±€å›¾ç‰‡æ§åˆ¶ + è‡ªåŠ¨æ—¶é•¿åŠŸèƒ½ (2025-12-30) â­ æ–°å¢
- **åŠŸèƒ½ç‚¹1: å…¨å±€å‚è€ƒå›¾å¤é€‰æ¡†æ§åˆ¶**
  - æ·»åŠ  `[ ] å¯ç”¨å…¨å±€å‚è€ƒå›¾` å¤é€‰æ¡†
  - é€‰ä¸­æ—¶ï¼šå…¨å±€å›¾ç‰‡åº”ç”¨åˆ°æ‰€æœ‰é•œå¤´
  - æœªé€‰ä¸­æ—¶ï¼šåªä½¿ç”¨é•œå¤´ç‹¬ç«‹é€‰æ‹©çš„å›¾ç‰‡
  - å›¾ç‰‡åˆå¹¶é€»è¾‘ï¼š
    - å¯ç”¨å…¨å±€: `allImages = [...globalImages, ...shotImages]`
    - ç¦ç”¨å…¨å±€: `allImages = [...shotImages]`ï¼ˆåªç”¨é•œå¤´å›¾ç‰‡ï¼‰
- **åŠŸèƒ½ç‚¹2: é•œå¤´å›¾ç‰‡ç‹¬ç«‹é€‰æ‹©**
  - æ¯ä¸ªé•œå¤´æ·»åŠ  ğŸ“· æŒ‰é’®
  - ç‚¹å‡»æ‰“å¼€å›¾ç‰‡é€‰æ‹©å™¨æ¨¡æ€æ¡†
  - æ˜¾ç¤ºå·²è¿æ¥çš„å‚è€ƒå›¾ç½‘æ ¼ä¾›é€‰æ‹©
  - æ”¯æŒ"æ¸…é™¤é€‰æ‹©"åŠŸèƒ½
- **åŠŸèƒ½ç‚¹3: æ€»æ—¶é•¿è‡ªåŠ¨å‡åˆ†**
  - æ·»åŠ  `â±ï¸ æ€»æ—¶é•¿è®¾ç½®` ä¸‹æ‹‰èœå•ï¼ˆ5/10/15/25ç§’ï¼‰
  - è‡ªåŠ¨è®¡ç®—ï¼š`shotDuration = totalDuration / shots.length`
  - æ˜¾ç¤ºæç¤ºï¼š`â±ï¸ è‡ªåŠ¨å‡åˆ† X.X ç§’`
  - è¶…è¿‡ 25 ç§’æ—¶æ˜¾ç¤ºè­¦å‘Šï¼š`âš ï¸ å½“å‰æ€»æ—¶é•¿ XX ç§’è¶…è¿‡ API é™åˆ¶`
- **åç«¯ API æ›´æ–°**:
  - sora2-client.js æ·»åŠ  `duration` å‚æ•°æ”¯æŒ
  - ä¼ é€’æ€»æ—¶é•¿åˆ° APIï¼ˆå¦‚æœ‰æä¾›ï¼‰
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/process/StoryboardNode.jsx`
  - `src/server/sora2-client.js`
- **ç›¸å…³æ–‡æ¡£æ›´æ–°**:
  - âœ… base.md: æ·»åŠ æ•…äº‹æ¿å…¨å±€å›¾ç‰‡æ§åˆ¶å’Œè‡ªåŠ¨æ—¶é•¿è§„èŒƒï¼ˆç¬¬186-207è¡Œï¼‰
  - âœ… code.md: æ·»åŠ å®Œæ•´å®ç°ç¤ºä¾‹ï¼ˆç¬¬3036-3324è¡Œï¼‰
  - âœ… å¼€å‘äº¤æ¥ä¹¦.md: æœ¬æ¡ç›®

---

#### 31. æ•…äº‹æ¿æ—¶é•¿è®¾ç½®æ”¹ä¸ºæ‰‹åŠ¨è¾“å…¥ (2025-12-30) â­ é‡è¦ä¿®å¤
- **é—®é¢˜**: è‡ªåŠ¨å‡åˆ†åŠŸèƒ½ä¸ API å®ç°å†²çªï¼Œä¸”ç”¨æˆ·éœ€è¦æ›´çµæ´»çš„æ§åˆ¶
- **ä¿®å¤**:
  - ç§»é™¤æ€»æ—¶é•¿ä¸‹æ‹‰æ¡†ï¼ˆ5/10/15/25ç§’ï¼‰
  - ç§»é™¤è‡ªåŠ¨å‡åˆ†é€»è¾‘ `shotDuration = totalDuration / shots.length`
  - ä¸ºæ¯ä¸ªé•œå¤´æ·»åŠ ç‹¬ç«‹çš„æ—¶é•¿è¾“å…¥æ¡†ï¼ˆ1-25ç§’ï¼‰
  - å®æ—¶è®¡ç®—æ€»æ—¶é•¿å¹¶æ˜¾ç¤ºï¼š`â±ï¸ æ€»æ—¶é•¿: 15 ç§’`
  - è¶…è¿‡25ç§’æ—¶æ˜¾ç¤ºè­¦å‘Š
- **âš ï¸ API é‡è¦ä¿®å¤**:
  - ç§»é™¤æ•…äº‹æ¿è¯·æ±‚ä¸­çš„å•ç‹¬ `duration` å‚æ•°
  - æ€»æ—¶é•¿ç”±å„é•œå¤´æ—¶é•¿ä¹‹å’Œå†³å®š
  - ä¿®å¤äº†å¯¼è‡´ 400 é”™è¯¯çš„å‚æ•°å†²çªé—®é¢˜
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/process/StoryboardNode.jsx`
  - `src/server/sora2-client.js`
- **ç›¸å…³æ–‡æ¡£æ›´æ–°**:
  - âœ… base.md: æ›´æ–°æ•…äº‹æ¿æ—¶é•¿è§„èŒƒï¼ˆç¬¬204-209è¡Œï¼‰
  - âœ… code.md: æ·»åŠ é”™è¯¯28 - æ•…äº‹æ¿ duration å‚æ•°é—®é¢˜ï¼ˆç¬¬2907-2942è¡Œï¼‰
  - âœ… å¼€å‘äº¤æ¥ä¹¦.md: æœ¬æ¡ç›®

---

#### 33. è¡¨å•å­—æ®µå¯è®¿é—®æ€§ä¿®å¤ (2025-12-31) â­ Bug ä¿®å¤
- **é—®é¢˜**: æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºè­¦å‘Š "A form field element should have an id or name attribute"
- **åŸå› **: è¡¨å•å­—æ®µç¼ºå°‘ `id` å’Œ `name` å±æ€§
- **ä¿®å¤èŒƒå›´**: ä¸ºæ‰€æœ‰è¡¨å•å­—æ®µæ·»åŠ  id å’Œ name å±æ€§
  - **APISettingsNode.jsx**: 5 ä¸ªå­—æ®µï¼ˆplatform, model, aspect, watermark, apiKeyï¼‰
  - **VideoGenerateNode.jsx**: 1 ä¸ªå­—æ®µï¼ˆdurationï¼‰
  - **CharacterLibraryNode.jsx**: 3 ä¸ªå­—æ®µï¼ˆsearchQuery, filterType, editAliasï¼‰
  - **ReferenceImageNode.jsx**: 1 ä¸ªå­—æ®µï¼ˆimageUrlï¼‰
  - **CharacterCreateNode.jsx**: 5 ä¸ªå­—æ®µï¼ˆplatform, videoUrl, taskId, timestamps, aliasï¼‰
  - **StoryboardNode.jsx**: 3+ ä¸ªå­—æ®µï¼ˆuseGlobalImages, scene-input-*, duration-*ï¼‰
- **å‘½åè§„èŒƒ**:
  - `id`: ä½¿ç”¨ kebab-caseï¼Œå¦‚ `video-url-input`, `platform-select`
  - `name`: ä½¿ç”¨ camelCaseï¼Œå¦‚ `videoUrl`, `platform`
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/input/APISettingsNode.jsx`
  - `src/client/src/nodes/process/VideoGenerateNode.jsx`
  - `src/client/src/nodes/input/CharacterLibraryNode.jsx`
  - `src/client/src/nodes/input/ReferenceImageNode.jsx`
  - `src/client/src/nodes/process/CharacterCreateNode.jsx`
  - `src/client/src/nodes/process/StoryboardNode.jsx`
- **ç›¸å…³æ–‡æ¡£æ›´æ–°**:
  - âœ… SKILL.md: æ·»åŠ å¼€å‘æç¤º 13
  - âœ… code.md: æ·»åŠ é”™è¯¯31 - è¡¨å•å­—æ®µç¼ºå°‘ id/name å±æ€§

---

#### 34. å›¾ç”Ÿè§†é¢‘æç¤ºè¯æ¨¡å¼ä¿®æ­£ (2025-12-31) â­ é‡è¦çº æ­£
- **é—®é¢˜**: ä½¿ç”¨å‚è€ƒå›¾ç‰‡ç”Ÿæˆè§†é¢‘æ—¶ï¼Œç”Ÿæˆç»“æœä¸å‚è€ƒå›¾ç‰‡å†…å®¹æ— å…³
- **æ ¹æœ¬åŸå› **: æç¤ºè¯æœªæè¿°å‚è€ƒå›¾ç‰‡çš„åœºæ™¯å†…å®¹
- **é”™è¯¯ç¤ºä¾‹**:
  - âŒ `@è£…è½½æœº åœ¨å¹²æ´»` + ç«å±±åœºæ™¯å›¾ â†’ ç”Ÿæˆçš„è§†é¢‘ä¸ç«å±±æ— å…³
  - âŒ `ç«å±±åœºæ™¯ä¸­ï¼Œä¸€è¾†é»„è‰²è£…è½½æœºåœ¨æ¬è¿å²©çŸ³` â†’ æ²¡æœ‰ä½¿ç”¨è§’è‰²å¼•ç”¨
- **æ­£ç¡®æ¨¡å¼**: å‚è€ƒå›¾ç‰‡ = åœºæ™¯èƒŒæ™¯ï¼Œè§’è‰²å¼•ç”¨ = åœºæ™¯ä¸­çš„æ¼”å‘˜
  - âœ… `å¡é€šé£æ ¼çš„ç«å±±åœºæ™¯ï¼Œç«å±±å£æœ‰ç†”å²©æµåŠ¨ï¼Œåº•éƒ¨å†’ç™½çƒŸï¼Œè“å¤©ç™½äº‘èƒŒæ™¯ã€‚@è£…è½½æœº åœ¨ç«å±±é™„è¿‘ä½œä¸šï¼Œæ­£åœ¨æ¬è¿å²©çŸ³ï¼Œå¡é€šæ’ç”»é£æ ¼` + ç«å±±åœºæ™¯å›¾
- **æç¤ºè¯ç»“æ„å»ºè®®**:
  1. **åœºæ™¯æè¿°**: ä¸»ä½“ã€å¤–è§‚ã€ç¯å¢ƒã€æ°›å›´ï¼ˆæ¥è‡ªå‚è€ƒå›¾ç‰‡ï¼‰
  2. **è§’è‰²å¼•ç”¨**: `@username` æ ¼å¼
  3. **æ´»åŠ¨æè¿°**: è§’è‰²åœ¨åœºæ™¯ä¸­çš„å…·ä½“åŠ¨ä½œ
  4. **é£æ ¼è¯´æ˜**: å¡é€š/å†™å®ç­‰
- **å…³é”®ç‚¹**:
  - å‚è€ƒå›¾ç‰‡æä¾›åœºæ™¯åŸºç¡€ï¼ˆå¦‚ç«å±±ã€è¡—é“ã€æµ·æ»©ï¼‰
  - æç¤ºè¯å¿…é¡»æè¿°å‚è€ƒå›¾ç‰‡çš„å†…å®¹
  - è§’è‰²å¼•ç”¨æè¿°è§’è‰²åœ¨åœºæ™¯ä¸­çš„æ´»åŠ¨
  - ä½¿ç”¨ `@username` æ ¼å¼è°ƒç”¨è§’è‰²ï¼Œä¸è¦ç¡¬ç¼–ç 
- **ç›¸å…³æ–‡æ¡£æ›´æ–°**:
  - âœ… SKILL.md: æ·»åŠ é”™è¯¯23 - å›¾ç”Ÿè§†é¢‘æç¤ºè¯æœªæè¿°å‚è€ƒå›¾å†…å®¹
  - âœ… SKILL.md: æ·»åŠ å¼€å‘æç¤º 12
  - âœ… code.md: æ·»åŠ é”™è¯¯30 - å›¾ç”Ÿè§†é¢‘æç¤ºè¯æœªæè¿°å‚è€ƒå›¾å†…å®¹

---

#### 35. ComfyUI é£æ ¼å†å²è®°å½•ç®¡ç†è§„åˆ’ (2025-12-31) â­ è§„åˆ’
- **åŠŸèƒ½ç‚¹1: å†å²è®°å½•é¢æ¿**
  - å·¦ä¾§ä¾§è¾¹æ ï¼Œ320px å®½åº¦
  - æ˜¾ç¤ºå†å²è®°å½•å¡ç‰‡åˆ—è¡¨
  - æœç´¢å’Œç­›é€‰åŠŸèƒ½
- **åŠŸèƒ½ç‚¹2: å†å²è®°å½•å¡ç‰‡**
  - ç¼©ç•¥å›¾/è§†é¢‘é¢„è§ˆ
  - æç¤ºè¯é¢„è§ˆï¼ˆ2è¡Œæˆªæ–­ï¼‰
  - çŠ¶æ€ã€ç±»å‹ã€å¹³å°æ ‡ç­¾
  - ç›¸å¯¹æ—¶é—´æ˜¾ç¤º
  - æ”¶è—åŠŸèƒ½
- **åŠŸèƒ½ç‚¹3: å·¥ä½œæµæ¢å¤**
  - ç‚¹å‡»å¡ç‰‡æ¢å¤å®Œæ•´å·¥ä½œæµ
  - ä¿å­˜ workflowSnapshot åˆ°å†å²è®°å½•
  - è§†é¢‘ç”Ÿæˆæ—¶è‡ªåŠ¨æ•è·å·¥ä½œæµçŠ¶æ€

#### 36. å†å²è®°å½•å¡ç‰‡è§†é¢‘æ˜¾ç¤ºå’Œå‚æ•°é¢æ¿ä¿®å¤ (2025-12-31) â­ Bug ä¿®å¤
- **é—®é¢˜**: å†å²è®°å½•å¡ç‰‡åªæ˜¾ç¤ºå ä½ç¬¦ï¼Œä¸æ˜¾ç¤ºè§†é¢‘å’Œå·¥ä½œæµå‚æ•°
- **è§£å†³**:
  - **è§†é¢‘æ˜¾ç¤º**: ä¼˜å…ˆçº§æ£€æŸ¥ thumbnail â†’ result.output â†’ å ä½ç¬¦
  - **æ‚¬åœæ’­æ”¾**: é¼ æ ‡æ‚¬åœæ—¶æ’­æ”¾è§†é¢‘ï¼Œç§»å¼€æ—¶æš‚åœå¹¶é‡ç½®
  - **å‚æ•°é¢æ¿**: æ˜¾ç¤ºæ¨¡å‹ã€æ—¶é•¿ã€æ¯”ä¾‹ã€æ°´å°ç­‰å‚æ•°
  - **è§†é¢‘é“¾æ¥**: å¯ç‚¹å‡»çš„è§†é¢‘ URLï¼ˆä¸è§¦å‘å¡ç‰‡ç‚¹å‡»ï¼‰
- **æŠ€æœ¯å®ç°**:
  ```javascript
  // âœ… æ˜¾ç¤ºè§†é¢‘æˆ–ç¼©ç•¥å›¾
  {thumbnail ? (
    <img src={thumbnail} alt="è§†é¢‘ç¼©ç•¥å›¾" />
  ) : result?.output ? (
    <video
      src={result.output}
      muted
      onMouseEnter={(e) => e.currentTarget.play().catch(() => {})}
      onMouseLeave={(e) => {
        e.currentTarget.pause();
        e.currentTarget.currentTime = 0;
      }}
    />
  ) : (
    <div>ğŸ–¼ï¸</div>
  )}

  // âœ… å·¥ä½œæµå‚æ•°é¢æ¿
  {(model || options) && (
    <div style={{ backgroundColor: '#f8fafc' }}>
      {model && <div><strong>æ¨¡å‹:</strong> {model}</div>}
      {options?.duration && <div><strong>æ—¶é•¿:</strong> {options.duration}ç§’</div>}
      {options?.aspect_ratio && <div><strong>æ¯”ä¾‹:</strong> {options.aspect_ratio}</div>}
      {options?.watermark !== undefined && <div><strong>æ°´å°:</strong> {options.watermark ? 'å¼€å¯' : 'å…³é—­'}</div>}
      {result?.output && <div><strong>è§†é¢‘:</strong> <a href={result.output} target="_blank" onClick={(e) => e.stopPropagation()}>...</a></div>}
    </div>
  )}
  ```
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/components/HistoryPanel/HistoryCard.jsx`
  - ä¿®å¤è§†é¢‘æ˜¾ç¤ºã€å‚æ•°é¢æ¿ã€é“¾æ¥ç‚¹å‡»è¡Œä¸º
- **éœ€æ±‚**: ç±»ä¼¼ ComfyUI çš„å†å²è®°å½•ç®¡ç†ç•Œé¢
- **æ ¸å¿ƒåŠŸèƒ½**:
  - **å†å²è®°å½•ä¾§è¾¹é¢æ¿**: æ˜¾ç¤ºæ‰€æœ‰ä»»åŠ¡å†å²è®°å½•
  - **å¡ç‰‡å¼å¸ƒå±€**: ç¼©ç•¥å›¾ã€æç¤ºè¯ã€çŠ¶æ€ã€æ—¶é—´
  - **ç‚¹å‡»åŠ è½½å·¥ä½œæµ**: ç‚¹å‡»å†å²å¡ç‰‡æ¢å¤å·¥ä½œæµ
  - **ç­›é€‰å’Œæœç´¢**: æŒ‰çŠ¶æ€ã€å¹³å°ã€ç±»å‹ã€æ—¥æœŸç­›é€‰
  - **å³é”®èœå•**: åˆ é™¤ã€å¤åˆ¶æç¤ºè¯ã€å¤åˆ¶å·¥ä½œæµ JSON
  - **æ”¶è—åŠŸèƒ½**: æ ‡è®°å¸¸ç”¨å·¥ä½œæµ
  - **æ‰¹é‡æ“ä½œ**: æ‰¹é‡åˆ é™¤ã€å¯¼å‡ºã€å¯¼å…¥
- **æ•°æ®ç»“æ„æ‰©å±•**:
  - `workflowSnapshot`: å·¥ä½œæµå¿«ç…§ï¼ˆnodes, edges, viewportï¼‰
  - `thumbnail`: ç¼©ç•¥å›¾ URL
  - `tags`: æ ‡ç­¾æ•°ç»„
  - `favorite`: æ˜¯å¦æ”¶è—
  - `viewedCount`: æŸ¥çœ‹æ¬¡æ•°
  - `promptLower`: æç¤ºè¯å°å†™ç‰ˆæœ¬ï¼ˆæœç´¢ä¼˜åŒ–ï¼‰
  - `type`: ä»»åŠ¡ç±»å‹ï¼ˆtext-to-video, image-to-video, storyboardï¼‰
- **ç»„ä»¶æ¶æ„**:
  ```
  src/client/src/components/HistoryPanel/
  â”œâ”€â”€ HistoryPanel.jsx          # ä¸»é¢æ¿å®¹å™¨
  â”œâ”€â”€ HistoryCard.jsx           # å•ä¸ªå†å²å¡ç‰‡
  â”œâ”€â”€ HistorySearchBar.jsx      # æœç´¢æ 
  â”œâ”€â”€ HistoryToolbar.jsx        # å·¥å…·æ 
  â”œâ”€â”€ HistoryDetailsModal.jsx   # è¯¦æƒ…æ¨¡æ€æ¡†
  â””â”€â”€ HistoryContextMenu.jsx    # å³é”®èœå•
  ```
- **å¼€å‘é˜¶æ®µ**:
  - **Phase 1**: åŸºç¡€æ˜¾ç¤ºï¼ˆä¾§è¾¹é¢æ¿ã€å¡ç‰‡ã€ç­›é€‰ã€åˆ†é¡µï¼‰
  - **Phase 2**: æ ¸å¿ƒäº¤äº’ï¼ˆåŠ è½½å·¥ä½œæµã€å³é”®èœå•ã€æœç´¢ï¼‰
  - **Phase 3**: é«˜çº§åŠŸèƒ½ï¼ˆæ‰¹é‡æ“ä½œã€æ ‡ç­¾ã€ç»Ÿè®¡ã€ç¼©ç•¥å›¾ï¼‰
- **ç›¸å…³æ–‡æ¡£**:
  - âœ… `.claude/skills/winjin-dev/references/history-management.md` - è¯¦ç»†è§„åˆ’æ–‡æ¡£

---

#### 37. å†å²è®°å½•ç®¡ç†åŠŸèƒ½å’Œå¿«ç…§æŒä¹…åŒ–ä¿®å¤ (2025-12-31) â­ é‡è¦ä¿®å¤
- **åŠŸèƒ½ç‚¹1: åç«¯ API å®ç°**
  - **æ”¶è— API**: `PUT /api/history/:taskId/favorite` - è®¾ç½®æ”¶è—çŠ¶æ€
  - **åˆ é™¤ API**: `DELETE /api/history/:taskId` - åˆ é™¤å•æ¡è®°å½•
  - **æ¸…ç©º API**: `DELETE /api/history/all` - æ¸…ç©ºæ‰€æœ‰è®°å½•
  - **åç«¯æ–‡ä»¶**: `src/server/index.js` (ç¬¬ 642-669 è¡Œ)
- **åŠŸèƒ½ç‚¹2: å‰ç«¯ UI ç»„ä»¶**
  - **HistoryCard**: æ·»åŠ æ”¶è—æŒ‰é’®ï¼ˆå¯ç‚¹å‡»åˆ‡æ¢ï¼‰å’Œåˆ é™¤æŒ‰é’®ï¼ˆHover æ˜¾ç¤ºï¼‰
  - **HistoryPanel**: åŠ è½½ç¡®è®¤å¯¹è¯æ¡†ã€åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†ã€æ¸…ç©ºç¡®è®¤å¯¹è¯æ¡†
  - **HistoryToolbar**: æ·»åŠ "æˆ‘çš„æ”¶è—"ç­›é€‰é€‰é¡¹å’Œ"æ¸…ç©ºå…¨éƒ¨"æŒ‰é’®
- **åŠŸèƒ½ç‚¹3: å·¥ä½œæµå¿«ç…§æŒä¹…åŒ–ä¿®å¤** â­ å…³é”®
  - **é—®é¢˜**: åŠ è½½çš„å·¥ä½œæµåªæœ‰èŠ‚ç‚¹ï¼Œç¼ºå°‘å‚æ•°ï¼ˆmanualPrompt, shots ç­‰ï¼‰
  - **æ ¹æœ¬åŸå› **:
    - useState åªåœ¨ç»„ä»¶å†…éƒ¨ï¼Œä¸ä¼šè‡ªåŠ¨åŒæ­¥åˆ° node.data
    - useEffect åœ¨æ¸²æŸ“åæ‰§è¡Œï¼Œä½† getNodes() å¯èƒ½åœ¨ useEffect ä¹‹å‰è°ƒç”¨
  - **è§£å†³æ–¹æ¡ˆ**:
    1. **åˆå§‹åŒ–**: ä» `data` å±æ€§åˆå§‹åŒ– useStateï¼ˆæ”¯æŒå·¥ä½œæµæ¢å¤ï¼‰
    2. **useEffect åŒæ­¥**: å½“ useState å˜åŒ–æ—¶åŒæ­¥åˆ° node.data
    3. **å…³é”®ä¿®å¤**: åœ¨ getNodes() ä¹‹å‰æ‰‹åŠ¨è°ƒç”¨ setNodes() åŒæ­¥æ•°æ®
  - **ä¿®å¤æ–‡ä»¶**:
    - `src/client/src/nodes/process/VideoGenerateNode.jsx`
    - `src/client/src/nodes/process/StoryboardNode.jsx`
  - **ä¿®å¤æ¨¡å¼**:
    ```javascript
    // 1. ä» data åˆå§‹åŒ– useState
    const [manualPrompt, setManualPrompt] = useState(data.manualPrompt || '');

    // 2. useEffect: åŒæ­¥åˆ° node.data
    useEffect(() => {
      if (manualPrompt !== data.manualPrompt) {
        setNodes((nds) =>
          nds.map((node) =>
            node.id === nodeId
              ? { ...node, data: { ...node.data, manualPrompt } }
              : node
          )
        );
      }
    }, [manualPrompt, nodeId, setNodes, data.manualPrompt]);

    // 3. å…³é”®ä¿®å¤ï¼šåœ¨ getNodes() ä¹‹å‰æ‰‹åŠ¨åŒæ­¥
    const handleGenerate = async () => {
      setNodes((nds) =>
        nds.map((node) =>
          node.id === nodeId
            ? { ...node, data: { ...node.data, manualPrompt } }
            : node
        )
      );
      const workflowSnapshot = {
        nodes: getNodes(),  // ç°åœ¨åŒ…å«æœ€æ–°çš„ manualPrompt
        edges: getEdges(),
      };
    };
    ```
- **æµ‹è¯•ç»“æœ**:
  - âœ… æ”¶è—åŠŸèƒ½: ç‚¹å‡»æ˜Ÿæ ‡åˆ‡æ¢æ”¶è—çŠ¶æ€
  - âœ… åˆ é™¤åŠŸèƒ½: ç‚¹å‡»åˆ é™¤æŒ‰é’®åˆ é™¤å•æ¡è®°å½•
  - âœ… æ¸…ç©ºåŠŸèƒ½: ç‚¹å‡»"æ¸…ç©ºå…¨éƒ¨"æ¸…ç©ºæ‰€æœ‰è®°å½•
  - âœ… å·¥ä½œæµæ¢å¤: åŠ è½½å†å²è®°å½•æ¢å¤å®Œæ•´å·¥ä½œæµï¼ˆåŒ…å«æ‰€æœ‰å‚æ•°ï¼‰
- **ç›¸å…³æ–‡æ¡£æ›´æ–°**:
  - âœ… code.md: æ·»åŠ é”™è¯¯33 - å·¥ä½œæµå¿«ç…§æŒä¹…åŒ–æ—¶æœºé—®é¢˜ï¼ˆç¬¬ 3714-3885 è¡Œï¼‰
  - âœ… å¼€å‘äº¤æ¥ä¹¦.md: ç‰ˆæœ¬å·æ›´æ–°åˆ° v3.3ï¼Œæœ¬æ¡ç›®

---

### å¾…å¼€å‘åŠŸèƒ½

#### 13. å·¥ä½œæµä¿å­˜/åŠ è½½åŠŸèƒ½ (å¾…å¼€å‘) â³
- **åŠŸèƒ½**: ä¿å­˜å½“å‰å·¥ä½œæµé…ç½®ï¼Œæ”¯æŒå¿«é€ŸåŠ è½½
- **æ ¼å¼**: JSON æ–‡ä»¶å­˜å‚¨èŠ‚ç‚¹ä½ç½®ã€è¿æ¥å…³ç³»ã€å‚æ•°é…ç½®
- **æ¨¡æ¿åº“**: é¢„è®¾å¸¸ç”¨å·¥ä½œæµæ¨¡æ¿

---

## ğŸ‰ é‡å¤§é‡Œç¨‹ç¢‘ï¼šå¯è§†åŒ–èŠ‚ç‚¹å·¥ä½œæµç³»ç»Ÿå®Œæˆï¼ (2025-12-30)

#### 12. å¯è§†åŒ–èŠ‚ç‚¹å·¥ä½œæµç³»ç»Ÿ âœ… å·²å®Œæˆ

**å®ç°æ¦‚è¿°**ï¼š
æˆåŠŸå®ç°å®Œæ•´çš„ ComfyUI é£æ ¼å¯è§†åŒ–èŠ‚ç‚¹å·¥ä½œæµç¼–è¾‘å™¨ï¼ŒåŒ…å« 9 ç§èŠ‚ç‚¹ç±»å‹ã€æ™ºèƒ½æ‰§è¡Œå¼•æ“ã€å®æ—¶æ•°æ®æµä¼ é€’ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **React Flow ç”»å¸ƒ** - æ‹–æ‹½èŠ‚ç‚¹å¸ƒå±€ã€è´å¡å°”æ›²çº¿è¿çº¿
2. **8 ç§èŠ‚ç‚¹ç±»å‹** - 3 è¾“å…¥ + 3 å¤„ç† + 2 è¾“å‡º
3. **æ‰§è¡Œå¼•æ“** - æ‹“æ‰‘æ’åºè‡ªåŠ¨æ‰§è¡Œã€è¿›åº¦å®æ—¶åé¦ˆ
4. **å·¥å…·æ  UI** - æ‰§è¡Œ/é‡ç½®æŒ‰é’®ã€çŠ¶æ€æ˜¾ç¤º

**èŠ‚ç‚¹æ¸…å•**ï¼š

**è¾“å…¥èŠ‚ç‚¹ (3ä¸ª)** - è“è‰²ç³»:
- ğŸ“ æ–‡æœ¬èŠ‚ç‚¹ - æç¤ºè¯è¾“å…¥ (TextNode.jsx)
- ğŸ–¼ï¸ å‚è€ƒå›¾ç‰‡èŠ‚ç‚¹ - å›¾ç‰‡URLç®¡ç† (ReferenceImageNode.jsx)
- ğŸ“Š è§’è‰²åº“èŠ‚ç‚¹ - æµè§ˆå¹¶é€‰æ‹©è§’è‰² (CharacterLibraryNode.jsx)

**å¤„ç†èŠ‚ç‚¹ (3ä¸ª)** - ç»¿è‰²ç³»:
- ğŸ­ è§’è‰²ç”ŸæˆèŠ‚ç‚¹ - URL/ä»»åŠ¡IDåˆ›å»ºè§’è‰² (CharacterCreateNode.jsx)
- ğŸ¬ è§†é¢‘ç”ŸæˆèŠ‚ç‚¹ - æ–‡ç”Ÿè§†é¢‘ (VideoGenerateNode.jsx)
- ğŸï¸ æ•…äº‹æ¿èŠ‚ç‚¹ - å•ä¸ªè§†é¢‘ä»»åŠ¡ï¼Œå¤šæ—¶é—´æ®µæè¿° (StoryboardNode.jsx) âš ï¸ å®ç°æœ‰è¯¯ï¼Œå¾…ä¿®å¤

**è¾“å‡ºèŠ‚ç‚¹ (2ä¸ª)** - å¤©è“ç³»:
- ğŸ“º ä»»åŠ¡ç»“æœèŠ‚ç‚¹ - è§†é¢‘é¢„è§ˆ/ä¸‹è½½ (TaskResultNode.jsx)
- ğŸ“‹ æ‰§è¡Œæ—¥å¿—èŠ‚ç‚¹ - æ—¥å¿—å±•ç¤º (ExecutionLogNode.jsx)

**æŠ€æœ¯å®ç°**ï¼š
- React 19 + React Flow 11.x
- Vite 7.x æ„å»ºå·¥å…·
- è‡ªå®šä¹‰ useWorkflowExecution Hook
- æ‹“æ‰‘æ’åºç®—æ³•
- å¾ªç¯ä¾èµ–æ£€æµ‹

**Git æäº¤è®°å½•**ï¼š
```
1bc576f feat: Phase 5 - Implement output nodes
9da8039 feat: Phase 4 - Implement workflow execution engine
042b0ca feat: Phase 3 - Implement all process nodes
8a4d596 feat: Phase 2 - Implement all input nodes
b5b21c8 feat: Phase 1 - React Flow workflow editor foundation
```

**è®¿é—®åœ°å€**ï¼š
- å·¥ä½œæµç¼–è¾‘å™¨: http://localhost:5173
- å¯åŠ¨å‘½ä»¤: `cd src/client && npm run dev`

**é¡¹ç›®ç»“æ„**ï¼š
```
src/client/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ nodes/
â”‚   â”‚   â”œâ”€â”€ input/    # 4ä¸ªè¾“å…¥èŠ‚ç‚¹
â”‚   â”‚   â”œâ”€â”€ process/  # 3ä¸ªå¤„ç†èŠ‚ç‚¹
â”‚   â”‚   â””â”€â”€ output/   # 2ä¸ªè¾“å‡ºèŠ‚ç‚¹
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useWorkflowExecution.js
â”‚   â””â”€â”€ App.jsx
```

**åŠŸèƒ½éªŒè¯**ï¼š
- âœ… æ‰€æœ‰èŠ‚ç‚¹æ­£å¸¸æ¸²æŸ“
- âœ… èŠ‚ç‚¹å¯æ‹–æ‹½/è¿æ¥
- âœ… æ‰§è¡Œå¼•æ“æ­£ç¡®æ’åº
- âœ… æ•°æ®æµè‡ªåŠ¨ä¼ é€’

---

### é‡å¤§ Bug ä¿®å¤ ğŸ›

#### 14. TaskResultNode API ç«¯ç‚¹è·¯å¾„ä¿®å¤ (2025-12-30) â­ é‡å¤§ä¿®å¤
- **é—®é¢˜**: TaskResultNode è½®è¯¢ä»»åŠ¡çŠ¶æ€æ—¶è¿”å› 404 é”™è¯¯
- **åŸå› **: API è·¯å¾„ç¼ºå°‘ `/api/` å‰ç¼€
  - é”™è¯¯: `http://localhost:9000/task/{taskId}` â†’ 404
  - æ­£ç¡®: `http://localhost:9000/api/task/{taskId}` â†’ 200
- **å½±å“**: è§†é¢‘ä»»åŠ¡å®Œæˆåæ— æ³•æ˜¾ç¤ºç»“æœ
- **ä¿®å¤ä½ç½®**:
  - `src/client/src/nodes/output/TaskResultNode.jsx` (ç¬¬66è¡Œã€ç¬¬102è¡Œ)
- **ä¿®å¤å†…å®¹**:
  - è½®è¯¢å‡½æ•°: æ·»åŠ  `/api/` å‰ç¼€
  - æ‰‹åŠ¨åˆ·æ–°å‡½æ•°: æ·»åŠ  `/api/` å‰ç¼€
- **éªŒè¯ç»“æœ**:
  - âœ… API è¯·æ±‚æˆåŠŸè¿”å› 200 OK
  - âœ… ä»»åŠ¡çŠ¶æ€æ­£ç¡®è½®è¯¢
  - âœ… è§†é¢‘URLæ­£ç¡®æ˜¾ç¤º
  - âœ… taskId é€šè¿‡äº‹ä»¶ç³»ç»Ÿæ­£ç¡®ä¼ é€’

#### 15. å·¥ä½œæµèŠ‚ç‚¹æ•°æ®æµä¿®å¤ (2025-12-30)

**é—®é¢˜æè¿°**ï¼š
- ä»»åŠ¡ç»“æœèŠ‚ç‚¹æœªæ¥æ”¶åˆ°æ¥è‡ªè§†é¢‘ç”ŸæˆèŠ‚ç‚¹çš„ taskId
- æ‰§è¡Œæ—¥å¿—èŠ‚ç‚¹æœªæ˜¾ç¤ºå·¥ä½œæµæ‰§è¡Œæ—¥å¿—
- å¯¼è‡´è¾“å‡ºèŠ‚ç‚¹æ— æ³•æ­£å¸¸å·¥ä½œ

**ä¿®å¤å†…å®¹**ï¼š

1. **ä¿®å¤æ— é™å¾ªç¯é—®é¢˜**
   - ç§»é™¤ useEffect ä¾èµ–æ•°ç»„ä¸­çš„ `nodes`
   - ä½¿ç”¨å‡½æ•°å¼æ›´æ–°è‡ªåŠ¨è·å–æœ€æ–°èŠ‚ç‚¹æ•°æ®
   - æ–‡ä»¶ï¼šApp.jsx:206

2. **ä¿®å¤ taskId ä¼ é€’**
   - VideoGenerateNode ä½¿ç”¨ `useNodeId()` è·å–èŠ‚ç‚¹ ID
   - é€šè¿‡ `setNodes()` æ›´æ–° node.data.taskId
   - æ´¾å‘è‡ªå®šä¹‰äº‹ä»¶ 'video-task-created' é€šçŸ¥è¿æ¥çš„èŠ‚ç‚¹
   - æ–‡ä»¶ï¼šVideoGenerateNode.jsx:7,85-87

3. **ä¿®å¤äº‹ä»¶ç›‘å¬**
   - TaskResultNode ç›‘å¬ 'video-task-created' äº‹ä»¶
   - æ£€æŸ¥ connectedSourceId åŒ¹é…åæ›´æ–° taskId
   - æ”¯æŒè‡ªåŠ¨è½®è¯¢ä»»åŠ¡çŠ¶æ€
   - æ–‡ä»¶ï¼šTaskResultNode.jsx:26-37

4. **ä¿®å¤æ‰§è¡Œæ—¥å¿—ä¼ é€’**
   - useWorkflowExecution æ·»åŠ  logs æ•°ç»„åˆ° executionState
   - åˆ›å»º addLog() è¾…åŠ©å‡½æ•°è®°å½•æ‰§è¡Œæ­¥éª¤
   - App.jsx ä¼ é€’ logs åˆ° ExecutionLogNode
   - æ–‡ä»¶ï¼šuseWorkflowExecution.js:9-19,77-81

5. **æ·»åŠ  connectedSourceId ä¼ é€’**
   - App.jsx åœ¨è¿æ¥æ—¶ä¼ é€’ source node ID
   - TaskResultNode ä½¿ç”¨ connectedSourceId éªŒè¯äº‹ä»¶æ¥æº
   - æ–‡ä»¶ï¼šApp.jsx:194-196

**æŠ€æœ¯è¦ç‚¹**ï¼š
- React Flow çš„ data ä¸åŒ…å«èŠ‚ç‚¹ idï¼Œå¿…é¡»ä½¿ç”¨ useNodeId()
- setNodes() æ˜¯å¼‚æ­¥æ‰¹å¤„ç†ï¼Œä¸èƒ½ä¾èµ– getNodes() è·å–æœ€æ–°æ•°æ®
- ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶ç³»ç»Ÿå®ç°èŠ‚ç‚¹é—´å®æ—¶é€šä¿¡
- useEffect ä¾èµ–æ•°ç»„ä¸èƒ½åŒ…å«ä¼šå¯¼è‡´è‡ªèº«æ›´æ–°çš„çŠ¶æ€

**éªŒè¯ç»“æœ**ï¼š
- âœ… æ–‡æœ¬èŠ‚ç‚¹ â†’ è§†é¢‘ç”ŸæˆèŠ‚ç‚¹ï¼šæç¤ºè¯æ­£ç¡®ä¼ é€’
- âœ… è§†é¢‘ç”Ÿæˆ â†’ ä»»åŠ¡ç»“æœèŠ‚ç‚¹ï¼štaskId é€šè¿‡äº‹ä»¶æ­£ç¡®ä¼ é€’
- âœ… ä»»åŠ¡ç»“æœèŠ‚ç‚¹ï¼šæ˜¾ç¤º taskId å¹¶è‡ªåŠ¨è½®è¯¢çŠ¶æ€
- âœ… æ‰§è¡Œæ—¥å¿—èŠ‚ç‚¹ï¼šæ˜¾ç¤ºå®Œæ•´å·¥ä½œæµæ‰§è¡Œæ—¥å¿—

**ç›¸å…³æ–‡æ¡£æ›´æ–°**ï¼š
- code.mdï¼šæ·»åŠ  "é”™è¯¯16: React Flow èŠ‚ç‚¹é—´æ•°æ®ä¼ é€’é”™è¯¯"

---

#### 16. è§†é¢‘ç”ŸæˆèŠ‚ç‚¹æ—¶é•¿å‚æ•°ä¿®å¤ (2025-12-30) â­ æ–°å¢
- **é—®é¢˜**:
  - Sora2 API ä¸æ”¯æŒ 1:1 æ¯”ä¾‹
  - æ—¶é•¿å‚æ•°ç±»å‹é”™è¯¯ï¼ˆå­—ç¬¦ä¸²è€Œéæ•°å­—ï¼‰
- **ä¿®å¤**:
  - ç§»é™¤ 1:1 æ¯”ä¾‹é€‰é¡¹ï¼Œåªä¿ç•™ 16:9 å’Œ 9:16
  - æ·»åŠ æ—¶é•¿ä¸‹æ‹‰èœå•ï¼š5ç§’ã€10ç§’ã€15ç§’ã€25ç§’
  - æ—¶é•¿å‚æ•°ä»å­—ç¬¦ä¸²æ”¹ä¸ºæ•°å­—ç±»å‹
- **å½±å“æ–‡ä»¶**: `src/client/src/nodes/process/VideoGenerateNode.jsx`

#### 17. ä»»åŠ¡ç»“æœèŠ‚ç‚¹å¢å¼ºåŠŸèƒ½ (2025-12-30) â­ æ–°å¢
- **æ–°å¢åŠŸèƒ½**:
  - ğŸ“‹ å¤åˆ¶ TaskId æŒ‰é’®ï¼ˆå¸¦ 2 ç§’åé¦ˆæç¤ºï¼‰
  - ğŸ”— å¤åˆ¶è§†é¢‘é“¾æ¥æŒ‰é’®
  - ğŸ”„ æ‰‹åŠ¨æŸ¥è¯¢çŠ¶æ€æŒ‰é’®
  - æ”¯æŒæ—§æµè§ˆå™¨é™çº§ï¼ˆexecCommand å¤‡é€‰æ–¹æ¡ˆï¼‰
- **æŠ€æœ¯å®ç°**:
  - ä½¿ç”¨ navigator.clipboard APIï¼ˆç°ä»£æµè§ˆå™¨ï¼‰
  - é™çº§æ–¹æ¡ˆï¼šdocument.execCommand('copy')ï¼ˆæ—§æµè§ˆå™¨ï¼‰
  - å¤åˆ¶æˆåŠŸåæ˜¾ç¤º 2 ç§’åé¦ˆæç¤º
- **å½±å“æ–‡ä»¶**: `src/client/src/nodes/output/TaskResultNode.jsx`

#### 18. å·¥ä½œæµç®¡ç†ç³»ç»Ÿ (2025-12-30) â­ æ–°å¢
- **æ ¸å¿ƒåŠŸèƒ½**:
  - ğŸ’¾ **ä¿å­˜å·¥ä½œæµ** - ä¿å­˜åˆ°å½“å‰å·¥ä½œæµæˆ–å¦å­˜ä¸ºæ–°åç§°
  - ğŸ“‚ **æ‰“å¼€å·¥ä½œæµ** - åˆ—è¡¨æŸ¥çœ‹å¹¶åŠ è½½å·²ä¿å­˜çš„å·¥ä½œæµ
  - â• **æ–°å»ºå·¥ä½œæµ** - æ¸…ç©ºå½“å‰å·¥ä½œæµï¼ˆå¸¦ç¡®è®¤å¯¹è¯æ¡†ï¼‰
  - ğŸ—‘ï¸ **åˆ é™¤å·¥ä½œæµ** - åˆ é™¤æŒ‡å®šå·¥ä½œæµï¼ˆå¸¦ç¡®è®¤å¯¹è¯æ¡†ï¼‰
  - ğŸ“¤ **å¯¼å‡ºå·¥ä½œæµ** - ä¸‹è½½ä¸º JSON æ–‡ä»¶
  - ğŸ“¥ **å¯¼å…¥å·¥ä½œæµ** - ä» JSON æ–‡ä»¶å¯¼å…¥ï¼ˆè‡ªåŠ¨é‡å‘½åé¿å…å†²çªï¼‰
  - ğŸ“ **å½“å‰å·¥ä½œæµæ˜¾ç¤º** - å·¥å…·æ æ˜¾ç¤ºè“è‰²æ ‡ç­¾
- **æŠ€æœ¯å®ç°**:
  - åˆ›å»º `WorkflowStorage` å·¥å…·ç±»ï¼ˆ`src/client/src/utils/workflowStorage.js`ï¼‰
  - localStorage æŒä¹…åŒ–å­˜å‚¨ï¼ˆé”®åï¼š`winjin-workflows`ï¼‰
  - è‡ªåŠ¨ç®¡ç† nextNodeIdï¼ˆåŠ è½½å·¥ä½œæµåè‡ªåŠ¨é€’å¢ï¼‰
  - å®Œæ•´çš„ UI å¯¹è¯æ¡†å’Œä¸‹æ‹‰èœå•
  - æ•°æ®éªŒè¯ï¼ˆå¯¼å…¥æ—¶æ£€æŸ¥å¿…éœ€å­—æ®µï¼‰
  - å†²çªå¤„ç†ï¼ˆå¯¼å…¥æ—¶è‡ªåŠ¨æ·»åŠ åç¼€é¿å…è¦†ç›–ï¼‰
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/utils/workflowStorage.js` (æ–°å¢)
  - `src/client/src/App.jsx` (å·¥ä½œæµç®¡ç† UI)
- **å­˜å‚¨ç»“æ„**:
  ```javascript
  {
    "å·¥ä½œæµåç§°": {
      name: "å·¥ä½œæµåç§°",
      description: "å·¥ä½œæµæè¿°",
      nodes: [...],      // React Flow èŠ‚ç‚¹æ•°ç»„
      edges: [...],      // React Flow è¿çº¿æ•°ç»„
      createdAt: "2025-12-30T12:00:00.000Z",
      updatedAt: "2025-12-30T12:30:00.000Z"
    }
  }
  ```

#### 19. èŠ‚ç‚¹ç®¡ç†å¢å¼ºåŠŸèƒ½ (2025-12-30) â­ æ–°å¢
- **å³é”®èœå•åŠŸèƒ½**:
  - **èŠ‚ç‚¹èœå•**: å¤åˆ¶èŠ‚ç‚¹ã€åˆ é™¤èŠ‚ç‚¹
  - **ç”»å¸ƒèœå•**: ç²˜è´´èŠ‚ç‚¹ã€æ·»åŠ æ‰€æœ‰èŠ‚ç‚¹ç±»å‹
  - **ç‚¹å‡»å¤–éƒ¨**: è‡ªåŠ¨å…³é—­èœå•
- **èŠ‚ç‚¹åˆ é™¤ä¿®å¤**:
  - **ä¸Šä¸‹æ–‡åˆ é™¤**: åˆ é™¤å³é”®ç‚¹å‡»çš„ç‰¹å®šèŠ‚ç‚¹ï¼ˆ`deleteNode(node)`ï¼‰
  - **å·¥å…·æ åˆ é™¤**: åˆ é™¤æ‰€æœ‰é€‰ä¸­èŠ‚ç‚¹ï¼ˆ`deleteSelectedNodes()`ï¼‰
  - **å¿«æ·é”®**: Delete é”®åˆ é™¤é€‰ä¸­èŠ‚ç‚¹
- **èŠ‚ç‚¹åˆ›å»ºä½ç½®ä¿®å¤**:
  - **å³é”®åˆ›å»º**: ä½¿ç”¨ `screenToFlowPosition()` è½¬æ¢åæ ‡
  - **é—®é¢˜**: ä¹‹å‰ä½¿ç”¨ `project()`ï¼ˆå·²åºŸå¼ƒï¼‰æˆ– viewport åæ ‡ï¼ŒèŠ‚ç‚¹ä½ç½®ä¸æ­£ç¡®
  - **è§£å†³**: ä½¿ç”¨æ­£ç¡®çš„åæ ‡è½¬æ¢ API
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/App.jsx` (èŠ‚ç‚¹ç®¡ç†é€»è¾‘)
  - `src/client/src/main.jsx` (æ·»åŠ  ReactFlowProvider)

#### 20. è§’è‰²ç»“æœèŠ‚ç‚¹ (2025-12-30) â­ æ–°å¢
- **åŠŸèƒ½æè¿°**:
  - æ˜¾ç¤ºè§’è‰²åˆ›å»ºä»»åŠ¡çš„è¯¦ç»†ç»“æœ
  - é€šè¿‡äº‹ä»¶ç³»ç»Ÿä» CharacterCreateNode æ¥æ”¶è§’è‰²æ•°æ®
  - æä¾›å¤åˆ¶åˆ°å‰ªè´´æ¿åŠŸèƒ½ï¼ˆè§’è‰² IDã€ç”¨æˆ·åï¼‰
- **æ•°æ®æ ¼å¼**:
  ```javascript
  {
    id: "ch_69536e7ce60481919c4e9a2a3cf4c6d5",
    username: "de3602969.sunnykitty",
    permalink: "https://sora.chatgpt.com/profile/...",
    profile_picture_url: "https://...",
    alias: "å¯é€‰åˆ«å"
  }
  ```
- **äº‹ä»¶ç³»ç»Ÿ**:
  - äº‹ä»¶å: `character-created`
  - äº‹ä»¶æ•°æ®: `{ sourceNodeId, character }`
  - éªŒè¯é€»è¾‘: æ£€æŸ¥ `data.connectedSourceId === event.detail.sourceNodeId`
- **æŠ€æœ¯å®ç°**:
  - è¾“å…¥ç«¯å£: `character-input` (å·¦ä¾§)
  - æ— è¾“å‡ºç«¯å£ï¼ˆçº¯å±•ç¤ºèŠ‚ç‚¹ï¼‰
  - å‰ªè´´æ¿ API: ä¼˜å…ˆ `navigator.clipboard`ï¼Œé™çº§ `execCommand`
  - å¤åˆ¶åé¦ˆ: æ˜¾ç¤º "âœ“ å·²å¤åˆ¶" 2 ç§’
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/output/CharacterResultNode.jsx` (æ–°å¢)
  - `src/client/src/nodes/process/CharacterCreateNode.jsx` (æ·»åŠ äº‹ä»¶æ´¾å‘)

#### 21. ç¼–è¯‘é”™è¯¯ä¿®å¤ (2025-12-30) â­ Bug ä¿®å¤
- **é—®é¢˜**: Babel ç¼–è¯‘é”™è¯¯ - "Identifier 'characterEdge' has already been declared"
- **åŸå› **: App.jsx ä¸­åŒä¸€ä½œç”¨åŸŸå†…é‡å¤å£°æ˜ `characterEdge` å˜é‡
- **è§£å†³**: åˆå¹¶ç›¸å…³é€»è¾‘ï¼Œåªå£°æ˜ä¸€æ¬¡å˜é‡ï¼Œä½¿ç”¨æ¡ä»¶åˆ†æ”¯å¤„ç†ä¸åŒåœºæ™¯
- **å½±å“æ–‡ä»¶**: `src/client/src/App.jsx` (ç¬¬ 207-221 è¡Œ)

#### 22. è§’è‰²åº“ç®¡ç†åŠŸèƒ½ (2025-12-30) â­ æ–°å¢
- **åŠŸèƒ½ç‚¹1: å•ä¸ªè§’è‰²åˆ é™¤**
  - æ‚¬åœæ˜¾ç¤ºåˆ é™¤æŒ‰é’®ï¼ˆâœ•ï¼‰åœ¨è§’è‰²å¡ç‰‡å³ä¸Šè§’
  - ç‚¹å‡»åˆ é™¤æŒ‰é’®å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†
  - æ˜¾ç¤º "âš ï¸ ç¡®è®¤åˆ é™¤" å’Œ "æ­¤æ“ä½œä¸å¯æ¢å¤!" è­¦å‘Š
  - åˆ é™¤æˆåŠŸåé‡æ–°åŠ è½½è§’è‰²åˆ—è¡¨
- **åŠŸèƒ½ç‚¹2: ç¼–è¾‘è§’è‰²åˆ«å**
  - ç‚¹å‡»è§’è‰²å¡ç‰‡æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
  - æ˜¾ç¤ºç”¨æˆ·åã€è§’è‰² ID å’Œå½“å‰åˆ«å
  - è¾“å…¥æ–°åˆ«åï¼ˆæœ€å¤š 50 å­—ç¬¦ï¼‰
  - ä¿å­˜/å–æ¶ˆæŒ‰é’®ï¼ŒæˆåŠŸåæ˜¾ç¤º "âœ… åˆ«åå·²æ›´æ–°"
- **åŠŸèƒ½ç‚¹3: æ‰¹é‡é€‰æ‹©æ¨¡å¼**
  - "æ‰¹é‡æ“ä½œ" æŒ‰é’®åˆ‡æ¢æ‰¹é‡æ¨¡å¼
  - ç‚¹å‡»è§’è‰²å¡ç‰‡è¿›è¡Œé€‰æ‹©/å–æ¶ˆé€‰æ‹©
  - é»„è‰²è¾¹æ¡†å’ŒèƒŒæ™¯è¡¨ç¤ºé€‰ä¸­çŠ¶æ€
  - å¤é€‰æ¡†æ˜¾ç¤ºé€‰ä¸­æ ‡è®°ï¼ˆâœ“ï¼‰
- **åŠŸèƒ½ç‚¹4: æ‰¹é‡åˆ é™¤åŠŸèƒ½**
  - "å…¨é€‰" / "å–æ¶ˆå…¨é€‰" æŒ‰é’®
  - "åˆ é™¤ (N)" æŒ‰é’®æ˜¾ç¤ºå·²é€‰æ•°é‡
  - ç¡®è®¤å¯¹è¯æ¡†æ˜¾ç¤ºåˆ é™¤æ•°é‡
  - å¹¶å‘è°ƒç”¨åˆ é™¤ APIï¼ˆPromise.allï¼‰
- **æŠ€æœ¯å®ç°**:
  - 7 ä¸ªæ–°çŠ¶æ€å˜é‡ï¼ˆbatchMode, selectedCharacters, editingCharacter ç­‰ï¼‰
  - 4 ä¸ªæ–°å¼‚æ­¥å‡½æ•°ï¼ˆdeleteCharacter, updateAlias, deleteBatchCharacters ç­‰ï¼‰
  - 2 ä¸ªæ¨¡æ€å¯¹è¯æ¡†ï¼ˆç¼–è¾‘åˆ«åã€åˆ é™¤ç¡®è®¤ï¼‰
  - UI è§†è§‰åé¦ˆï¼ˆé€‰ä¸­çŠ¶æ€ã€æŒ‰é’®çŠ¶æ€ï¼‰
- **API é›†æˆ**:
  - `DELETE /api/character/:characterId` - åˆ é™¤å•ä¸ªè§’è‰²
  - `PUT /api/character/:characterId/alias` - æ›´æ–°åˆ«å
- **æµ‹è¯•ç»“æœ**:
  - âœ… ç¼–è¾‘åˆ«å: æˆåŠŸæ›´æ–° "5562be00d.sunbeamkit" â†’ "é˜³å…‰å°çŒ«"
  - âœ… æ‰¹é‡é€‰æ‹©: å…¨é€‰/å–æ¶ˆå…¨é€‰/å•ä¸ªé€‰æ‹©æ­£å¸¸å·¥ä½œ
  - âœ… å•ä¸ªåˆ é™¤: ç¡®è®¤å¯¹è¯æ¡†å’Œåˆ é™¤åŠŸèƒ½æ­£å¸¸
  - âœ… æ‰¹é‡åˆ é™¤: å¹¶å‘åˆ é™¤å¤šä¸ªè§’è‰²æˆåŠŸ
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/input/CharacterLibraryNode.jsx` (419 è¡Œæ–°å¢ä»£ç )

#### 23. ç§»é™¤è§’è‰²é€‰æ‹©èŠ‚ç‚¹ (2025-12-30) â­ é‡æ„
- **é—®é¢˜**: CharacterSelectNode å’Œ CharacterLibraryNode åŠŸèƒ½é‡å¤
- **åŸå› **:
  - ä¸¤ä¸ªèŠ‚ç‚¹éƒ½èƒ½é€‰æ‹©è§’è‰²ï¼Œé€ æˆç”¨æˆ·å›°æƒ‘
  - CharacterSelectNode æœ‰ API è·¯å¾„ bugï¼ˆç¼ºå°‘ /api/ å‰ç¼€ï¼‰
  - CharacterLibraryNode åŠŸèƒ½æ›´å®Œå–„ï¼ˆæœç´¢ã€ç­›é€‰ã€æ”¶è—ã€ç®¡ç†ï¼‰
  - CharacterSelectNode æ²¡æœ‰ç‹¬ç‰¹ä¼˜åŠ¿
- **è§£å†³æ–¹æ¡ˆ**: ç§»é™¤ CharacterSelectNodeï¼Œç»Ÿä¸€ä½¿ç”¨ CharacterLibraryNode
- **å˜æ›´å†…å®¹**:
  - ä» App.jsx ç§»é™¤ CharacterSelectNode å¯¼å…¥
  - ä» nodeTypes å¯¹è±¡ç§»é™¤ characterSelectNode
  - ä» nodeTemplates æ•°ç»„ç§»é™¤ characterSelectNode
  - åˆ é™¤ CharacterSelectNode.jsx æ–‡ä»¶ï¼ˆ192 è¡Œä»£ç ï¼‰
  - èŠ‚ç‚¹æ•°é‡ä» 9 ä¸ªå‡å°‘åˆ° 8 ä¸ª
- **å½±å“èŒƒå›´**:
  - è¾“å…¥èŠ‚ç‚¹ä» 4 ä¸ªå‡å°‘åˆ° 3 ä¸ª
  - å·¥ä½œæµç¼–è¾‘å™¨èŠ‚ç‚¹æ¨¡æ¿æ›´ç®€æ´
  - ç”¨æˆ·ä½¿ç”¨ CharacterLibraryNode é€‰æ‹©è§’è‰²ï¼ˆåŠŸèƒ½æ›´å¼ºå¤§ï¼‰
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/App.jsx` (ç§»é™¤å¯¼å…¥å’Œæ³¨å†Œ)
  - `src/client/src/nodes/input/CharacterSelectNode.jsx` (åˆ é™¤æ–‡ä»¶)

#### 24. è§’è‰²å¼•ç”¨ç­–ç•¥è®¾è®¡ (2025-12-30) â­ æ¶æ„è®¾è®¡
- **éœ€æ±‚**: åœ¨è§†é¢‘ç”ŸæˆèŠ‚ç‚¹ä¸­å¿«é€Ÿè¾“å…¥å¤šè§’è‰²å¼•ç”¨
  - ç¤ºä¾‹: `@user_name1 ä¸€è¾¹åƒé¥­ï¼Œä¸€è¾¹å’Œ @user_name2 èŠå¤©`
- **è®¾è®¡æ–¹æ¡ˆ**: æ··åˆç­–ç•¥ï¼ˆæ–¹æ¡ˆä¸‰ï¼‰
  - **Layer 1: è¿æ¥çš„è§’è‰²**ï¼ˆè‡ªåŠ¨è·å–ï¼‰
    - ä» `character` è¾“å…¥ç«¯å£è‡ªåŠ¨è·å–
    - æ˜¾ç¤ºä¸º `[ğŸ”— å·²è¿æ¥]` æ ‡è¯†
    - ä½œä¸ºåŸºç¡€è§’è‰²ï¼Œä¸å¯æ‰‹åŠ¨åˆ é™¤
  - **Layer 2: æ”¶è—å¤¹è§’è‰²**ï¼ˆå¿«é€Ÿè®¿é—®ï¼‰
    - æ˜¾ç¤ºæ”¶è—çš„è§’è‰²åˆ—è¡¨ï¼ˆå¿«é€Ÿé€‰æ‹©ï¼‰
    - ç‚¹å‡»æ·»åŠ åˆ°ã€å½“å‰ä½¿ç”¨è§’è‰²ã€‘
    - é€‚åˆï¼šå¸¸ç”¨è§’è‰²
  - **Layer 3: è§’è‰²åº“æœç´¢**ï¼ˆæŒ‰éœ€é€‰æ‹©ï¼‰
    - æœç´¢æ¡† + è§’è‰²åˆ—è¡¨
    - ç‚¹å‡»æ·»åŠ åˆ°ã€å½“å‰ä½¿ç”¨è§’è‰²ã€‘
    - é€‚åˆï¼šä¸€æ¬¡æ€§ä½¿ç”¨æˆ–æ–°åˆ›å»ºçš„è§’è‰²
- **è§’è‰²å¼•ç”¨æ ¼å¼**:
  - æ ¼å¼ï¼š`@username`ï¼ˆä¸å¸¦èŠ±æ‹¬å·ï¼‰
  - ç¤ºä¾‹ï¼š`@user1 ä¸€è¾¹åƒé¥­ï¼Œä¸€è¾¹å’Œ @user2 èŠå¤©`
  - ä½ç½®ï¼šè‡ªåŠ¨åœ¨æç¤ºè¯å¼€å¤´æ’å…¥æ‰€æœ‰è§’è‰²å¼•ç”¨
  - é¡ºåºï¼šæŒ‰ã€å½“å‰ä½¿ç”¨è§’è‰²ã€‘åˆ—è¡¨é¡ºåºæ’åˆ—
- **æç¤ºè¯ç»„è£…é€»è¾‘**:
  ```javascript
  function assemblePrompt(userPrompt, allCharacters) {
    const roleRefs = allCharacters
      .map(c => `@${c.username}`)
      .join(' ');
    return `${roleRefs} ${userPrompt}`.trim();
  }
  ```
- **æ•°æ®æµ**:
  ```
  CharacterLibraryNode (å•é€‰)
    â†“ character (å¯¹è±¡)
  VideoGenerateNode
    â†“ æ¥æ”¶å¹¶æ˜¾ç¤ºåˆ°ã€å·²è¿æ¥è§’è‰²ã€‘
    â†“ ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ æ›´å¤šè§’è‰²ï¼ˆå¯é€‰ï¼‰
    â†“ ã€å½“å‰ä½¿ç”¨è§’è‰²ã€‘åˆ—è¡¨
    â†“ è‡ªåŠ¨ç»„è£…åˆ°æç¤ºè¯å¼€å¤´
  ```
- **MVP èŒƒå›´**:
  - åªå®ç° Layer 1ï¼ˆè¿æ¥çš„è§’è‰²ï¼‰
  - è‡ªåŠ¨åœ¨æç¤ºè¯å¼€å¤´æ’å…¥è§’è‰²å¼•ç”¨
  - æ˜¾ç¤ºè¿æ¥è§’è‰²å¡ç‰‡ï¼ˆå¤´åƒã€ç”¨æˆ·åï¼‰
- **æ–‡æ¡£æ›´æ–°**:
  - `base.md`: æ·»åŠ è§’è‰²å¼•ç”¨ç­–ç•¥ç« èŠ‚ï¼ˆç¬¬ 261-308 è¡Œï¼‰
  - `code.md`: æ·»åŠ è§’è‰²å¼•ç”¨å®ç°ä»£ç ç¤ºä¾‹ï¼ˆç¬¬ 1431-1655 è¡Œï¼‰

#### 25. è§’è‰²å¼•ç”¨ MVP å®ç° (2025-12-30) â­ æ–°å¢
- **åŠŸèƒ½**: å®ç°è§’è‰²åº“èŠ‚ç‚¹åˆ°è§†é¢‘ç”ŸæˆèŠ‚ç‚¹çš„è§’è‰²å¼•ç”¨ä¼ é€’
- **MVP èŒƒå›´**:
  - æ˜¾ç¤ºä» CharacterLibraryNode è¿æ¥çš„è§’è‰²
  - æ˜¾ç¤ºè§’è‰²å¡ç‰‡ï¼ˆå¤´åƒã€ç”¨æˆ·åã€åˆ«åï¼‰
  - è‡ªåŠ¨åœ¨æç¤ºè¯å¼€å¤´æ’å…¥ `@username` å¼•ç”¨
  - æ˜¾ç¤ºæœ€ç»ˆæç¤ºè¯é¢„è§ˆ
- **CharacterLibraryNode å®ç°**:
  - æ·»åŠ  `selectedCharacter` çŠ¶æ€ï¼ˆå•ä¸ªè§’è‰²é€‰æ‹©ï¼‰
  - ç‚¹å‡»è§’è‰²å¡ç‰‡é€‰ä¸­/å–æ¶ˆé€‰ä¸­
  - æ˜¾ç¤ºç»¿è‰²é€‰ä¸­æ ‡è¯†ï¼ˆâœ“ï¼‰åœ¨å·¦ä¸Šè§’
  - ç»¿è‰²èƒŒæ™¯å’Œè¾¹æ¡†æ˜¾ç¤ºé€‰ä¸­çŠ¶æ€
  - åŒå‡»æ‰“å¼€ç¼–è¾‘åˆ«åå¯¹è¯æ¡†ï¼ˆä¿ç•™åŸæœ‰åŠŸèƒ½ï¼‰
  - ä½¿ç”¨ `useNodeId()` è·å–èŠ‚ç‚¹ ID
  - ä½¿ç”¨ `useReactFlow()` ä¸»åŠ¨æ›´æ–°è¿æ¥çš„ç›®æ ‡èŠ‚ç‚¹
  - ç§»é™¤è°ƒè¯•æ—¥å¿—
- **VideoGenerateNode å®ç°**:
  - æ˜¾ç¤º `[ğŸ”— å·²è¿æ¥è§’è‰²]` æ ‡é¢˜
  - å®Œæ•´è§’è‰²å¡ç‰‡ï¼š32x32 å¤´åƒï¼ˆåœ†å½¢ï¼‰ã€åˆ«åï¼ˆç²—ä½“ï¼‰ã€@usernameï¼ˆç­‰å®½ï¼‰
  - æœªè¿æ¥æ—¶æ˜¾ç¤ºé»„è‰²è™šçº¿è¾¹æ¡†æç¤º
  - æœ€ç»ˆæç¤ºè¯é¢„è§ˆï¼š`ğŸ“¤ æœ€ç»ˆæç¤ºè¯: @username æç¤ºè¯`
- **æ•°æ®æµ**:
  ```
  CharacterLibraryNode (ç‚¹å‡»è§’è‰²)
    â†“ selectedCharacter (çŠ¶æ€)
    â†“ setNodes() æ›´æ–°è¿æ¥èŠ‚ç‚¹
    â†“ connectedCharacter (ä¼ é€’)
  VideoGenerateNode
    â†“ æ¥æ”¶å¹¶æ˜¾ç¤ºè§’è‰²å¡ç‰‡
    â†“ è‡ªåŠ¨ç»„è£…æç¤ºè¯
  ```
- **æŠ€æœ¯å®ç°**:
  - `CharacterLibraryNode.jsx`: æ–°å¢ 120 è¡Œä»£ç 
  - `VideoGenerateNode.jsx`: ä¿®æ”¹ 100 è¡Œä»£ç 
  - ä½¿ç”¨ useReactFlow hook è¿›è¡ŒèŠ‚ç‚¹é—´æ•°æ®ä¼ é€’
  - useEffect ç›‘å¬ selectedCharacter å˜åŒ–
- **æµ‹è¯•ç»“æœ**:
  - âœ… è§’è‰²é€‰æ‹©ï¼šç‚¹å‡»æ˜¾ç¤ºç»¿è‰² âœ“ æ ‡è¯†
  - âœ… æ•°æ®ä¼ é€’ï¼šCharacterLibraryNode â†’ VideoGenerateNode
  - âœ… è§’è‰²æ˜¾ç¤ºï¼š`é˜³å…‰å°çŒ« @5562be00d.sunbeamkit`
  - âœ… æç¤ºè¯é¢„è§ˆï¼š`ğŸ“¤ æœ€ç»ˆæç¤ºè¯: @5562be00d.sunbeamkit åœ¨èŠ±å›­é‡Œç©è€`
  - âœ… åŒå‡»ç¼–è¾‘ï¼šä¿ç•™åŸæœ‰ç¼–è¾‘åˆ«ååŠŸèƒ½
- **Git æäº¤**: `18762bd`
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/input/CharacterLibraryNode.jsx`
  - `src/client/src/nodes/process/VideoGenerateNode.jsx`

#### 26. è§†é¢‘æ’­æ”¾å’Œä¸‹è½½é—®é¢˜ä¿®å¤ (2026-01-01) â­ Bug ä¿®å¤
- **é—®é¢˜æè¿°**:
  - ç”Ÿæˆè§†é¢‘åï¼Œä»»åŠ¡ç»“æœèŠ‚ç‚¹æœªè‡ªåŠ¨æ›´æ–°çŠ¶æ€
  - æ‰‹åŠ¨æŸ¥è¯¢ä»»åŠ¡åï¼Œæ˜¾ç¤ºè§†é¢‘çš„é»‘å±å›¾ç‰‡ï¼Œç‚¹å‡»æ— æ³•æ’­æ”¾
  - ç‚¹å‡»ä¸‹è½½è§†é¢‘ï¼Œä¸‹è½½äº†ä¸€ä¸ªéè§†é¢‘æ–‡ä»¶
- **æ ¹æœ¬åŸå› **:
  1. è½®è¯¢é—´éš”é”™è¯¯ï¼š5ç§’é—´éš”ï¼ˆè¿åSKILL.mdé”™è¯¯6ï¼Œå¯¼è‡´429 Rate Limitï¼‰
  2. è§†é¢‘URLä¸ºç›¸å¯¹è·¯å¾„ï¼š`/downloads/xxx.mp4`
  3. æµè§ˆå™¨è§£æé”™è¯¯ï¼š`http://localhost:5173/downloads/...`ï¼ˆé”™è¯¯ç«¯å£ï¼‰
  4. è§†é¢‘æ–‡ä»¶åœ¨9000ç«¯å£æœåŠ¡å™¨ï¼Œå¯¼è‡´404æ— æ³•æ’­æ”¾
- **ä¿®å¤å†…å®¹**:
  - **è½®è¯¢é—´éš”ä¿®å¤**: ä»5000msæ”¹ä¸º30000msï¼ˆç¬¦åˆSKILL.mdé”™è¯¯6è§„èŒƒï¼‰
  - **URLå‰ç¼€å¤„ç†**: æ£€æŸ¥è·¯å¾„æ˜¯å¦ä»¥`/downloads/`å¼€å¤´ï¼Œæ‹¼æ¥`API_BASE`å‰ç¼€
  - **ç¼“å­˜ç ´å**: æ‰‹åŠ¨åˆ·æ–°æ·»åŠ `&_t=Date.now()`å‚æ•°
  - **è·¯å¾„å¤„ç†é€»è¾‘**:
    ```javascript
    let finalVideoUrl = taskData.output;
    if (finalVideoUrl.startsWith('/downloads/')) {
      finalVideoUrl = `${API_BASE}${finalVideoUrl}`;
    }
    ```
- **ä¿®å¤æ–‡ä»¶**: `src/client/src/nodes/output/TaskResultNode.jsx` (ç¬¬162-278è¡Œ)
- **éªŒè¯ç»“æœ**:
  - âœ… è§†é¢‘æ’­æ”¾æ­£å¸¸ï¼ˆæ—¶é•¿0:09ï¼‰
  - âœ… ä¸‹è½½é“¾æ¥æŒ‡å‘æ­£ç¡®ç«¯å£ï¼ˆ9000ï¼‰
  - âœ… ä»»åŠ¡çŠ¶æ€æ˜¾ç¤º"âœ“ å®Œæˆ"
  - âœ… è§†é¢‘URLï¼š`http://localhost:9000/downloads/9c904c7d-f001-4724-aa44-6237d45d7bba.mp4`
- **ç›¸å…³æ–‡æ¡£æ›´æ–°**:
  - SKILL.md: æ·»åŠ é”™è¯¯25 - æœ¬åœ°è§†é¢‘URLç¼ºå°‘å®Œæ•´å‰ç¼€å¯¼è‡´æ— æ³•æ’­æ”¾
  - code.md: æ·»åŠ é”™è¯¯25 - URLå‰ç¼€å¤„ç†å’Œç¼“å­˜ç ´å
  - å¼€å‘äº¤æ¥ä¹¦.md: æœ¬æ¡ç›®

---

## å·²çŸ¥é—®é¢˜ âš ï¸ å¾…ä¿®å¤

### é—®é¢˜ 1: æ•…äº‹æ¿æ¯ä¸ªé•œå¤´å‚è€ƒå›¾ç”Ÿæ•ˆæ€§å¾…éªŒè¯ â³
- **æè¿°**: æ•…äº‹æ¿æ¯ä¸ªé•œå¤´ä½¿ç”¨å‚è€ƒå›¾+è§’è‰²çš„æ–¹å¼ç”Ÿæˆè§†é¢‘ï¼Œéœ€è¦éªŒè¯æ¯ä¸ªåˆ†é•œå¤´çš„å‚è€ƒå›¾æ˜¯å¦ç”Ÿæ•ˆ
- **éªŒè¯æ–¹æ³•**: æ£€æŸ¥ API è¯·æ±‚ä½“ä¸­çš„ images æ•°ç»„æ˜¯å¦åŒ…å«æ‰€æœ‰é•œå¤´çš„å›¾ç‰‡
- **å›é€€æ–¹æ¡ˆ**: å¦‚æœä¸æ”¯æŒæ¯ä¸ªåˆ†é•œå¤´ä½¿ç”¨å‚è€ƒå›¾ï¼Œé€€å›åˆ°å…¨å±€åªç”¨ä¸€å¼ å‚è€ƒå›¾
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/process/StoryboardNode.jsx`
  - `src/server/sora2-client.js`
- **ä¼˜å…ˆçº§**: ä¸­

### é—®é¢˜ 2: âœ… TaskResultNode å“åº”bug - å·²ä¿®å¤ (2025-12-30)
- **æè¿°**: ç”»å¸ƒä¸­æœ‰å¤šä¸ªä»»åŠ¡ç»“æœèŠ‚ç‚¹æ—¶ï¼Œæäº¤ä»»åŠ¡æ—¶æ‰€æœ‰åŒç±»èŠ‚ç‚¹éƒ½å“åº”ï¼Œè€Œä¸æ˜¯åªæœ‰è¿æ¥çš„èŠ‚ç‚¹å“åº”
- **å½±å“**:
  - åŒä¸€ç”»å¸ƒæ‰¹é‡è¿è¡Œä»»åŠ¡æ—¶ï¼Œæ‰€æœ‰ TaskResultNode éƒ½ä¼šæ˜¾ç¤ºç›¸åŒçš„ç»“æœ
  - æ— æ³•åŒºåˆ†ä¸åŒè§†é¢‘ç”Ÿæˆä»»åŠ¡çš„ç»“æœ
- **åŸå› **: æœªè¿æ¥çš„èŠ‚ç‚¹ä»ç„¶è®¾ç½®äº†äº‹ä»¶ç›‘å¬å™¨
- **è§£å†³æ–¹æ¡ˆ**: åªæœ‰å½“ `connectedSourceId` å­˜åœ¨æ—¶æ‰è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/output/TaskResultNode.jsx`
  - `src/client/src/nodes/output/CharacterResultNode.jsx`
- **Git æäº¤**: `a384c98 fix: prevent unconnected result nodes from responding to events`

### é—®é¢˜ 3: âœ… æ•…äº‹æ¿æ€»æ—¶é•¿é€‰é¡¹æœªç”Ÿæ•ˆ - å·²ä¿®å¤ (2025-12-30)
- **æè¿°**: æ•…äº‹æ¿èŠ‚ç‚¹æ€»æ—¶é•¿é€‰é¡¹ï¼ˆ5/10/15/25ç§’ï¼‰æ²¡æœ‰ç”Ÿæ•ˆ
- **åŸå› **:
  1. API è¦æ±‚ `duration` å‚æ•°ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼ˆ`'10'`, `'15'`, `'25'`ï¼‰
  2. å‰ç«¯ä¼ é€’çš„æ˜¯æ•°å­—ç±»å‹ï¼ˆ10, 15, 25ï¼‰
  3. API ä¸æ”¯æŒ 5 ç§’é€‰é¡¹
- **è§£å†³æ–¹æ¡ˆ**:
  1. å°† duration è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š`String(totalDuration)`
  2. ç§»é™¤ 5 ç§’é€‰é¡¹ï¼Œåªä¿ç•™ 10/15/25 ç§’
  3. æ·»åŠ è¯´æ˜ï¼š25 ç§’ä»… sora-2-pro æ”¯æŒ
- **å½±å“æ–‡ä»¶**:
  - `src/client/src/nodes/process/StoryboardNode.jsx`
- **Git æäº¤**: `dde03d3 fix: storyboard duration parameter support`

---

## æ³¨æ„äº‹é¡¹

### âš ï¸ ç¦æ­¢äº‹é¡¹

1. **ç¦æ­¢ä½¿ç”¨ child_process è°ƒç”¨ API**
   ```javascript
   // âŒ é”™è¯¯ï¼šä¼šå¯¼è‡´è¿›ç¨‹åƒµæ­»
   const { spawn } = require('child_process');
   spawn('curl', ['https://api...']);

   // âœ… æ­£ç¡®ï¼šä½¿ç”¨ axios
   const axios = require('axios');
   await axios.post('https://api...', data);
   ```

2. **ç¦æ­¢ç¡¬ç¼–ç  API Key**
   ```javascript
   // âŒ é”™è¯¯
   const apiKey = 'sk-1234567890';

   // âœ… æ­£ç¡®
   const apiKey = process.env.SORA2_API_KEY;
   ```

3. **ç¦æ­¢åˆ›å»ºè§’è‰²æ—¶ä¼ é€’ model å‚æ•°**
   ```javascript
   // âŒ é”™è¯¯ï¼šä¼šå¯¼è‡´ 404 é”™è¯¯
   await axios.post('/sora/v1/characters', {
     model: 'sora-2',  // âŒ åˆ é™¤æ­¤è¡Œ
     url: videoUrl,
     timestamps: '1,3'
   });

   // âœ… æ­£ç¡®
   await axios.post('/sora/v1/characters', {
     from_task: taskId,
     timestamps: '1,3'
   });
   ```

4. **ç¦æ­¢ä½¿ç”¨é”™è¯¯çš„æŸ¥è¯¢ç«¯ç‚¹**
   ```javascript
   // âŒ é”™è¯¯ï¼šå¯¹èšé‘«ä½¿ç”¨è´è´çš„ç«¯ç‚¹
   await axios.get(`https://api.jxincm.cn/v2/videos/generations/${taskId}`);

   // âœ… æ­£ç¡®ï¼šèšé‘«ä½¿ç”¨æŸ¥è¯¢å‚æ•°
   await axios.get('https://api.jxincm.cn/v1/video/query', {
     params: { id: taskId }
   });
   ```

5. **æ¨¡å‹åç§°å·®å¼‚** â­ (2026-01-02 æ›´æ–°)
   - **èšé‘«å¹³å°**: å¿…é¡»ä½¿ç”¨ `sora-2-all`ï¼ˆå”¯ä¸€æ”¯æŒï¼‰
   - **è´è´å¹³å°**: ä½¿ç”¨ `sora-2` æˆ– `sora-2-pro`
   - **åç«¯è‡ªåŠ¨é€‰æ‹©**: å·²å®ç°å¹³å°è‡ªåŠ¨åˆ‡æ¢é€»è¾‘
   - **å‰ç«¯é…ç½®**: APISettingsNode é»˜è®¤å€¼éœ€åŒæ­¥
   - **è§’è‰²åˆ›å»º**: æ‰€æœ‰å¹³å°éƒ½ä¸ä¼  `model` å‚æ•°

6. **ç¦æ­¢å‡è®¾ä»»åŠ¡IDå­—æ®µåç§°** â­ æ–°å¢
   ```javascript
   // âŒ é”™è¯¯ï¼šåªæ£€æŸ¥ id å­—æ®µ
   if (result.success && result.data?.id) {
     // è´è´å¹³å°çš„è§†é¢‘ä¸ä¼šè¢«ä¿å­˜
   }

   // âœ… æ­£ç¡®ï¼šå…¼å®¹åŒå¹³å°
   const taskId = result.data.id || result.data.task_id;
   if (taskId) {
     historyStorage.addRecord({ taskId, platform, prompt, model, options });
   }
   ```

7. **ç¦æ­¢ä½¿ç”¨é”™è¯¯çš„è§’è‰²å¼•ç”¨æ ¼å¼** â­ æ–°å¢
   ```javascript
   // âŒ é”™è¯¯ï¼šä½¿ç”¨èŠ±æ‹¬å·
   const prompt = '@{username} åœ¨å·¥åœ°ä¸Šå¹²æ´»';

   // âœ… æ­£ç¡®ï¼šä¸ä½¿ç”¨èŠ±æ‹¬å·
   const prompt = '@username åœ¨å·¥åœ°ä¸Šå¹²æ´»';
   ```

8. **ç¦æ­¢æ··æ·†æµ‹è¯•ç›®æ ‡ï¼ˆç½‘é¡µç‰ˆ vs å·¥ä½œæµç”»å¸ƒï¼‰** â­ æ–°å¢
   ```bash
   # âŒ é”™è¯¯ï¼šåªå¯åŠ¨åç«¯ï¼Œè®¿é—®ç½‘é¡µç‰ˆ
   npm run server
   # æµè§ˆå™¨æ‰“å¼€ localhost:9000  â† è¿™æ˜¯ç½‘é¡µç‰ˆï¼Œä¸æ˜¯å·¥ä½œæµç”»å¸ƒï¼

   # âœ… æ­£ç¡®ï¼šåŒæ—¶å¯åŠ¨åç«¯å’Œå‰ç«¯ï¼Œè®¿é—®å·¥ä½œæµç”»å¸ƒ
   # ç»ˆç«¯1
   npm run server
   # ç»ˆç«¯2
   cd src/client && npm run dev
   # æµè§ˆå™¨æ‰“å¼€ localhost:5173  â† è¿™æ‰æ˜¯å·¥ä½œæµç”»å¸ƒï¼
   ```

   **å…³é”®åŒºåˆ«**ï¼š
   - `localhost:9000` â†’ ç½‘é¡µç‰ˆï¼ˆæ—§ç‰ˆ HTMLï¼‰
   - `localhost:5173` â†’ **å·¥ä½œæµç”»å¸ƒï¼ˆReact Flowï¼Œå½“å‰å¼€å‘é‡ç‚¹ï¼‰** â­

### âœ… æ¨èåšæ³•

1. **è§’è‰²åˆ›å»ºä¼˜å…ˆä½¿ç”¨ from_task**
   - æ›´å¯é ï¼Œé¿å…è§†é¢‘ URL è®¿é—®é—®é¢˜
   - ä»å·²å®Œæˆçš„è§†é¢‘ä»»åŠ¡åˆ›å»º

2. **è½®è¯¢é—´éš”è¦åˆç†**
   - Sora2 è§†é¢‘ç”Ÿæˆéœ€è¦ 3-5 åˆ†é’Ÿ
   - æ¨èè½®è¯¢é—´éš”ï¼š30 ç§’ï¼ˆå·²å®ç°ï¼‰
   - è¿‡çŸ­ä¼šå¯¼è‡´ 429 Rate Limit é”™è¯¯

3. **ä½¿ç”¨ç»Ÿä¸€çš„å“åº”æ ¼å¼**
   - æ‰€æœ‰ API è¿”å› `{success, data/error}`
   - ä¾¿äºå‰ç«¯å¤„ç†

4. **è‡ªåŠ¨ä¿å­˜åˆ°å­˜å‚¨**
   - è§†é¢‘åˆ›å»ºæˆåŠŸ â†’ è‡ªåŠ¨ä¿å­˜åˆ°å†å²è®°å½•
   - è§’è‰²åˆ›å»ºæˆåŠŸ â†’ è‡ªåŠ¨ä¿å­˜åˆ°è§’è‰²åº“
   - ä»»åŠ¡å®Œæˆ â†’ åå°è½®è¯¢è‡ªåŠ¨æ›´æ–°çŠ¶æ€

5. **åŒå¹³å°å…¼å®¹å¤„ç†** â­ æ–°å¢
   - å§‹ç»ˆä½¿ç”¨ `result.data.id || result.data.task_id` è·å–ä»»åŠ¡ID
   - æ ¹æ®å¹³å°é€‰æ‹©æ­£ç¡®çš„æŸ¥è¯¢ç«¯ç‚¹

6. **å‚è€ƒå›¾ç‰‡åŠŸèƒ½** â­ æ–°å¢
   - **å…ˆåˆ†æå›¾ç‰‡å†å†™æç¤ºè¯**: ä½¿ç”¨å›¾ç‰‡åˆ†æå·¥å…·ç†è§£å†…å®¹ï¼Œç„¶åå†™å‡ºç›¸å…³æ€§å¼ºçš„æç¤ºè¯
   - **æç¤ºè¯ç»“æ„**: åŒ…å«ä¸»ä½“ã€å¤–è§‚ã€åŠ¨ä½œã€ç¯å¢ƒã€æ°›å›´äº”ä¸ªè¦ç´ 
   - **æ•…äº‹æ¿å›¾ç‰‡æ”¶é›†**: åç«¯è‡ªåŠ¨æ”¶é›†æ‰€æœ‰é•œå¤´çš„ `shot.image` å¹¶åˆå¹¶åˆ° `images` æ•°ç»„
   - **è§’è‰²ä¸å›¾ç‰‡æ··åˆ**: å‚è€ƒå›¾ç‰‡ä½œä¸ºåœºæ™¯ï¼Œè§’è‰²åœ¨åœºæ™¯ä¸­æ´»åŠ¨
   - **è‡ªåŠ¨æ£€æµ‹æ¨¡å¼**: æœ‰å›¾ç‰‡è‡ªåŠ¨ä½¿ç”¨å›¾ç”Ÿè§†é¢‘ï¼Œæ— å›¾ç‰‡ä½¿ç”¨æ–‡ç”Ÿè§†é¢‘

---

## æ•…éšœæ’æŸ¥ (2026-01-02 æ›´æ–°) â­

### é—®é¢˜ 1: åç«¯ä»£ç ä¿®æ”¹ä¸ç”Ÿæ•ˆ â­ æ–°å¢

**ç°è±¡**: ä¿®æ”¹ `sora2-client.js` å,æ—¥å¿—æ— å˜åŒ–,è°ƒè¯•ä¿¡æ¯æœªè¾“å‡º

**åŸå› **: Node.js æ¨¡å—ç¼“å­˜ - å·²åŠ è½½çš„æ¨¡å—ä¸ä¼šé‡æ–°åŠ è½½

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. åœæ­¢æœåŠ¡å™¨
Ctrl+C

# 2. é‡æ–°å¯åŠ¨
npm run server

# 3. éªŒè¯ - æŸ¥çœ‹è°ƒè¯•æ—¥å¿—æ˜¯å¦å‡ºç°
```

**é¢„é˜²æªæ–½**: ä¿®æ”¹åç«¯ä»£ç åå¿…é¡»é‡å¯æœåŠ¡å™¨

---

### é—®é¢˜ 2: Windows ç«¯å£è¢«å ç”¨ (EADDRINUSE) â­ æ–°å¢

**ç°è±¡**:
- `Error: listen EADDRINUSE: address already in use :::9000`
- Git æäº¤æ—¶æŠ¥é”™: `error: short read while indexing nul`

**åŸå› **:
- Windows ä¿ç•™è®¾å¤‡å `nul` è¢«æ„å¤–åˆ›å»ºä¸ºæ–‡ä»¶
- Node.js è¿›ç¨‹æœªå®Œå…¨é€€å‡º

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. åˆ é™¤ nul æ–‡ä»¶
del nul

# 2. å¼ºåˆ¶ç»“æŸæ‰€æœ‰ Node è¿›ç¨‹
taskkill /F /IM node.exe

# 3. æˆ–ç»“æŸç‰¹å®š PID
netstat -ano | findstr :9000
# æ‰¾åˆ° PID (ä¾‹å¦‚: 12345)
taskkill /F /PID 12345
```

---

### é—®é¢˜ 3: è´è´å¹³å°è§†é¢‘æœªä¿å­˜åˆ°å†å²

**ç°è±¡**: ä½¿ç”¨è´è´å¹³å°åˆ›å»ºè§†é¢‘åï¼Œå†å²è®°å½•ä¸­æ‰¾ä¸åˆ°

**åŸå› **: è´è´è¿”å› `{task_id}`, èšé‘«è¿”å› `{id}`ï¼Œä»£ç åªæ£€æŸ¥äº† `id`

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// âœ… å…¼å®¹åŒå¹³å°
const taskId = result.data.id || result.data.task_id;
if (taskId) {
  historyStorage.addRecord({ taskId, platform, prompt, model, options });
}
```

### é—®é¢˜ 2: è§’è‰²åˆ›å»ºè¿”å› 500 é”™è¯¯

**ç°è±¡**: ä½¿ç”¨è§†é¢‘ URL åˆ›å»ºè§’è‰²å¤±è´¥ï¼Œè¿”å› "Request failed with status code 500"

**åŸå› **: è§†é¢‘æ— æ³•è®¿é—®ï¼ˆé˜²ç›—é“¾/è¿‡æœŸ/éœ€è¦ç‰¹æ®Š headersï¼‰

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨ `from_task` å‚æ•°
```javascript
// å…ˆåˆ›å»ºè§†é¢‘ä»»åŠ¡
const videoResult = await client.createVideo({...});
const taskId = videoResult.data.id || videoResult.data.task_id;

// ç­‰å¾…ä»»åŠ¡å®Œæˆ
const completed = await client.waitForTask(taskId);

// ä»å·²å®Œæˆçš„ä»»åŠ¡åˆ›å»ºè§’è‰²
const character = await client.createCharacter({
  from_task: taskId,
  timestamps: '1,3'
});
```

### é—®é¢˜ 3: æŸ¥è¯¢ä»»åŠ¡è¿”å› HTML

**ç°è±¡**: æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€è¿”å› HTML è€Œä¸æ˜¯ JSON

**åŸå› **: ä½¿ç”¨äº†é”™è¯¯çš„æŸ¥è¯¢ç«¯ç‚¹

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// èšé‘«å¹³å°
GET /v1/video/query?id={taskId}

// è´è´å¹³å°
GET /v2/videos/generations/{taskId}
```

### é—®é¢˜ 4: é¢‘ç¹å‡ºç° 429 é”™è¯¯

**ç°è±¡**: è½®è¯¢ä»»åŠ¡çŠ¶æ€æ—¶é¢‘ç¹è¿”å› 429 Rate Limit

**åŸå› **: è½®è¯¢é—´éš”å¤ªçŸ­

**è§£å†³æ–¹æ¡ˆ**: å°†è½®è¯¢é—´éš”å¢åŠ åˆ° 30 ç§’
```javascript
const POLL_INTERVAL = 30000;  // 30ç§’
const TIMEOUT = 600000;       // 10åˆ†é’Ÿ
```

### é—®é¢˜ 5: å‰ç«¯ä¸€ç›´æ˜¾ç¤º "Creating..."

**ç°è±¡**: åˆ›å»ºè§†é¢‘åå‰ç«¯ä¸€ç›´æ˜¾ç¤ºåŠ è½½ä¸­

**åŸå› **: åç«¯ä½¿ç”¨äº† `spawn` å¯¼è‡´é˜»å¡

**è§£å†³æ–¹æ¡ˆ**: æ”¹ç”¨ `await fetch()` æˆ– `await axios()`

### é—®é¢˜ 6: Claude Code ä¸è¯»å–è§„åˆ™æ–‡ä»¶

**ç°è±¡**: Claude Code æ²¡æœ‰åŠ è½½ `.claude/rules/` ä¸­çš„è§„åˆ™

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿ Claude Code åœ¨é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨
2. æ£€æŸ¥ `settings.json` æ ¼å¼æ˜¯å¦æ­£ç¡®
3. å°è¯•é‡å¯ Claude Code

### é—®é¢˜ 7: è§’è‰²å¼•ç”¨ä¸ç”Ÿæ•ˆ â­ æ–°å¢

**ç°è±¡**: ä½¿ç”¨è§’è‰²å¼•ç”¨åè§†é¢‘æ²¡æœ‰ä½¿ç”¨è¯¥è§’è‰²

**åŸå› **: ä½¿ç”¨äº†é”™è¯¯çš„æ ¼å¼ `@{username}`

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨æ­£ç¡®æ ¼å¼ `@username`ï¼ˆä¸å¸¦èŠ±æ‹¬å·ï¼‰
```javascript
// âœ… æ­£ç¡®
const prompt = '@6f2dbf2b3.zenwhisper åœ¨å·¥åœ°ä¸Šå¹²æ´»';

// âŒ é”™è¯¯
const prompt = '@{6f2dbf2b3.zenwhisper} åœ¨å·¥åœ°ä¸Šå¹²æ´»';
```

### é—®é¢˜ 8: å¤‡ä»½å¯¼å…¥å¤±è´¥ "æ— æ•ˆçš„å¤‡ä»½æ–‡ä»¶æ ¼å¼" â­ æ–°å¢

**ç°è±¡**: å¯¼å…¥ä¹‹å‰å¯¼å‡ºçš„å¤‡ä»½æ–‡ä»¶æ—¶ï¼Œæç¤º"æ— æ•ˆçš„å¤‡ä»½æ–‡ä»¶æ ¼å¼"

**åŸå› **: å¯¼å‡ºçš„å¤‡ä»½æ–‡ä»¶åŒ…å« API å“åº”åŒ…è£… `{success: true, data: {...}}`ï¼Œä½†å¯¼å…¥éªŒè¯æœŸæœ›çº¯å¤‡ä»½æ ¼å¼

**è§£å†³æ–¹æ¡ˆ**: å¯¼å…¥åŠŸèƒ½å·²æ”¯æŒåŒæ ¼å¼å…¼å®¹
```javascript
// å¤„ç†ä¸¤ç§æ ¼å¼ï¼š
// 1. å¯¼å‡ºæ—¶çš„æ ¼å¼ï¼š{success: true, data: {version: ..., data: {...}}}
// 2. çº¯å¤‡ä»½æ ¼å¼ï¼š{version: ..., data: {...}}

let backupData = JSON.parse(fileContent);

// è‡ªåŠ¨æå–å®é™…æ•°æ®
if (backupData.success && backupData.data) {
  backupData = backupData.data;
}
```

**å¤‡ä»½æ–‡ä»¶æ ¼å¼**:
```json
{
  "success": true,
  "data": {
    "version": "1.0",
    "timestamp": "2025-12-29T13:05:30.148Z",
    "data": {
      "history": [...],
      "characters": [...]
    }
  }
}
```

### é—®é¢˜ 9: ç”Ÿæˆçš„è§†é¢‘ä¸å‚è€ƒå›¾ç‰‡ä¸ç¬¦ â­ æ–°å¢

**ç°è±¡**: ä½¿ç”¨å‚è€ƒå›¾ç‰‡ç”Ÿæˆçš„è§†é¢‘å†…å®¹ä¸å›¾ç‰‡ä¸åŒ¹é…

**åŸå› **: æç¤ºè¯æœªæè¿°å›¾ç‰‡å†…å®¹ï¼Œä½¿ç”¨äº†é€šç”¨æç¤ºè¯

**è§£å†³æ–¹æ¡ˆ**: å…ˆåˆ†æå›¾ç‰‡å†…å®¹ï¼Œå†å†™ç›¸å…³æ€§å¼ºçš„æç¤ºè¯
```javascript
// âŒ é”™è¯¯ï¼šä½¿ç”¨é€šç”¨æç¤ºè¯
const prompt = 'ä¸€ä¸ªå¯çˆ±çš„çŒ«å’ªåœ¨èŠ±å›­é‡Œç©è€ï¼Œé˜³å…‰æ˜åªš';
// é—®é¢˜ï¼šå›¾ç‰‡æ˜¯å¡é€šåƒåœ¾è½¦ï¼Œä½†æç¤ºè¯æè¿°çš„æ˜¯çŒ«å’ª

// âœ… æ­£ç¡®ï¼šå…ˆåˆ†æå›¾ç‰‡ï¼Œå†å†™ç›¸å…³æç¤ºè¯
// ä½¿ç”¨å›¾ç‰‡åˆ†æå·¥å…·è¯†åˆ«ï¼šé»„è‰²è½¦å¤´ã€ç»¿è‰²è½¦èº«ã€å¯çˆ±è¡¨æƒ…ã€åŸå¸‚è¡—é“ã€å¡é€šé£æ ¼
const prompt = 'ä¸€è¾†å¡é€šé£æ ¼çš„åƒåœ¾è½¦åœ¨åŸå¸‚è¡—é“ä¸Šè¡Œé©¶ï¼Œé»„è‰²è½¦å¤´ã€ç»¿è‰²è½¦èº«ï¼Œ' +
               'è½¦å¤´æœ‰å¯çˆ±çš„è¡¨æƒ…ï¼ˆå¤§çœ¼ç›ã€å¾®ç¬‘ã€è…®çº¢ï¼‰ï¼Œè½¦æ–—é€šè¿‡æœºæ¢°è‡‚æŠ¬èµ·æ­£åœ¨ä½œä¸šï¼Œ' +
               'æ™´æœ—å¤©æ°”ï¼Œå¡é€šæ’ç”»é£æ ¼';
```

**æç¤ºè¯ç»“æ„å»ºè®®**:
1. **ä¸»ä½“**: ç”»é¢ä¸­çš„ä¸»è¦è§’è‰²/ç‰©ä½“
2. **å¤–è§‚**: é¢œè‰²ã€å½¢çŠ¶ã€è¡¨æƒ…ã€å§¿æ€
3. **åŠ¨ä½œ**: æ­£åœ¨åšä»€ä¹ˆ
4. **ç¯å¢ƒ**: èƒŒæ™¯åœºæ™¯ã€å‘¨å›´ç‰©ä½“
5. **æ°›å›´**: å…‰çº¿ã€è‰²è°ƒã€é£æ ¼

### é—®é¢˜ 10: æ•…äº‹æ¿é•œå¤´å›¾ç‰‡ä¸¢å¤± â­ æ–°å¢

**ç°è±¡**: æ•…äº‹æ¿æ¨¡å¼ä¸­é…ç½®çš„é•œå¤´å›¾ç‰‡æœªç”Ÿæ•ˆ

**åŸå› **:
- å‰ç«¯æœªæ”¶é›† `shot.image` å­—æ®µ
- åç«¯æœªå°†é•œå¤´å›¾ç‰‡åˆå¹¶åˆ° `images` æ•°ç»„

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// å‰ç«¯ï¼šæ­£ç¡®æ”¶é›†é•œå¤´å›¾ç‰‡
const shots = [];
document.querySelectorAll('.shot-item').forEach(item => {
  const duration = item.querySelector('.shot-duration').value;
  const scene = item.querySelector('.shot-scene').value.trim();
  const image = item.querySelector('.shot-image').value.trim();

  if (scene) {
    const shotData = {
      duration: parseFloat(duration),
      scene: scene
    };
    // å¦‚æœæœ‰å‚è€ƒå›¾ç‰‡ï¼Œæ·»åŠ åˆ°é•œå¤´æ•°æ®ä¸­
    if (image) {
      shotData.image = image;
    }
    shots.push(shotData);
  }
});

// åç«¯ï¼šæ”¶é›†æ‰€æœ‰é•œå¤´çš„å›¾ç‰‡
async createStoryboardVideo(options) {
  const { shots, images = [] } = options;

  // æ”¶é›†æ‰€æœ‰é•œå¤´çš„å‚è€ƒå›¾ç‰‡
  const allImages = [...images];
  shots.forEach((shot) => {
    if (shot.image) {
      allImages.push(shot.image);
    }
  });

  // ä½¿ç”¨åˆå¹¶åçš„å›¾ç‰‡æ•°ç»„
  const body = {
    model,
    prompt,
    images: allImages,  // åŒ…å«æ‰€æœ‰é•œå¤´çš„å›¾ç‰‡
    watermark,
    private: isPrivate,
  };
}
```

#### 27. èŠ‚ç‚¹è¿æ¥éªŒè¯ä¿®å¤ (2026-01-01) â­ Bug ä¿®å¤
- **é—®é¢˜æè¿°**: æœªè¿æ¥æˆ–è¿æ¥åˆ°é”™è¯¯ç±»å‹çš„èŠ‚ç‚¹ä»ç„¶å“åº”äº‹ä»¶
  - **å…·ä½“åœºæ™¯**: ç”»å¸ƒä¸Šæœ‰ä¸¤ä¸ªTaskResultNodeï¼Œä¸€ä¸ªè¿æ¥åˆ°VideoGenerateNodeï¼Œå¦ä¸€ä¸ªæœªè¿æ¥ä»»ä½•èŠ‚ç‚¹ï¼Œä½†æœªè¿æ¥çš„èŠ‚ç‚¹åœ¨ä»»åŠ¡æäº¤æ—¶ä¹Ÿæ˜¾ç¤ºæ‰§è¡Œäº†ä»»åŠ¡
  - **å½±å“èŒƒå›´**: æ‰€æœ‰ç»“æœèŠ‚ç‚¹ï¼ˆTaskResultNode, CharacterResultNodeç­‰ï¼‰
- **æ ¹æœ¬åŸå› **:
  1. **App.jsx**: åœ¨è®¾ç½® `connectedSourceId` æ—¶æ²¡æœ‰éªŒè¯æºèŠ‚ç‚¹ç±»å‹
  2. **äº‹ä»¶ç›‘å¬å™¨**: åªæ£€æŸ¥ `connectedSourceId === sourceNodeId`ï¼Œä¸æ£€æŸ¥èŠ‚ç‚¹ç±»å‹
  3. **äº‹ä»¶å¹¿æ’­æœºåˆ¶**: `window.dispatchEvent` æ˜¯å…¨å±€å¹¿æ’­ï¼Œæ‰€æœ‰ç›‘å¬å™¨éƒ½ä¼šæ”¶åˆ°äº‹ä»¶
- **ä¿®å¤å†…å®¹**:
  1. ä¸ºæ‰€æœ‰è¾“å…¥ç«¯å£æ·»åŠ æºèŠ‚ç‚¹ç±»å‹éªŒè¯
  2. æ¸…é™¤æ— æ•ˆè¿æ¥çš„æ•°æ®
  3. ç¡®ä¿äº‹ä»¶ç³»ç»Ÿæ­£ç¡®éš”ç¦»
- **ä¿®å¤æ–‡ä»¶**:
  - `src/client/src/App.jsx` - Lines 218-299ï¼ˆæ‰€æœ‰è¾“å…¥ç«¯å£æ·»åŠ æºèŠ‚ç‚¹ç±»å‹éªŒè¯ï¼‰
  - `src/client/src/nodes/output/TaskResultNode.jsx` - Lines 9, 105-117ï¼ˆå¯¼å…¥ getNodesï¼Œäº‹ä»¶å¤„ç†å™¨æ·»åŠ æºèŠ‚ç‚¹ç±»å‹éªŒè¯ï¼‰
- **è¾“å…¥ç«¯å£èŠ‚ç‚¹ç±»å‹æ˜ å°„**:
  - `task-input`: åªæ¥å— `videoGenerateNode`, `storyboardNode`, `characterCreateNode`
  - `character-input`: åªæ¥å— `characterLibraryNode`
  - `prompt-input`: åªæ¥å— `textNode`
  - `images-input`: åªæ¥å— `referenceImageNode`
  - `api-config`: åªæ¥å— `apiSettingsNode`
- **éªŒè¯ç»“æœ**: âœ… æœªè¿æ¥çš„èŠ‚ç‚¹ä¸å“åº”äº‹ä»¶ï¼Œåªæœ‰æ­£ç¡®è¿æ¥çš„èŠ‚ç‚¹æ˜¾ç¤ºä»»åŠ¡
- **éªŒè¯æˆªå›¾**: `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/éªŒè¯ä¿®å¤-æœªè¿æ¥èŠ‚ç‚¹ä¸å“åº”.png`
- **ç›¸å…³æ–‡æ¡£**: SKILL.md é”™è¯¯26, code.md é”™è¯¯26

#### 28. å¹³å°å‚æ•°ä¼ é€’ä¿®å¤å’Œé…ç½®æ›´æ–° (2026-01-01) â­ Bug ä¿®å¤ + é…ç½®æ›´æ–°
- **é—®é¢˜æè¿°1**: ä»»åŠ¡åœ¨åå°æ˜¾ç¤ºæˆåŠŸï¼Œä½†å‰ç«¯TaskResultNodeä¸€ç›´æ˜¾ç¤º"æŸ¥è¯¢ä¸­..."
  - **å…·ä½“åœºæ™¯**: ç”¨è´è´å¹³å°æäº¤çš„ä»»åŠ¡ï¼Œè½®è¯¢æ—¶ç¡¬ç¼–ç  `platform=juxin`ï¼Œå¯¼è‡´æŸ¥è¯¢é”™è¯¯çš„APIç«¯ç‚¹
  - **åå°æµ‹è¯•**: `platform=zhenzhen` æŸ¥è¯¢æˆåŠŸè¿”å›ç»“æœï¼Œ`platform=juxin` è¿”å›304 Not Modified
- **é—®é¢˜æè¿°2**: æ¨¡å‹åç§°æ˜¾ç¤ºé—®é¢˜
  - èšé‘«å¹³å°é€šçŸ¥ sora2 æ¨¡å‹æ›´åä¸º "sora-2-all"
  - è´è´å¹³å°ä¿æŒåŸåä¸å˜
  - é¡¹ç›®æ˜¾ç¤ºåç§°éœ€è¦æ›´æ–°
- **æ ¹æœ¬åŸå› **:
  1. **äº‹ä»¶ç³»ç»Ÿç¼ºå°‘ platform å‚æ•°**: VideoGenerateNode æ´¾å‘äº‹ä»¶æ—¶åªä¼ é€’ `sourceNodeId` å’Œ `taskId`
  2. **è½®è¯¢è¯·æ±‚ç¡¬ç¼–ç å¹³å°**: TaskResultNode è½®è¯¢æ—¶ç¡¬ç¼–ç  `platform=juxin`
  3. **ç¼ºå°‘ç¼“å­˜ç ´åå‚æ•°**: è¯·æ±‚æ²¡æœ‰æ·»åŠ æ—¶é—´æˆ³å‚æ•°ï¼Œæµè§ˆå™¨è¿”å›304 Not Modified
- **ä¿®å¤å†…å®¹**:
  1. **å¹³å°å‚æ•°ä¼ é€’**:
     - VideoGenerateNode æ´¾å‘äº‹ä»¶æ—¶ä¼ é€’ `platform: apiConfig.platform`
     - TaskResultNode ä½¿ç”¨ useState å­˜å‚¨ platformï¼Œä»äº‹ä»¶ä¸­æ¥æ”¶
  2. **åŠ¨æ€æ¨¡å‹åç§°æ˜¾ç¤º**: æ ¹æ®å¹³å°æ˜¾ç¤ºä¸åŒçš„æ¨¡å‹åç§°
     - èšé‘«å¹³å°: æ˜¾ç¤º "Sora-2-all"
     - è´è´å¹³å°: æ˜¾ç¤º "Sora-2"
  3. **ç¼“å­˜ç ´å**: è½®è¯¢å’Œæ‰‹åŠ¨æŸ¥è¯¢è¯·æ±‚æ·»åŠ  `&_t=${Date.now()}` å‚æ•°
  4. **é¡¹ç›®åç§°æ›´æ–°**: ä» "WinJin å·¥ä½œæµç¼–è¾‘å™¨" æ”¹ä¸º "AI starè§†é¢‘å·¥ä½œå°"
- **ä¿®å¤æ–‡ä»¶**:
  - `src/client/src/nodes/process/VideoGenerateNode.jsx` - Lines 280-283ï¼ˆä¼ é€’ platformï¼‰
  - `src/client/src/nodes/output/TaskResultNode.jsx` - Lines 21, 102, 145, 182, 226, 275ï¼ˆæ¥æ”¶å’Œä½¿ç”¨ platformï¼‰
  - `src/client/src/nodes/input/APISettingsNode.jsx` - Line 136ï¼ˆåŠ¨æ€æ˜¾ç¤ºæ¨¡å‹åç§°ï¼‰
  - `src/client/src/App.jsx` - Line 573ï¼ˆæ›´æ–°é¡¹ç›®åç§°ï¼‰
- **éªŒè¯ç»“æœ**:
  - âœ… è´è´å¹³å°ä»»åŠ¡ä½¿ç”¨ `platform=zhenzhen` æŸ¥è¯¢æˆåŠŸ
  - âœ… èšé‘«å¹³å°ä»»åŠ¡ä½¿ç”¨ `platform=juxin` æŸ¥è¯¢æˆåŠŸ
  - âœ… æµè§ˆå™¨ä¸å†è¿”å›304 Not Modified
  - âœ… æ¨¡å‹åç§°æ ¹æ®å¹³å°æ­£ç¡®æ˜¾ç¤º
  - âœ… é¡¹ç›®æ ‡é¢˜æ›´æ–°ä¸º "AI starè§†é¢‘å·¥ä½œå°"
- **æµ‹è¯•ä»»åŠ¡**:
  - æ—§ä»»åŠ¡ `video_bca7cf64` (è´è´) - âœ… ç”¨æ­£ç¡®å¹³å°æŸ¥è¯¢æˆåŠŸ
  - æ–°ä»»åŠ¡ `video_f521124e` (è´è´) - âœ… äº‹ä»¶æ­£ç¡®ä¼ é€’ `platform: zhenzhen`
- **ç›¸å…³æ–‡æ¡£**: SKILL.md é”™è¯¯35

#### 29. ä»»åŠ¡è¿›åº¦ç™¾åˆ†æ¯”æ˜¾ç¤ºåŠŸèƒ½ (2026-01-01) â­ åŠŸèƒ½å¢å¼º
- **é—®é¢˜æè¿°**: TaskResultNode åªæ˜¾ç¤º "â³ å¤„ç†ä¸­"ï¼Œæ— æ³•çŸ¥é“å…·ä½“è¿›åº¦
- **ç”¨æˆ·éœ€æ±‚**: æ˜¾ç¤ºä»»åŠ¡å®Œæˆçš„ç™¾åˆ†æ¯”è¿›åº¦ï¼ˆ0-100%ï¼‰
- **å®ç°å†…å®¹**:
  1. **æ·»åŠ  progress çŠ¶æ€**: `useState(data.progress || 0)` å­˜å‚¨ 0-100 è¿›åº¦å€¼
  2. **API å“åº”æå–**: è½®è¯¢å’Œæ‰‹åŠ¨åˆ·æ–°æ—¶ä» `result.data.progress` æå–è¿›åº¦
  3. **UI æ˜¾ç¤ºæ›´æ–°**: ä¿®æ”¹ `getStatusText()` å‡½æ•°æ˜¾ç¤ºæ ¼å¼ä¸º `â³ å¤„ç†ä¸­ 45%`
- **ä¿®å¤æ–‡ä»¶**:
  - `src/client/src/nodes/output/TaskResultNode.jsx`
    - Line 23-24: æ·»åŠ  progress çŠ¶æ€
    - Lines 188-196: è½®è¯¢å‡½æ•°æå– progress å­—æ®µ
    - Lines 286-294: æ‰‹åŠ¨åˆ·æ–°å‡½æ•°æå– progress å­—æ®µ
    - Lines 342-351: `getStatusText()` å‡½æ•°æ¥å— progressValue å‚æ•°
    - Line 464: UI ä¼ é€’ progress å‚æ•°åˆ° `getStatusText()`
- **éªŒè¯ç»“æœ**:
  - âœ… åç«¯ API å“åº”åŒ…å« progress å­—æ®µï¼š`{progress: 100, status: "SUCCESS"}`
  - âœ… å·²å®Œæˆä»»åŠ¡æ˜¾ç¤º "âœ“ å®Œæˆ"ï¼ˆprogress = 100ï¼‰
  - âœ… ä»£ç ä¿®æ”¹ä¸å½±å“å…¶ä»–èŠ‚ç‚¹ï¼ˆä»…ç»„ä»¶å†…éƒ¨æ˜¾ç¤ºé€»è¾‘ï¼‰
  - âœ… å·¥ä½œæµèœå•åŠŸèƒ½éªŒè¯æ­£å¸¸
- **Git æäº¤**: `0eb887b feat: æ˜¾ç¤ºä»»åŠ¡è¿›åº¦ç™¾åˆ†æ¯”`
- **ç›¸å…³æ–‡æ¡£**: SKILL.md å¼€å‘æç¤º 19

#### 30. TaskResultNode platform è‡ªåŠ¨æ£€æµ‹ä¿®å¤ (2026-01-01) â­ Bug ä¿®å¤
- **é—®é¢˜æè¿°**: æ—§ä»»åŠ¡æŸ¥è¯¢ API è¿”å› 400 é”™è¯¯ï¼Œæ— æ³•è·å–è§†é¢‘ä¿¡æ¯
- **æ ¹æœ¬åŸå› **:
  - localStorage ä¿å­˜çš„æ—§ä»»åŠ¡æ²¡æœ‰ `platform` å­—æ®µ
  - TaskResultNode åˆå§‹åŒ–ä½¿ç”¨é»˜è®¤å€¼ `'juxin'`
  - è´è´å¹³å°çš„ä»»åŠ¡ç”¨èšé‘«ç«¯ç‚¹æŸ¥è¯¢å¯¼è‡´ 400 é”™è¯¯
  - VideoGenerateNode æ˜¾ç¤º"è´è´"ä½† TaskResultNode æŸ¥è¯¢ç”¨ `platform=juxin`
- **ç”¨æˆ·æŠ¥å‘Š**: "9714è¿™ä¸ªä»»åŠ¡ï¼Œåå°æ˜¾ç¤ºå·²ç»æˆåŠŸï¼Œä½†æ˜¯èŠ‚ç‚¹æ²¡æœ‰çœ‹åˆ°æ–°è§†é¢‘"
- **å®ç°å†…å®¹**:
  1. **æ·»åŠ  useEffect 1.5**: è‡ªåŠ¨ä»è¿æ¥çš„ VideoGenerateNode æ£€æµ‹ platform
  2. **æ¡ä»¶è§¦å‘**: åªåœ¨ platform ä¸º undefined æˆ– 'juxin' æ—¶æ‰§è¡Œ
  3. **åŒæ­¥æ›´æ–°**: åŒæ—¶æ›´æ–°å†…éƒ¨çŠ¶æ€å’Œ node.data
  4. **å‘åå…¼å®¹**: è‡ªåŠ¨ä¿®å¤æ—§æ•°æ®ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
  5. **æŒä¹…åŒ–ä¿®å¤**: æ›´æ–°çš„ node.data è‡ªåŠ¨ä¿å­˜åˆ° localStorage
- **ä¿®å¤æ–‡ä»¶**:
  - `src/client/src/nodes/output/TaskResultNode.jsx`
    - Lines 47-52: useEffect 1 æ€»æ˜¯å°è¯•æ¢å¤ platform
    - Lines 118-140: useEffect 1.5 è‡ªåŠ¨æ£€æµ‹å’Œä¿®å¤ platform
- **éªŒè¯ç»“æœ**:
  - âœ… æ—§ä»»åŠ¡ `video_f8317d47` æ­£ç¡®æŸ¥è¯¢ APIï¼š`platform=zhenzhen`
  - âœ… æˆåŠŸè·å–æœ¬åœ°è§†é¢‘ï¼š`/downloads/4cf0d493-1810-4c3a-9caf-ff851e82deca.mp4`
  - âœ… æ§åˆ¶å°æ—¥å¿—ï¼š`[TaskResultNode] Detected platform from connected VideoGenerateNode: zhenzhen`
  - âœ… æ— éœ€æ‰‹åŠ¨åˆ é™¤æ—§ä»»åŠ¡ï¼Œè‡ªåŠ¨å‘åå…¼å®¹
- **Git æäº¤**: `18fc091 fix: TaskResultNode auto-detect platform from connected VideoGenerateNode`
- **ç›¸å…³æ–‡æ¡£**:
  - SKILL.md: é”™è¯¯æ¨¡å¼ 38ï¼Œå¼€å‘æç¤º 22
  - code.md: é”™è¯¯æ¨¡å¼ 38
  - æˆªå›¾éªŒè¯: `ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘å¯¹è¯/platform-fix-verification.png`

---

## å¿«é€Ÿå‚è€ƒ

### ç¯å¢ƒå˜é‡é€ŸæŸ¥

```bash
SORA2_API_KEY=sk-xxxxx      # èšé‘«å¹³å° API Key
ZHENZHEN_API_KEY=sk-xxxxx   # è´è´å¹³å° API Key
PORT=9000                    # æœåŠ¡å™¨ç«¯å£
```

### å…³é”®ç«¯å£

- HTTP æœåŠ¡å™¨: `http://localhost:9000`
- å¥åº·æ£€æŸ¥: `http://localhost:9000/health`

### æ•°æ®æ–‡ä»¶ä½ç½®

- å†å²è®°å½•: `data/history.json`
- è§’è‰²åº“: `data/characters.json`
- è§†é¢‘ä¸‹è½½: `downloads/`

### å‚è€ƒæ–‡æ¡£

- å¼€å‘ç»éªŒ: `reference/ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/å¼€å‘ç»éªŒ/Sora2_Character_Best_Practices.md`
- èšé‘« API: `reference/ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/èšé‘«sora2/`
- è´è´ API: `reference/ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹/è´è´å·¥åŠ/`

### è§’è‰²å¼•ç”¨è¯­æ³•é€ŸæŸ¥ â­ æ–°å¢

```
@username æç¤ºè¯å†…å®¹

ç¤ºä¾‹ï¼š
@6f2dbf2b3.zenwhisper åœ¨å·¥åœ°ä¸Šå¹²æ´»
@783316a1d.diggyloade åœ¨å·¥åœ°ä¸Šå¹²æ´»
```

**æ³¨æ„**:
- æ‰€æœ‰å¹³å°ç»Ÿä¸€æ ¼å¼
- ä¸ä½¿ç”¨èŠ±æ‹¬å·
- è§’è‰²å¼•ç”¨å’Œæç¤ºè¯ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€

### åŒå¹³å°å·®å¼‚é€ŸæŸ¥ â­ æ–°å¢

| é¡¹ç›® | èšé‘«å¹³å° | è´è´å¹³å° |
|------|----------|----------|
| æŸ¥è¯¢ç«¯ç‚¹ | `/v1/video/query?id={taskId}` | `/v2/videos/generations/{taskId}` |
| å“åº”æ ¼å¼ | `{ id: "video_xxx" }` | `{ task_id: "video_xxx" }` |
| å…¼å®¹å¤„ç† | `result.data.id \|\| result.data.task_id` | åŒå·¦ |

---

## è”ç³»æ–¹å¼

- é¡¹ç›®ä»“åº“: https://github.com/leon30083/wenjing-aigc.git
- é—®é¢˜åé¦ˆ: GitHub Issues

---

**æœ€åæ›´æ–°**: 2026-01-01
**ç»´æŠ¤è€…**: WinJin AIGC Team
**ç‰ˆæœ¬**: v3.3
